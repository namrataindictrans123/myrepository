{"version":3,"file":"report.min.js","sources":["../../../apps/frappe/frappe/public/js/lib/clusterize.min.js","../../../apps/frappe/frappe/public/js/frappe/views/reports/report_factory.js","../../../apps/frappe/node_modules/sortablejs/Sortable.js","../../../apps/frappe/node_modules/frappe-datatable/dist/frappe-datatable.cjs.js","../../../apps/frappe/frappe/public/js/frappe/views/reports/report_view.js","../../../apps/frappe/frappe/public/js/frappe/views/reports/query_report.js","../../../apps/frappe/frappe/public/js/frappe/views/reports/grid_report.js"],"sourcesContent":["/*! Clusterize.js - v0.17.6 - 2017-03-05\n* http://NeXTs.github.com/Clusterize.js/\n* Copyright (c) 2015 Denis Lukov; Licensed GPLv3 */\n\n;(function(q,n){\"undefined\"!=typeof module?module.exports=n():\"function\"==typeof define&&\"object\"==typeof define.amd?define(n):this[q]=n()})(\"Clusterize\",function(){function q(b,a,c){return a.addEventListener?a.addEventListener(b,c,!1):a.attachEvent(\"on\"+b,c)}function n(b,a,c){return a.removeEventListener?a.removeEventListener(b,c,!1):a.detachEvent(\"on\"+b,c)}function r(b){return\"[object Array]\"===Object.prototype.toString.call(b)}function m(b,a){return window.getComputedStyle?window.getComputedStyle(a)[b]:\n\ta.currentStyle[b]}var l=function(){for(var b=3,a=document.createElement(\"b\"),c=a.all||[];a.innerHTML=\"\\x3c!--[if gt IE \"+ ++b+\"]><i><![endif]--\\x3e\",c[0];);return 4<b?b:document.documentMode}(),x=navigator.platform.toLowerCase().indexOf(\"mac\")+1,p=function(b){if(!(this instanceof p))return new p(b);var a=this,c={rows_in_block:50,blocks_in_cluster:4,tag:null,show_no_data_row:!0,no_data_class:\"clusterize-no-data\",no_data_text:\"No data\",keep_parity:!0,callbacks:{}};a.options={};for(var d=\"rows_in_block blocks_in_cluster show_no_data_row no_data_class no_data_text keep_parity tag callbacks\".split(\" \"),\n\tf=0,h;h=d[f];f++)a.options[h]=\"undefined\"!=typeof b[h]&&null!=b[h]?b[h]:c[h];c=[\"scroll\",\"content\"];for(f=0;d=c[f];f++)if(a[d+\"_elem\"]=b[d+\"Id\"]?document.getElementById(b[d+\"Id\"]):b[d+\"Elem\"],!a[d+\"_elem\"])throw Error(\"Error! Could not find \"+d+\" element\");a.content_elem.hasAttribute(\"tabindex\")||a.content_elem.setAttribute(\"tabindex\",0);var e=r(b.rows)?b.rows:a.fetchMarkup(),g={};b=a.scroll_elem.scrollTop;a.insertToDOM(e,g);a.scroll_elem.scrollTop=b;var k=!1,m=0,l=!1,t=function(){x&&(l||(a.content_elem.style.pointerEvents=\n\t\"none\"),l=!0,clearTimeout(m),m=setTimeout(function(){a.content_elem.style.pointerEvents=\"auto\";l=!1},50));k!=(k=a.getClusterNum())&&a.insertToDOM(e,g);a.options.callbacks.scrollingProgress&&a.options.callbacks.scrollingProgress(a.getScrollProgress())},u=0,v=function(){clearTimeout(u);u=setTimeout(a.refresh,100)};q(\"scroll\",a.scroll_elem,t);q(\"resize\",window,v);a.destroy=function(b){n(\"scroll\",a.scroll_elem,t);n(\"resize\",window,v);a.html((b?a.generateEmptyRow():e).join(\"\"))};a.refresh=function(b){(a.getRowsHeight(e)||\n\tb)&&a.update(e)};a.update=function(b){e=r(b)?b:[];b=a.scroll_elem.scrollTop;e.length*a.options.item_height<b&&(k=a.scroll_elem.scrollTop=0);a.insertToDOM(e,g);a.scroll_elem.scrollTop=b};a.clear=function(){a.update([])};a.getRowsAmount=function(){return e.length};a.getScrollProgress=function(){return this.options.scroll_top/(e.length*this.options.item_height)*100||0};var w=function(b,c){var d=r(c)?c:[];d.length&&(e=\"append\"==b?e.concat(d):d.concat(e),a.insertToDOM(e,g))};a.append=function(a){w(\"append\",\n\ta)};a.prepend=function(a){w(\"prepend\",a)}};p.prototype={constructor:p,fetchMarkup:function(){for(var b=[],a=this.getChildNodes(this.content_elem);a.length;)b.push(a.shift().outerHTML);return b},exploreEnvironment:function(b,a){var c=this.options;c.content_tag=this.content_elem.tagName.toLowerCase();b.length&&(l&&9>=l&&!c.tag&&(c.tag=b[0].match(/<([^>\\s/]*)/)[1].toLowerCase()),1>=this.content_elem.children.length&&(a.data=this.html(b[0]+b[0]+b[0])),c.tag||(c.tag=this.content_elem.children[0].tagName.toLowerCase()),\n\tthis.getRowsHeight(b))},getRowsHeight:function(b){var a=this.options,c=a.item_height;a.cluster_height=0;if(b.length){b=this.content_elem.children;var d=b[Math.floor(b.length/2)];a.item_height=d.offsetHeight;\"tr\"==a.tag&&\"collapse\"!=m(\"borderCollapse\",this.content_elem)&&(a.item_height+=parseInt(m(\"borderSpacing\",this.content_elem),10)||0);\"tr\"!=a.tag&&(b=parseInt(m(\"marginTop\",d),10)||0,d=parseInt(m(\"marginBottom\",d),10)||0,a.item_height+=Math.max(b,d));a.block_height=a.item_height*a.rows_in_block;\n\ta.rows_in_cluster=a.blocks_in_cluster*a.rows_in_block;a.cluster_height=a.blocks_in_cluster*a.block_height;return c!=a.item_height}},getClusterNum:function(){this.options.scroll_top=this.scroll_elem.scrollTop;return Math.floor(this.options.scroll_top/(this.options.cluster_height-this.options.block_height))||0},generateEmptyRow:function(){var b=this.options;if(!b.tag||!b.show_no_data_row)return[];var a=document.createElement(b.tag),c=document.createTextNode(b.no_data_text),d;a.className=b.no_data_class;\n\t\"tr\"==b.tag&&(d=document.createElement(\"td\"),d.colSpan=100,d.appendChild(c));a.appendChild(d||c);return[a.outerHTML]},generate:function(b,a){var c=this.options,d=b.length;if(d<c.rows_in_block)return{top_offset:0,bottom_offset:0,rows_above:0,rows:d?b:this.generateEmptyRow()};var f=Math.max((c.rows_in_cluster-c.rows_in_block)*a,0),h=f+c.rows_in_cluster,e=Math.max(f*c.item_height,0),c=Math.max((d-h)*c.item_height,0),d=[],g=f;for(1>e&&g++;f<h;f++)b[f]&&d.push(b[f]);return{top_offset:e,bottom_offset:c,\n\trows_above:g,rows:d}},renderExtraTag:function(b,a){var c=document.createElement(this.options.tag);c.className=[\"clusterize-extra-row\",\"clusterize-\"+b].join(\" \");a&&(c.style.height=a+\"px\");return c.outerHTML},insertToDOM:function(b,a){this.options.cluster_height||this.exploreEnvironment(b,a);var c=this.generate(b,this.getClusterNum()),d=c.rows.join(\"\"),f=this.checkChanges(\"data\",d,a),h=this.checkChanges(\"top\",c.top_offset,a),e=this.checkChanges(\"bottom\",c.bottom_offset,a),g=this.options.callbacks,\n\tk=[];f||h?(c.top_offset&&(this.options.keep_parity&&k.push(this.renderExtraTag(\"keep-parity\")),k.push(this.renderExtraTag(\"top-space\",c.top_offset))),k.push(d),c.bottom_offset&&k.push(this.renderExtraTag(\"bottom-space\",c.bottom_offset)),g.clusterWillChange&&g.clusterWillChange(),this.html(k.join(\"\")),\"ol\"==this.options.content_tag&&this.content_elem.setAttribute(\"start\",c.rows_above),g.clusterChanged&&g.clusterChanged()):e&&(this.content_elem.lastChild.style.height=c.bottom_offset+\"px\")},html:function(b){var a=\n\tthis.content_elem;if(l&&9>=l&&\"tr\"==this.options.tag){var c=document.createElement(\"div\");for(c.innerHTML=\"<table><tbody>\"+b+\"</tbody></table>\";b=a.lastChild;)a.removeChild(b);for(c=this.getChildNodes(c.firstChild.firstChild);c.length;)a.appendChild(c.shift())}else a.innerHTML=b},getChildNodes:function(b){b=b.children;for(var a=[],c=0,d=b.length;c<d;c++)a.push(b[c]);return a},checkChanges:function(b,a,c){var d=a!=c[b];c[b]=a;return d}};return p});","// Copyright (c) 2015, Frappe Technologies Pvt. Ltd. and Contributors\n// MIT License. See license.txt\n\nfrappe.views.ReportFactory = class ReportFactory extends frappe.views.Factory {\n\tmake(route) {\n\t\tconst _route = ['List', route[1], 'Report'];\n\n\t\tif (route[2]) {\n\t\t\t// custom report\n\t\t\t_route.push(route[2]);\n\t\t}\n\n\t\tfrappe.set_route(_route);\n\t}\n}\n","/**!\n * Sortable\n * @author\tRubaXa   <trash@rubaxa.org>\n * @author\towenm    <owen23355@gmail.com>\n * @license MIT\n */\n\n(function sortableModule(factory) {\n\t\"use strict\";\n\n\tif (typeof define === \"function\" && define.amd) {\n\t\tdefine(factory);\n\t}\n\telse if (typeof module != \"undefined\" && typeof module.exports != \"undefined\") {\n\t\tmodule.exports = factory();\n\t}\n\telse {\n\t\t/* jshint sub:true */\n\t\twindow[\"Sortable\"] = factory();\n\t}\n})(function sortableFactory() {\n\t\"use strict\";\n\n\tif (typeof window === \"undefined\" || !window.document) {\n\t\treturn function sortableError() {\n\t\t\tthrow new Error(\"Sortable.js requires a window with a document\");\n\t\t};\n\t}\n\n\tvar dragEl,\n\t\tparentEl,\n\t\tghostEl,\n\t\tcloneEl,\n\t\trootEl,\n\t\tnextEl,\n\t\tlastDownEl,\n\n\t\tscrollEl,\n\t\tscrollParentEl,\n\t\tscrollCustomFn,\n\n\t\toldIndex,\n\t\tnewIndex,\n\t\toldDraggableIndex,\n\t\tnewDraggableIndex,\n\n\t\tactiveGroup,\n\t\tputSortable,\n\n\t\tautoScrolls = [],\n\t\tscrolling = false,\n\n\t\tawaitingDragStarted = false,\n\t\tignoreNextClick = false,\n\t\tsortables = [],\n\n\t\tpointerElemChangedInterval,\n\t\tlastPointerElemX,\n\t\tlastPointerElemY,\n\n\t\ttapEvt,\n\t\ttouchEvt,\n\n\t\tmoved,\n\n\n\t\tlastTarget,\n\t\tlastDirection,\n\t\tpastFirstInvertThresh = false,\n\t\tisCircumstantialInvert = false,\n\t\tlastMode, // 'swap' or 'insert'\n\n\t\ttargetMoveDistance,\n\n\t\t// For positioning ghost absolutely\n\t\tghostRelativeParent,\n\t\tghostRelativeParentInitialScroll = [], // (left, top)\n\n\t\trealDragElRect, // dragEl rect after current animation\n\n\t\t/** @const */\n\t\tR_SPACE = /\\s+/g,\n\n\t\texpando = 'Sortable' + (new Date).getTime(),\n\n\t\twin = window,\n\t\tdocument = win.document,\n\t\tparseInt = win.parseInt,\n\t\tsetTimeout = win.setTimeout,\n\n\t\t$ = win.jQuery || win.Zepto,\n\t\tPolymer = win.Polymer,\n\n\t\tcaptureMode = {\n\t\t\tcapture: false,\n\t\t\tpassive: false\n\t\t},\n\n\t\tIE11OrLess = !!navigator.userAgent.match(/(?:Trident.*rv[ :]?11\\.|msie|iemobile)/i),\n\t\tEdge = !!navigator.userAgent.match(/Edge/i),\n\t\tFireFox = !!navigator.userAgent.match(/firefox/i),\n\t\tSafari = !!(navigator.userAgent.match(/safari/i) && !navigator.userAgent.match(/chrome/i) && !navigator.userAgent.match(/android/i)),\n\t\tIOS = !!(navigator.userAgent.match(/iP(ad|od|hone)/i)),\n\n\t\tPositionGhostAbsolutely = IOS,\n\n\t\tCSSFloatProperty = Edge || IE11OrLess ? 'cssFloat' : 'float',\n\n\t\t// This will not pass for IE9, because IE9 DnD only works on anchors\n\t\tsupportDraggable = ('draggable' in document.createElement('div')),\n\n\t\tsupportCssPointerEvents = (function() {\n\t\t\t// false when <= IE11\n\t\t\tif (IE11OrLess) {\n\t\t\t\treturn false;\n\t\t\t}\n\t\t\tvar el = document.createElement('x');\n\t\t\tel.style.cssText = 'pointer-events:auto';\n\t\t\treturn el.style.pointerEvents === 'auto';\n\t\t})(),\n\n\t\t_silent = false,\n\t\t_alignedSilent = false,\n\n\t\tabs = Math.abs,\n\t\tmin = Math.min,\n\t\tmax = Math.max,\n\n\t\tsavedInputChecked = [],\n\n\t\t_detectDirection = function(el, options) {\n\t\t\tvar elCSS = _css(el),\n\t\t\t\telWidth = parseInt(elCSS.width)\n\t\t\t\t\t- parseInt(elCSS.paddingLeft)\n\t\t\t\t\t- parseInt(elCSS.paddingRight)\n\t\t\t\t\t- parseInt(elCSS.borderLeftWidth)\n\t\t\t\t\t- parseInt(elCSS.borderRightWidth),\n\t\t\t\tchild1 = _getChild(el, 0, options),\n\t\t\t\tchild2 = _getChild(el, 1, options),\n\t\t\t\tfirstChildCSS = child1 && _css(child1),\n\t\t\t\tsecondChildCSS = child2 && _css(child2),\n\t\t\t\tfirstChildWidth = firstChildCSS && parseInt(firstChildCSS.marginLeft) + parseInt(firstChildCSS.marginRight) + _getRect(child1).width,\n\t\t\t\tsecondChildWidth = secondChildCSS && parseInt(secondChildCSS.marginLeft) + parseInt(secondChildCSS.marginRight) + _getRect(child2).width;\n\n\t\t\tif (elCSS.display === 'flex') {\n\t\t\t\treturn elCSS.flexDirection === 'column' || elCSS.flexDirection === 'column-reverse'\n\t\t\t\t? 'vertical' : 'horizontal';\n\t\t\t}\n\n\t\t\tif (elCSS.display === 'grid') {\n\t\t\t\treturn elCSS.gridTemplateColumns.split(' ').length <= 1 ? 'vertical' : 'horizontal';\n\t\t\t}\n\n\t\t\tif (child1 && firstChildCSS.float !== 'none') {\n\t\t\t\tvar touchingSideChild2 = firstChildCSS.float === 'left' ? 'left' : 'right';\n\n\t\t\t\treturn child2 && (secondChildCSS.clear === 'both' || secondChildCSS.clear === touchingSideChild2) ?\n\t\t\t\t\t'vertical' : 'horizontal';\n\t\t\t}\n\n\t\t\treturn (child1 &&\n\t\t\t\t(\n\t\t\t\t\tfirstChildCSS.display === 'block' ||\n\t\t\t\t\tfirstChildCSS.display === 'flex' ||\n\t\t\t\t\tfirstChildCSS.display === 'table' ||\n\t\t\t\t\tfirstChildCSS.display === 'grid' ||\n\t\t\t\t\tfirstChildWidth >= elWidth &&\n\t\t\t\t\telCSS[CSSFloatProperty] === 'none' ||\n\t\t\t\t\tchild2 &&\n\t\t\t\t\telCSS[CSSFloatProperty] === 'none' &&\n\t\t\t\t\tfirstChildWidth + secondChildWidth > elWidth\n\t\t\t\t) ?\n\t\t\t\t'vertical' : 'horizontal'\n\t\t\t);\n\t\t},\n\n\t\t/**\n\t\t * Detects first nearest empty sortable to X and Y position using emptyInsertThreshold.\n\t\t * @param  {Number} x      X position\n\t\t * @param  {Number} y      Y position\n\t\t * @return {HTMLElement}   Element of the first found nearest Sortable\n\t\t */\n\t\t_detectNearestEmptySortable = function(x, y) {\n\t\t\tfor (var i = 0; i < sortables.length; i++) {\n\t\t\t\tif (_lastChild(sortables[i])) continue;\n\n\t\t\t\tvar rect = _getRect(sortables[i]),\n\t\t\t\t\tthreshold = sortables[i][expando].options.emptyInsertThreshold,\n\t\t\t\t\tinsideHorizontally = x >= (rect.left - threshold) && x <= (rect.right + threshold),\n\t\t\t\t\tinsideVertically = y >= (rect.top - threshold) && y <= (rect.bottom + threshold);\n\n\t\t\t\tif (threshold && insideHorizontally && insideVertically) {\n\t\t\t\t\treturn sortables[i];\n\t\t\t\t}\n\t\t\t}\n\t\t},\n\n\t\t_isClientInRowColumn = function(x, y, el, axis, options) {\n\t\t\tvar targetRect = _getRect(el),\n\t\t\t\ttargetS1Opp = axis === 'vertical' ? targetRect.left : targetRect.top,\n\t\t\t\ttargetS2Opp = axis === 'vertical' ? targetRect.right : targetRect.bottom,\n\t\t\t\tmouseOnOppAxis = axis === 'vertical' ? x : y;\n\n\t\t\treturn targetS1Opp < mouseOnOppAxis && mouseOnOppAxis < targetS2Opp;\n\t\t},\n\n\t\t_isElInRowColumn = function(el1, el2, axis) {\n\t\t\tvar el1Rect = el1 === dragEl && realDragElRect || _getRect(el1),\n\t\t\t\tel2Rect = el2 === dragEl && realDragElRect || _getRect(el2),\n\t\t\t\tel1S1Opp = axis === 'vertical' ? el1Rect.left : el1Rect.top,\n\t\t\t\tel1S2Opp = axis === 'vertical' ? el1Rect.right : el1Rect.bottom,\n\t\t\t\tel1OppLength = axis === 'vertical' ? el1Rect.width : el1Rect.height,\n\t\t\t\tel2S1Opp = axis === 'vertical' ? el2Rect.left : el2Rect.top,\n\t\t\t\tel2S2Opp = axis === 'vertical' ? el2Rect.right : el2Rect.bottom,\n\t\t\t\tel2OppLength = axis === 'vertical' ? el2Rect.width : el2Rect.height;\n\n\t\t\treturn (\n\t\t\t\tel1S1Opp === el2S1Opp ||\n\t\t\t\tel1S2Opp === el2S2Opp ||\n\t\t\t\t(el1S1Opp + el1OppLength / 2) === (el2S1Opp + el2OppLength / 2)\n\t\t\t);\n\t\t},\n\n\t\t_getParentAutoScrollElement = function(el, includeSelf) {\n\t\t\t// skip to window\n\t\t\tif (!el || !el.getBoundingClientRect) return _getWindowScrollingElement();\n\n\t\t\tvar elem = el;\n\t\t\tvar gotSelf = false;\n\t\t\tdo {\n\t\t\t\t// we don't need to get elem css if it isn't even overflowing in the first place (performance)\n\t\t\t\tif (elem.clientWidth < elem.scrollWidth || elem.clientHeight < elem.scrollHeight) {\n\t\t\t\t\tvar elemCSS = _css(elem);\n\t\t\t\t\tif (\n\t\t\t\t\t\telem.clientWidth < elem.scrollWidth && (elemCSS.overflowX == 'auto' || elemCSS.overflowX == 'scroll') ||\n\t\t\t\t\t\telem.clientHeight < elem.scrollHeight && (elemCSS.overflowY == 'auto' || elemCSS.overflowY == 'scroll')\n\t\t\t\t\t) {\n\t\t\t\t\t\tif (!elem || !elem.getBoundingClientRect || elem === document.body) return _getWindowScrollingElement();\n\n\t\t\t\t\t\tif (gotSelf || includeSelf) return elem;\n\t\t\t\t\t\tgotSelf = true;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t/* jshint boss:true */\n\t\t\t} while (elem = elem.parentNode);\n\n\t\t\treturn _getWindowScrollingElement();\n\t\t},\n\n\t\t_getWindowScrollingElement = function() {\n\t\t\tif (IE11OrLess) {\n\t\t\t\treturn document.documentElement;\n\t\t\t} else {\n\t\t\t\treturn document.scrollingElement;\n\t\t\t}\n\t\t},\n\n\t\t_scrollBy = function(el, x, y) {\n\t\t\tel.scrollLeft += x;\n\t\t\tel.scrollTop += y;\n\t\t},\n\n\t\t_autoScroll = _throttle(function (/**Event*/evt, /**Object*/options, /**HTMLElement*/rootEl, /**Boolean*/isFallback) {\n\t\t\t// Bug: https://bugzilla.mozilla.org/show_bug.cgi?id=505521\n\t\t\tif (options.scroll) {\n\t\t\t\tvar _this = rootEl ? rootEl[expando] : window,\n\t\t\t\t\tsens = options.scrollSensitivity,\n\t\t\t\t\tspeed = options.scrollSpeed,\n\n\t\t\t\t\tx = evt.clientX,\n\t\t\t\t\ty = evt.clientY,\n\n\t\t\t\t\twinScroller = _getWindowScrollingElement(),\n\n\t\t\t\t\tscrollThisInstance = false;\n\n\t\t\t\t// Detect scrollEl\n\t\t\t\tif (scrollParentEl !== rootEl) {\n\t\t\t\t\t_clearAutoScrolls();\n\n\t\t\t\t\tscrollEl = options.scroll;\n\t\t\t\t\tscrollCustomFn = options.scrollFn;\n\n\t\t\t\t\tif (scrollEl === true) {\n\t\t\t\t\t\tscrollEl = _getParentAutoScrollElement(rootEl, true);\n\t\t\t\t\t\tscrollParentEl = scrollEl;\n\t\t\t\t\t}\n\t\t\t\t}\n\n\n\t\t\t\tvar layersOut = 0;\n\t\t\t\tvar currentParent = scrollEl;\n\t\t\t\tdo {\n\t\t\t\t\tvar\tel = currentParent,\n\t\t\t\t\t\trect = _getRect(el),\n\n\t\t\t\t\t\ttop = rect.top,\n\t\t\t\t\t\tbottom = rect.bottom,\n\t\t\t\t\t\tleft = rect.left,\n\t\t\t\t\t\tright = rect.right,\n\n\t\t\t\t\t\twidth = rect.width,\n\t\t\t\t\t\theight = rect.height,\n\n\t\t\t\t\t\tscrollWidth,\n\t\t\t\t\t\tscrollHeight,\n\n\t\t\t\t\t\tcss,\n\n\t\t\t\t\t\tvx,\n\t\t\t\t\t\tvy,\n\n\t\t\t\t\t\tcanScrollX,\n\t\t\t\t\t\tcanScrollY,\n\n\t\t\t\t\t\tscrollPosX,\n\t\t\t\t\t\tscrollPosY;\n\n\n\t\t\t\t\tscrollWidth = el.scrollWidth;\n\t\t\t\t\tscrollHeight = el.scrollHeight;\n\n\t\t\t\t\tcss = _css(el);\n\n\t\t\t\t\tscrollPosX = el.scrollLeft;\n\t\t\t\t\tscrollPosY = el.scrollTop;\n\n\t\t\t\t\tif (el === winScroller) {\n\t\t\t\t\t\tcanScrollX = width < scrollWidth && (css.overflowX === 'auto' || css.overflowX === 'scroll' || css.overflowX === 'visible');\n\t\t\t\t\t\tcanScrollY = height < scrollHeight && (css.overflowY === 'auto' || css.overflowY === 'scroll' || css.overflowY === 'visible');\n\t\t\t\t\t} else {\n\t\t\t\t\t\tcanScrollX = width < scrollWidth && (css.overflowX === 'auto' || css.overflowX === 'scroll');\n\t\t\t\t\t\tcanScrollY = height < scrollHeight && (css.overflowY === 'auto' || css.overflowY === 'scroll');\n\t\t\t\t\t}\n\n\t\t\t\t\tvx = canScrollX && (abs(right - x) <= sens && (scrollPosX + width) < scrollWidth) - (abs(left - x) <= sens && !!scrollPosX);\n\n\t\t\t\t\tvy = canScrollY && (abs(bottom - y) <= sens && (scrollPosY + height) < scrollHeight) - (abs(top - y) <= sens && !!scrollPosY);\n\n\n\t\t\t\t\tif (!autoScrolls[layersOut]) {\n\t\t\t\t\t\tfor (var i = 0; i <= layersOut; i++) {\n\t\t\t\t\t\t\tif (!autoScrolls[i]) {\n\t\t\t\t\t\t\t\tautoScrolls[i] = {};\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t\tif (autoScrolls[layersOut].vx != vx || autoScrolls[layersOut].vy != vy || autoScrolls[layersOut].el !== el) {\n\t\t\t\t\t\tautoScrolls[layersOut].el = el;\n\t\t\t\t\t\tautoScrolls[layersOut].vx = vx;\n\t\t\t\t\t\tautoScrolls[layersOut].vy = vy;\n\n\t\t\t\t\t\tclearInterval(autoScrolls[layersOut].pid);\n\n\t\t\t\t\t\tif (el && (vx != 0 || vy != 0)) {\n\t\t\t\t\t\t\tscrollThisInstance = true;\n\t\t\t\t\t\t\t/* jshint loopfunc:true */\n\t\t\t\t\t\t\tautoScrolls[layersOut].pid = setInterval((function () {\n\t\t\t\t\t\t\t\t// emulate drag over during autoscroll (fallback), emulating native DnD behaviour\n\t\t\t\t\t\t\t\tif (isFallback && this.layer === 0) {\n\t\t\t\t\t\t\t\t\tSortable.active._emulateDragOver(true);\n\t\t\t\t\t\t\t\t\tSortable.active._onTouchMove(touchEvt, true);\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\tvar scrollOffsetY = autoScrolls[this.layer].vy ? autoScrolls[this.layer].vy * speed : 0;\n\t\t\t\t\t\t\t\tvar scrollOffsetX = autoScrolls[this.layer].vx ? autoScrolls[this.layer].vx * speed : 0;\n\n\t\t\t\t\t\t\t\tif ('function' === typeof(scrollCustomFn)) {\n\t\t\t\t\t\t\t\t\tif (scrollCustomFn.call(_this, scrollOffsetX, scrollOffsetY, evt, touchEvt, autoScrolls[this.layer].el) !== 'continue') {\n\t\t\t\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t\t_scrollBy(autoScrolls[this.layer].el, scrollOffsetX, scrollOffsetY);\n\t\t\t\t\t\t\t}).bind({layer: layersOut}), 24);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tlayersOut++;\n\t\t\t\t} while (options.bubbleScroll && currentParent !== winScroller && (currentParent = _getParentAutoScrollElement(currentParent, false)));\n\t\t\t\tscrolling = scrollThisInstance; // in case another function catches scrolling as false in between when it is not\n\t\t\t}\n\t\t}, 30),\n\n\t\t_clearAutoScrolls = function () {\n\t\t\tautoScrolls.forEach(function(autoScroll) {\n\t\t\t\tclearInterval(autoScroll.pid);\n\t\t\t});\n\t\t\tautoScrolls = [];\n\t\t},\n\n\t\t_prepareGroup = function (options) {\n\t\t\tfunction toFn(value, pull) {\n\t\t\t\treturn function(to, from, dragEl, evt) {\n\t\t\t\t\tvar sameGroup = to.options.group.name &&\n\t\t\t\t\t\t\t\t\tfrom.options.group.name &&\n\t\t\t\t\t\t\t\t\tto.options.group.name === from.options.group.name;\n\n\t\t\t\t\tif (value == null && (pull || sameGroup)) {\n\t\t\t\t\t\t// Default pull value\n\t\t\t\t\t\t// Default pull and put value if same group\n\t\t\t\t\t\treturn true;\n\t\t\t\t\t} else if (value == null || value === false) {\n\t\t\t\t\t\treturn false;\n\t\t\t\t\t} else if (pull && value === 'clone') {\n\t\t\t\t\t\treturn value;\n\t\t\t\t\t} else if (typeof value === 'function') {\n\t\t\t\t\t\treturn toFn(value(to, from, dragEl, evt), pull)(to, from, dragEl, evt);\n\t\t\t\t\t} else {\n\t\t\t\t\t\tvar otherGroup = (pull ? to : from).options.group.name;\n\n\t\t\t\t\t\treturn (value === true ||\n\t\t\t\t\t\t(typeof value === 'string' && value === otherGroup) ||\n\t\t\t\t\t\t(value.join && value.indexOf(otherGroup) > -1));\n\t\t\t\t\t}\n\t\t\t\t};\n\t\t\t}\n\n\t\t\tvar group = {};\n\t\t\tvar originalGroup = options.group;\n\n\t\t\tif (!originalGroup || typeof originalGroup != 'object') {\n\t\t\t\toriginalGroup = {name: originalGroup};\n\t\t\t}\n\n\t\t\tgroup.name = originalGroup.name;\n\t\t\tgroup.checkPull = toFn(originalGroup.pull, true);\n\t\t\tgroup.checkPut = toFn(originalGroup.put);\n\t\t\tgroup.revertClone = originalGroup.revertClone;\n\n\t\t\toptions.group = group;\n\t\t},\n\n\t\t_checkAlignment = function(evt) {\n\t\t\tif (!dragEl || !dragEl.parentNode) return;\n\t\t\tdragEl.parentNode[expando] && dragEl.parentNode[expando]._computeIsAligned(evt);\n\t\t},\n\n\t\t_hideGhostForTarget = function() {\n\t\t\tif (!supportCssPointerEvents && ghostEl) {\n\t\t\t\t_css(ghostEl, 'display', 'none');\n\t\t\t}\n\t\t},\n\n\t\t_unhideGhostForTarget = function() {\n\t\t\tif (!supportCssPointerEvents && ghostEl) {\n\t\t\t\t_css(ghostEl, 'display', '');\n\t\t\t}\n\t\t};\n\n\n\t// #1184 fix - Prevent click event on fallback if dragged but item not changed position\n\tdocument.addEventListener('click', function(evt) {\n\t\tif (ignoreNextClick) {\n\t\t\tevt.preventDefault();\n\t\t\tevt.stopPropagation && evt.stopPropagation();\n\t\t\tevt.stopImmediatePropagation && evt.stopImmediatePropagation();\n\t\t\tignoreNextClick = false;\n\t\t\treturn false;\n\t\t}\n\t}, true);\n\n\tvar nearestEmptyInsertDetectEvent = function(evt) {\n\t\tif (dragEl) {\n\t\t\tevt = evt.touches ? evt.touches[0] : evt;\n\t\t\tvar nearest = _detectNearestEmptySortable(evt.clientX, evt.clientY);\n\n\t\t\tif (nearest) {\n\t\t\t\t// Create imitation event\n\t\t\t\tvar event = {};\n\t\t\t\tfor (var i in evt) {\n\t\t\t\t\tevent[i] = evt[i];\n\t\t\t\t}\n\t\t\t\tevent.target = event.rootEl = nearest;\n\t\t\t\tevent.preventDefault = void 0;\n\t\t\t\tevent.stopPropagation = void 0;\n\t\t\t\tnearest[expando]._onDragOver(event);\n\t\t\t}\n\t\t}\n\t};\n\n\t/**\n\t * @class  Sortable\n\t * @param  {HTMLElement}  el\n\t * @param  {Object}       [options]\n\t */\n\tfunction Sortable(el, options) {\n\t\tif (!(el && el.nodeType && el.nodeType === 1)) {\n\t\t\tthrow 'Sortable: `el` must be HTMLElement, not ' + {}.toString.call(el);\n\t\t}\n\n\t\tthis.el = el; // root element\n\t\tthis.options = options = _extend({}, options);\n\n\n\t\t// Export instance\n\t\tel[expando] = this;\n\n\t\t// Default options\n\t\tvar defaults = {\n\t\t\tgroup: null,\n\t\t\tsort: true,\n\t\t\tdisabled: false,\n\t\t\tstore: null,\n\t\t\thandle: null,\n\t\t\tscroll: true,\n\t\t\tscrollSensitivity: 30,\n\t\t\tscrollSpeed: 10,\n\t\t\tbubbleScroll: true,\n\t\t\tdraggable: /[uo]l/i.test(el.nodeName) ? '>li' : '>*',\n\t\t\tswapThreshold: 1, // percentage; 0 <= x <= 1\n\t\t\tinvertSwap: false, // invert always\n\t\t\tinvertedSwapThreshold: null, // will be set to same as swapThreshold if default\n\t\t\tremoveCloneOnHide: true,\n\t\t\tdirection: function() {\n\t\t\t\treturn _detectDirection(el, this.options);\n\t\t\t},\n\t\t\tghostClass: 'sortable-ghost',\n\t\t\tchosenClass: 'sortable-chosen',\n\t\t\tdragClass: 'sortable-drag',\n\t\t\tignore: 'a, img',\n\t\t\tfilter: null,\n\t\t\tpreventOnFilter: true,\n\t\t\tanimation: 0,\n\t\t\teasing: null,\n\t\t\tsetData: function (dataTransfer, dragEl) {\n\t\t\t\tdataTransfer.setData('Text', dragEl.textContent);\n\t\t\t},\n\t\t\tdropBubble: false,\n\t\t\tdragoverBubble: false,\n\t\t\tdataIdAttr: 'data-id',\n\t\t\tdelay: 0,\n\t\t\tdelayOnTouchOnly: false,\n\t\t\ttouchStartThreshold: parseInt(window.devicePixelRatio, 10) || 1,\n\t\t\tforceFallback: false,\n\t\t\tfallbackClass: 'sortable-fallback',\n\t\t\tfallbackOnBody: false,\n\t\t\tfallbackTolerance: 0,\n\t\t\tfallbackOffset: {x: 0, y: 0},\n\t\t\tsupportPointer: Sortable.supportPointer !== false && ('PointerEvent' in window),\n\t\t\temptyInsertThreshold: 5\n\t\t};\n\n\n\t\t// Set default options\n\t\tfor (var name in defaults) {\n\t\t\t!(name in options) && (options[name] = defaults[name]);\n\t\t}\n\n\t\t_prepareGroup(options);\n\n\t\t// Bind all private methods\n\t\tfor (var fn in this) {\n\t\t\tif (fn.charAt(0) === '_' && typeof this[fn] === 'function') {\n\t\t\t\tthis[fn] = this[fn].bind(this);\n\t\t\t}\n\t\t}\n\n\t\t// Setup drag mode\n\t\tthis.nativeDraggable = options.forceFallback ? false : supportDraggable;\n\n\t\tif (this.nativeDraggable) {\n\t\t\t// Touch start threshold cannot be greater than the native dragstart threshold\n\t\t\tthis.options.touchStartThreshold = 1;\n\t\t}\n\n\t\t// Bind events\n\t\tif (options.supportPointer) {\n\t\t\t_on(el, 'pointerdown', this._onTapStart);\n\t\t} else {\n\t\t\t_on(el, 'mousedown', this._onTapStart);\n\t\t\t_on(el, 'touchstart', this._onTapStart);\n\t\t}\n\n\t\tif (this.nativeDraggable) {\n\t\t\t_on(el, 'dragover', this);\n\t\t\t_on(el, 'dragenter', this);\n\t\t}\n\n\t\tsortables.push(this.el);\n\n\t\t// Restore sorting\n\t\toptions.store && options.store.get && this.sort(options.store.get(this) || []);\n\t}\n\n\tSortable.prototype = /** @lends Sortable.prototype */ {\n\t\tconstructor: Sortable,\n\n\t\t_computeIsAligned: function(evt) {\n\t\t\tvar target;\n\n\t\t\tif (ghostEl && !supportCssPointerEvents) {\n\t\t\t\t_hideGhostForTarget();\n\t\t\t\ttarget = document.elementFromPoint(evt.clientX, evt.clientY);\n\t\t\t\t_unhideGhostForTarget();\n\t\t\t} else {\n\t\t\t\ttarget = evt.target;\n\t\t\t}\n\n\t\t\ttarget = _closest(target, this.options.draggable, this.el, false);\n\t\t\tif (_alignedSilent) return;\n\t\t\tif (!dragEl || dragEl.parentNode !== this.el) return;\n\n\t\t\tvar children = this.el.children;\n\t\t\tfor (var i = 0; i < children.length; i++) {\n\t\t\t\t// Don't change for target in case it is changed to aligned before onDragOver is fired\n\t\t\t\tif (_closest(children[i], this.options.draggable, this.el, false) && children[i] !== target) {\n\t\t\t\t\tchildren[i].sortableMouseAligned = _isClientInRowColumn(evt.clientX, evt.clientY, children[i], this._getDirection(evt, null), this.options);\n\t\t\t\t}\n\t\t\t}\n\t\t\t// Used for nulling last target when not in element, nothing to do with checking if aligned\n\t\t\tif (!_closest(target, this.options.draggable, this.el, true)) {\n\t\t\t\tlastTarget = null;\n\t\t\t}\n\n\t\t\t_alignedSilent = true;\n\t\t\tsetTimeout(function() {\n\t\t\t\t_alignedSilent = false;\n\t\t\t}, 30);\n\n\t\t},\n\n\t\t_getDirection: function(evt, target) {\n\t\t\treturn (typeof this.options.direction === 'function') ? this.options.direction.call(this, evt, target, dragEl) : this.options.direction;\n\t\t},\n\n\t\t_onTapStart: function (/** Event|TouchEvent */evt) {\n\t\t\tif (!evt.cancelable) return;\n\t\t\tvar _this = this,\n\t\t\t\tel = this.el,\n\t\t\t\toptions = this.options,\n\t\t\t\tpreventOnFilter = options.preventOnFilter,\n\t\t\t\ttype = evt.type,\n\t\t\t\ttouch = evt.touches && evt.touches[0],\n\t\t\t\ttarget = (touch || evt).target,\n\t\t\t\toriginalTarget = evt.target.shadowRoot && ((evt.path && evt.path[0]) || (evt.composedPath && evt.composedPath()[0])) || target,\n\t\t\t\tfilter = options.filter,\n\t\t\t\tstartIndex,\n\t\t\t\tstartDraggableIndex;\n\n\t\t\t_saveInputCheckedState(el);\n\n\t\t\t// Don't trigger start event when an element is been dragged, otherwise the evt.oldindex always wrong when set option.group.\n\t\t\tif (dragEl) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tif (/mousedown|pointerdown/.test(type) && evt.button !== 0 || options.disabled) {\n\t\t\t\treturn; // only left button and enabled\n\t\t\t}\n\n\t\t\t// cancel dnd if original target is content editable\n\t\t\tif (originalTarget.isContentEditable) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\ttarget = _closest(target, options.draggable, el, false);\n\n\n\t\t\tif (lastDownEl === target) {\n\t\t\t\t// Ignoring duplicate `down`\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\t// Get the index of the dragged element within its parent\n\t\t\tstartIndex = _index(target);\n\t\t\tstartDraggableIndex = _index(target, options.draggable);\n\n\t\t\t// Check filter\n\t\t\tif (typeof filter === 'function') {\n\t\t\t\tif (filter.call(this, evt, target, this)) {\n\t\t\t\t\t_dispatchEvent(_this, originalTarget, 'filter', target, el, el, startIndex, undefined, startDraggableIndex);\n\t\t\t\t\tpreventOnFilter && evt.cancelable && evt.preventDefault();\n\t\t\t\t\treturn; // cancel dnd\n\t\t\t\t}\n\t\t\t}\n\t\t\telse if (filter) {\n\t\t\t\tfilter = filter.split(',').some(function (criteria) {\n\t\t\t\t\tcriteria = _closest(originalTarget, criteria.trim(), el, false);\n\n\t\t\t\t\tif (criteria) {\n\t\t\t\t\t\t_dispatchEvent(_this, criteria, 'filter', target, el, el, startIndex, undefined, startDraggableIndex);\n\t\t\t\t\t\treturn true;\n\t\t\t\t\t}\n\t\t\t\t});\n\n\t\t\t\tif (filter) {\n\t\t\t\t\tpreventOnFilter && evt.cancelable && evt.preventDefault();\n\t\t\t\t\treturn; // cancel dnd\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif (options.handle && !_closest(originalTarget, options.handle, el, false)) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\t// Prepare `dragstart`\n\t\t\tthis._prepareDragStart(evt, touch, target, startIndex, startDraggableIndex);\n\t\t},\n\n\n\t\t_handleAutoScroll: function(evt, fallback) {\n\t\t\tif (!dragEl || !this.options.scroll) return;\n\t\t\tvar x = evt.clientX,\n\t\t\t\ty = evt.clientY,\n\n\t\t\t\telem = document.elementFromPoint(x, y),\n\t\t\t\t_this = this;\n\n\t\t\t// IE does not seem to have native autoscroll,\n\t\t\t// Edge's autoscroll seems too conditional,\n\t\t\t// MACOS Safari does not have autoscroll,\n\t\t\t// Firefox and Chrome are good\n\t\t\tif (fallback || Edge || IE11OrLess || Safari) {\n\t\t\t\t_autoScroll(evt, _this.options, elem, fallback);\n\n\t\t\t\t// Listener for pointer element change\n\t\t\t\tvar ogElemScroller = _getParentAutoScrollElement(elem, true);\n\t\t\t\tif (\n\t\t\t\t\tscrolling &&\n\t\t\t\t\t(\n\t\t\t\t\t\t!pointerElemChangedInterval ||\n\t\t\t\t\t\tx !== lastPointerElemX ||\n\t\t\t\t\t\ty !== lastPointerElemY\n\t\t\t\t\t)\n\t\t\t\t) {\n\n\t\t\t\t\tpointerElemChangedInterval && clearInterval(pointerElemChangedInterval);\n\t\t\t\t\t// Detect for pointer elem change, emulating native DnD behaviour\n\t\t\t\t\tpointerElemChangedInterval = setInterval(function() {\n\t\t\t\t\t\tif (!dragEl) return;\n\t\t\t\t\t\t// could also check if scroll direction on newElem changes due to parent autoscrolling\n\t\t\t\t\t\tvar newElem = _getParentAutoScrollElement(document.elementFromPoint(x, y), true);\n\t\t\t\t\t\tif (newElem !== ogElemScroller) {\n\t\t\t\t\t\t\togElemScroller = newElem;\n\t\t\t\t\t\t\t_clearAutoScrolls();\n\t\t\t\t\t\t\t_autoScroll(evt, _this.options, ogElemScroller, fallback);\n\t\t\t\t\t\t}\n\t\t\t\t\t}, 10);\n\t\t\t\t\tlastPointerElemX = x;\n\t\t\t\t\tlastPointerElemY = y;\n\t\t\t\t}\n\n\t\t\t} else {\n\t\t\t\t// if DnD is enabled (and browser has good autoscrolling), first autoscroll will already scroll, so get parent autoscroll of first autoscroll\n\t\t\t\tif (!_this.options.bubbleScroll || _getParentAutoScrollElement(elem, true) === _getWindowScrollingElement()) {\n\t\t\t\t\t_clearAutoScrolls();\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\t_autoScroll(evt, _this.options, _getParentAutoScrollElement(elem, false), false);\n\t\t\t}\n\t\t},\n\n\t\t_prepareDragStart: function (/** Event */evt, /** Touch */touch, /** HTMLElement */target, /** Number */startIndex, /** Number */startDraggableIndex) {\n\t\t\tvar _this = this,\n\t\t\t\tel = _this.el,\n\t\t\t\toptions = _this.options,\n\t\t\t\townerDocument = el.ownerDocument,\n\t\t\t\tdragStartFn;\n\n\t\t\tif (target && !dragEl && (target.parentNode === el)) {\n\t\t\t\trootEl = el;\n\t\t\t\tdragEl = target;\n\t\t\t\tparentEl = dragEl.parentNode;\n\t\t\t\tnextEl = dragEl.nextSibling;\n\t\t\t\tlastDownEl = target;\n\t\t\t\tactiveGroup = options.group;\n\t\t\t\toldIndex = startIndex;\n\t\t\t\toldDraggableIndex = startDraggableIndex;\n\n\t\t\t\ttapEvt = {\n\t\t\t\t\ttarget: dragEl,\n\t\t\t\t\tclientX: (touch || evt).clientX,\n\t\t\t\t\tclientY: (touch || evt).clientY\n\t\t\t\t};\n\n\t\t\t\tthis._lastX = (touch || evt).clientX;\n\t\t\t\tthis._lastY = (touch || evt).clientY;\n\n\t\t\t\tdragEl.style['will-change'] = 'all';\n\t\t\t\t// undo animation if needed\n\t\t\t\tdragEl.style.transition = '';\n\t\t\t\tdragEl.style.transform = '';\n\n\t\t\t\tdragStartFn = function () {\n\t\t\t\t\t// Delayed drag has been triggered\n\t\t\t\t\t// we can re-enable the events: touchmove/mousemove\n\t\t\t\t\t_this._disableDelayedDragEvents();\n\n\t\t\t\t\tif (!FireFox && _this.nativeDraggable) {\n\t\t\t\t\t\tdragEl.draggable = true;\n\t\t\t\t\t}\n\n\t\t\t\t\t// Bind the events: dragstart/dragend\n\t\t\t\t\t_this._triggerDragStart(evt, touch);\n\n\t\t\t\t\t// Drag start event\n\t\t\t\t\t_dispatchEvent(_this, rootEl, 'choose', dragEl, rootEl, rootEl, oldIndex, undefined, oldDraggableIndex);\n\n\t\t\t\t\t// Chosen item\n\t\t\t\t\t_toggleClass(dragEl, options.chosenClass, true);\n\t\t\t\t};\n\n\t\t\t\t// Disable \"draggable\"\n\t\t\t\toptions.ignore.split(',').forEach(function (criteria) {\n\t\t\t\t\t_find(dragEl, criteria.trim(), _disableDraggable);\n\t\t\t\t});\n\n\t\t\t\t_on(ownerDocument, 'dragover', nearestEmptyInsertDetectEvent);\n\t\t\t\t_on(ownerDocument, 'mousemove', nearestEmptyInsertDetectEvent);\n\t\t\t\t_on(ownerDocument, 'touchmove', nearestEmptyInsertDetectEvent);\n\n\t\t\t\t_on(ownerDocument, 'mouseup', _this._onDrop);\n\t\t\t\t_on(ownerDocument, 'touchend', _this._onDrop);\n\t\t\t\t_on(ownerDocument, 'touchcancel', _this._onDrop);\n\n\t\t\t\t// Make dragEl draggable (must be before delay for FireFox)\n\t\t\t\tif (FireFox && this.nativeDraggable) {\n\t\t\t\t\tthis.options.touchStartThreshold = 4;\n\t\t\t\t\tdragEl.draggable = true;\n\t\t\t\t}\n\n\t\t\t\t// Delay is impossible for native DnD in Edge or IE\n\t\t\t\tif (options.delay && (options.delayOnTouchOnly ? touch : true) && (!this.nativeDraggable || !(Edge || IE11OrLess))) {\n\t\t\t\t\t// If the user moves the pointer or let go the click or touch\n\t\t\t\t\t// before the delay has been reached:\n\t\t\t\t\t// disable the delayed drag\n\t\t\t\t\t_on(ownerDocument, 'mouseup', _this._disableDelayedDrag);\n\t\t\t\t\t_on(ownerDocument, 'touchend', _this._disableDelayedDrag);\n\t\t\t\t\t_on(ownerDocument, 'touchcancel', _this._disableDelayedDrag);\n\t\t\t\t\t_on(ownerDocument, 'mousemove', _this._delayedDragTouchMoveHandler);\n\t\t\t\t\t_on(ownerDocument, 'touchmove', _this._delayedDragTouchMoveHandler);\n\t\t\t\t\toptions.supportPointer && _on(ownerDocument, 'pointermove', _this._delayedDragTouchMoveHandler);\n\n\t\t\t\t\t_this._dragStartTimer = setTimeout(dragStartFn, options.delay);\n\t\t\t\t} else {\n\t\t\t\t\tdragStartFn();\n\t\t\t\t}\n\t\t\t}\n\t\t},\n\n\t\t_delayedDragTouchMoveHandler: function (/** TouchEvent|PointerEvent **/e) {\n\t\t\tvar touch = e.touches ? e.touches[0] : e;\n\t\t\tif (max(abs(touch.clientX - this._lastX), abs(touch.clientY - this._lastY))\n\t\t\t\t\t>= Math.floor(this.options.touchStartThreshold / (this.nativeDraggable && window.devicePixelRatio || 1))\n\t\t\t) {\n\t\t\t\tthis._disableDelayedDrag();\n\t\t\t}\n\t\t},\n\n\t\t_disableDelayedDrag: function () {\n\t\t\tdragEl && _disableDraggable(dragEl);\n\t\t\tclearTimeout(this._dragStartTimer);\n\n\t\t\tthis._disableDelayedDragEvents();\n\t\t},\n\n\t\t_disableDelayedDragEvents: function () {\n\t\t\tvar ownerDocument = this.el.ownerDocument;\n\t\t\t_off(ownerDocument, 'mouseup', this._disableDelayedDrag);\n\t\t\t_off(ownerDocument, 'touchend', this._disableDelayedDrag);\n\t\t\t_off(ownerDocument, 'touchcancel', this._disableDelayedDrag);\n\t\t\t_off(ownerDocument, 'mousemove', this._delayedDragTouchMoveHandler);\n\t\t\t_off(ownerDocument, 'touchmove', this._delayedDragTouchMoveHandler);\n\t\t\t_off(ownerDocument, 'pointermove', this._delayedDragTouchMoveHandler);\n\t\t},\n\n\t\t_triggerDragStart: function (/** Event */evt, /** Touch */touch) {\n\t\t\ttouch = touch || (evt.pointerType == 'touch' ? evt : null);\n\n\t\t\tif (!this.nativeDraggable || touch) {\n\t\t\t\tif (this.options.supportPointer) {\n\t\t\t\t\t_on(document, 'pointermove', this._onTouchMove);\n\t\t\t\t} else if (touch) {\n\t\t\t\t\t_on(document, 'touchmove', this._onTouchMove);\n\t\t\t\t} else {\n\t\t\t\t\t_on(document, 'mousemove', this._onTouchMove);\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\t_on(dragEl, 'dragend', this);\n\t\t\t\t_on(rootEl, 'dragstart', this._onDragStart);\n\t\t\t}\n\n\t\t\ttry {\n\t\t\t\tif (document.selection) {\n\t\t\t\t\t// Timeout neccessary for IE9\n\t\t\t\t\t_nextTick(function () {\n\t\t\t\t\t\tdocument.selection.empty();\n\t\t\t\t\t});\n\t\t\t\t} else {\n\t\t\t\t\twindow.getSelection().removeAllRanges();\n\t\t\t\t}\n\t\t\t} catch (err) {\n\t\t\t}\n\t\t},\n\n\t\t_dragStarted: function (fallback, evt) {\n\t\t\tawaitingDragStarted = false;\n\t\t\tif (rootEl && dragEl) {\n\t\t\t\tif (this.nativeDraggable) {\n\t\t\t\t\t_on(document, 'dragover', this._handleAutoScroll);\n\t\t\t\t\t_on(document, 'dragover', _checkAlignment);\n\t\t\t\t}\n\t\t\t\tvar options = this.options;\n\n\t\t\t\t// Apply effect\n\t\t\t\t!fallback && _toggleClass(dragEl, options.dragClass, false);\n\t\t\t\t_toggleClass(dragEl, options.ghostClass, true);\n\n\t\t\t\t// In case dragging an animated element\n\t\t\t\t_css(dragEl, 'transform', '');\n\n\t\t\t\tSortable.active = this;\n\n\t\t\t\tfallback && this._appendGhost();\n\n\t\t\t\t// Drag start event\n\t\t\t\t_dispatchEvent(this, rootEl, 'start', dragEl, rootEl, rootEl, oldIndex, undefined, oldDraggableIndex, undefined, evt);\n\t\t\t} else {\n\t\t\t\tthis._nulling();\n\t\t\t}\n\t\t},\n\n\t\t_emulateDragOver: function (forAutoScroll) {\n\t\t\tif (touchEvt) {\n\t\t\t\tif (this._lastX === touchEvt.clientX && this._lastY === touchEvt.clientY && !forAutoScroll) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\tthis._lastX = touchEvt.clientX;\n\t\t\t\tthis._lastY = touchEvt.clientY;\n\n\t\t\t\t_hideGhostForTarget();\n\n\t\t\t\tvar target = document.elementFromPoint(touchEvt.clientX, touchEvt.clientY);\n\t\t\t\tvar parent = target;\n\n\t\t\t\twhile (target && target.shadowRoot) {\n\t\t\t\t\ttarget = target.shadowRoot.elementFromPoint(touchEvt.clientX, touchEvt.clientY);\n\t\t\t\t\tif (target === parent) break;\n\t\t\t\t\tparent = target;\n\t\t\t\t}\n\n\t\t\t\tif (parent) {\n\t\t\t\t\tdo {\n\t\t\t\t\t\tif (parent[expando]) {\n\t\t\t\t\t\t\tvar inserted;\n\n\t\t\t\t\t\t\tinserted = parent[expando]._onDragOver({\n\t\t\t\t\t\t\t\tclientX: touchEvt.clientX,\n\t\t\t\t\t\t\t\tclientY: touchEvt.clientY,\n\t\t\t\t\t\t\t\ttarget: target,\n\t\t\t\t\t\t\t\trootEl: parent\n\t\t\t\t\t\t\t});\n\n\t\t\t\t\t\t\tif (inserted && !this.options.dragoverBubble) {\n\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\ttarget = parent; // store last element\n\t\t\t\t\t}\n\t\t\t\t\t/* jshint boss:true */\n\t\t\t\t\twhile (parent = parent.parentNode);\n\t\t\t\t}\n\t\t\t\tdragEl.parentNode[expando]._computeIsAligned(touchEvt);\n\n\t\t\t\t_unhideGhostForTarget();\n\t\t\t}\n\t\t},\n\n\n\t\t_onTouchMove: function (/**TouchEvent*/evt, forAutoScroll) {\n\t\t\tif (tapEvt) {\n\t\t\t\tvar\toptions = this.options,\n\t\t\t\t\tfallbackTolerance = options.fallbackTolerance,\n\t\t\t\t\tfallbackOffset = options.fallbackOffset,\n\t\t\t\t\ttouch = evt.touches ? evt.touches[0] : evt,\n\t\t\t\t\tmatrix = ghostEl && _matrix(ghostEl),\n\t\t\t\t\tscaleX = ghostEl && matrix && matrix.a,\n\t\t\t\t\tscaleY = ghostEl && matrix && matrix.d,\n\t\t\t\t\trelativeScrollOffset = PositionGhostAbsolutely && ghostRelativeParent && _getRelativeScrollOffset(ghostRelativeParent),\n\t\t\t\t\tdx = ((touch.clientX - tapEvt.clientX)\n\t\t\t\t\t\t\t+ fallbackOffset.x) / (scaleX || 1)\n\t\t\t\t\t\t\t+ (relativeScrollOffset ? (relativeScrollOffset[0] - ghostRelativeParentInitialScroll[0]) : 0) / (scaleX || 1),\n\t\t\t\t\tdy = ((touch.clientY - tapEvt.clientY)\n\t\t\t\t\t\t\t+ fallbackOffset.y) / (scaleY || 1)\n\t\t\t\t\t\t\t+ (relativeScrollOffset ? (relativeScrollOffset[1] - ghostRelativeParentInitialScroll[1]) : 0) / (scaleY || 1),\n\t\t\t\t\ttranslate3d = evt.touches ? 'translate3d(' + dx + 'px,' + dy + 'px,0)' : 'translate(' + dx + 'px,' + dy + 'px)';\n\n\t\t\t\t// only set the status to dragging, when we are actually dragging\n\t\t\t\tif (!Sortable.active && !awaitingDragStarted) {\n\t\t\t\t\tif (fallbackTolerance &&\n\t\t\t\t\t\tmin(abs(touch.clientX - this._lastX), abs(touch.clientY - this._lastY)) < fallbackTolerance\n\t\t\t\t\t) {\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t\tthis._onDragStart(evt, true);\n\t\t\t\t}\n\n\t\t\t\t!forAutoScroll && this._handleAutoScroll(touch, true);\n\n\t\t\t\tmoved = true;\n\t\t\t\ttouchEvt = touch;\n\n\t\t\t\t_css(ghostEl, 'webkitTransform', translate3d);\n\t\t\t\t_css(ghostEl, 'mozTransform', translate3d);\n\t\t\t\t_css(ghostEl, 'msTransform', translate3d);\n\t\t\t\t_css(ghostEl, 'transform', translate3d);\n\n\t\t\t\tevt.cancelable && evt.preventDefault();\n\t\t\t}\n\t\t},\n\n\t\t_appendGhost: function () {\n\t\t\t// Bug if using scale(): https://stackoverflow.com/questions/2637058\n\t\t\t// Not being adjusted for\n\t\t\tif (!ghostEl) {\n\t\t\t\tvar container = this.options.fallbackOnBody ? document.body : rootEl,\n\t\t\t\t\trect = _getRect(dragEl, true, container, !PositionGhostAbsolutely),\n\t\t\t\t\tcss = _css(dragEl),\n\t\t\t\t\toptions = this.options;\n\n\t\t\t\t// Position absolutely\n\t\t\t\tif (PositionGhostAbsolutely) {\n\t\t\t\t\t// Get relatively positioned parent\n\t\t\t\t\tghostRelativeParent = container;\n\n\t\t\t\t\twhile (\n\t\t\t\t\t\t_css(ghostRelativeParent, 'position') === 'static' &&\n\t\t\t\t\t\t_css(ghostRelativeParent, 'transform') === 'none' &&\n\t\t\t\t\t\tghostRelativeParent !== document\n\t\t\t\t\t) {\n\t\t\t\t\t\tghostRelativeParent = ghostRelativeParent.parentNode;\n\t\t\t\t\t}\n\n\t\t\t\t\tif (ghostRelativeParent !== document) {\n\t\t\t\t\t\tvar ghostRelativeParentRect = _getRect(ghostRelativeParent, true);\n\n\t\t\t\t\t\trect.top -= ghostRelativeParentRect.top;\n\t\t\t\t\t\trect.left -= ghostRelativeParentRect.left;\n\t\t\t\t\t}\n\n\t\t\t\t\tif (ghostRelativeParent !== document.body && ghostRelativeParent !== document.documentElement) {\n\t\t\t\t\t\tif (ghostRelativeParent === document) ghostRelativeParent = _getWindowScrollingElement();\n\n\t\t\t\t\t\trect.top += ghostRelativeParent.scrollTop;\n\t\t\t\t\t\trect.left += ghostRelativeParent.scrollLeft;\n\t\t\t\t\t} else {\n\t\t\t\t\t\tghostRelativeParent = _getWindowScrollingElement();\n\t\t\t\t\t}\n\t\t\t\t\tghostRelativeParentInitialScroll = _getRelativeScrollOffset(ghostRelativeParent);\n\t\t\t\t}\n\n\n\t\t\t\tghostEl = dragEl.cloneNode(true);\n\n\t\t\t\t_toggleClass(ghostEl, options.ghostClass, false);\n\t\t\t\t_toggleClass(ghostEl, options.fallbackClass, true);\n\t\t\t\t_toggleClass(ghostEl, options.dragClass, true);\n\n\t\t\t\t_css(ghostEl, 'box-sizing', 'border-box');\n\t\t\t\t_css(ghostEl, 'margin', 0);\n\t\t\t\t_css(ghostEl, 'top', rect.top);\n\t\t\t\t_css(ghostEl, 'left', rect.left);\n\t\t\t\t_css(ghostEl, 'width', rect.width);\n\t\t\t\t_css(ghostEl, 'height', rect.height);\n\t\t\t\t_css(ghostEl, 'opacity', '0.8');\n\t\t\t\t_css(ghostEl, 'position', (PositionGhostAbsolutely ? 'absolute' : 'fixed'));\n\t\t\t\t_css(ghostEl, 'zIndex', '100000');\n\t\t\t\t_css(ghostEl, 'pointerEvents', 'none');\n\n\t\t\t\tcontainer.appendChild(ghostEl);\n\t\t\t}\n\t\t},\n\n\t\t_onDragStart: function (/**Event*/evt, /**boolean*/fallback) {\n\t\t\tvar _this = this;\n\t\t\tvar dataTransfer = evt.dataTransfer;\n\t\t\tvar options = _this.options;\n\n\t\t\t// Setup clone\n\t\t\tcloneEl = _clone(dragEl);\n\n\t\t\tcloneEl.draggable = false;\n\t\t\tcloneEl.style['will-change'] = '';\n\n\t\t\tthis._hideClone();\n\n\t\t\t_toggleClass(cloneEl, _this.options.chosenClass, false);\n\n\n\t\t\t// #1143: IFrame support workaround\n\t\t\t_this._cloneId = _nextTick(function () {\n\t\t\t\tif (!_this.options.removeCloneOnHide) {\n\t\t\t\t\trootEl.insertBefore(cloneEl, dragEl);\n\t\t\t\t}\n\t\t\t\t_dispatchEvent(_this, rootEl, 'clone', dragEl);\n\t\t\t});\n\n\n\t\t\t!fallback && _toggleClass(dragEl, options.dragClass, true);\n\n\t\t\t// Set proper drop events\n\t\t\tif (fallback) {\n\t\t\t\tignoreNextClick = true;\n\t\t\t\t_this._loopId = setInterval(_this._emulateDragOver, 50);\n\t\t\t} else {\n\t\t\t\t// Undo what was set in _prepareDragStart before drag started\n\t\t\t\t_off(document, 'mouseup', _this._onDrop);\n\t\t\t\t_off(document, 'touchend', _this._onDrop);\n\t\t\t\t_off(document, 'touchcancel', _this._onDrop);\n\n\t\t\t\tif (dataTransfer) {\n\t\t\t\t\tdataTransfer.effectAllowed = 'move';\n\t\t\t\t\toptions.setData && options.setData.call(_this, dataTransfer, dragEl);\n\t\t\t\t}\n\n\t\t\t\t_on(document, 'drop', _this);\n\n\t\t\t\t// #1276 fix:\n\t\t\t\t_css(dragEl, 'transform', 'translateZ(0)');\n\t\t\t}\n\n\t\t\tawaitingDragStarted = true;\n\n\t\t\t_this._dragStartId = _nextTick(_this._dragStarted.bind(_this, fallback, evt));\n\t\t\t_on(document, 'selectstart', _this);\n\t\t\tif (Safari) {\n\t\t\t\t_css(document.body, 'user-select', 'none');\n\t\t\t}\n\t\t},\n\n\n\t\t// Returns true - if no further action is needed (either inserted or another condition)\n\t\t_onDragOver: function (/**Event*/evt) {\n\t\t\tvar el = this.el,\n\t\t\t\ttarget = evt.target,\n\t\t\t\tdragRect,\n\t\t\t\ttargetRect,\n\t\t\t\trevert,\n\t\t\t\toptions = this.options,\n\t\t\t\tgroup = options.group,\n\t\t\t\tactiveSortable = Sortable.active,\n\t\t\t\tisOwner = (activeGroup === group),\n\t\t\t\tcanSort = options.sort,\n\t\t\t\t_this = this;\n\n\t\t\tif (_silent) return;\n\n\t\t\t// Return invocation when dragEl is inserted (or completed)\n\t\t\tfunction completed(insertion) {\n\t\t\t\tif (insertion) {\n\t\t\t\t\tif (isOwner) {\n\t\t\t\t\t\tactiveSortable._hideClone();\n\t\t\t\t\t} else {\n\t\t\t\t\t\tactiveSortable._showClone(_this);\n\t\t\t\t\t}\n\n\t\t\t\t\tif (activeSortable) {\n\t\t\t\t\t\t// Set ghost class to new sortable's ghost class\n\t\t\t\t\t\t_toggleClass(dragEl, putSortable ? putSortable.options.ghostClass : activeSortable.options.ghostClass, false);\n\t\t\t\t\t\t_toggleClass(dragEl, options.ghostClass, true);\n\t\t\t\t\t}\n\n\t\t\t\t\tif (putSortable !== _this && _this !== Sortable.active) {\n\t\t\t\t\t\tputSortable = _this;\n\t\t\t\t\t} else if (_this === Sortable.active) {\n\t\t\t\t\t\tputSortable = null;\n\t\t\t\t\t}\n\n\t\t\t\t\t// Animation\n\t\t\t\t\tdragRect && _this._animate(dragRect, dragEl);\n\t\t\t\t\ttarget && targetRect && _this._animate(targetRect, target);\n\t\t\t\t}\n\n\n\t\t\t\t// Null lastTarget if it is not inside a previously swapped element\n\t\t\t\tif ((target === dragEl && !dragEl.animated) || (target === el && !target.animated)) {\n\t\t\t\t\tlastTarget = null;\n\t\t\t\t}\n\n\t\t\t\t// no bubbling and not fallback\n\t\t\t\tif (!options.dragoverBubble && !evt.rootEl && target !== document) {\n\t\t\t\t\t_this._handleAutoScroll(evt);\n\t\t\t\t\tdragEl.parentNode[expando]._computeIsAligned(evt);\n\n\t\t\t\t\t// Do not detect for empty insert if already inserted\n\t\t\t\t\t!insertion && nearestEmptyInsertDetectEvent(evt);\n\t\t\t\t}\n\n\t\t\t\t!options.dragoverBubble && evt.stopPropagation && evt.stopPropagation();\n\n\t\t\t\treturn true;\n\t\t\t}\n\n\t\t\t// Call when dragEl has been inserted\n\t\t\tfunction changed() {\n\t\t\t\t_dispatchEvent(_this, rootEl, 'change', target, el, rootEl, oldIndex, _index(dragEl), oldDraggableIndex, _index(dragEl, options.draggable), evt);\n\t\t\t}\n\n\n\t\t\tif (evt.preventDefault !== void 0) {\n\t\t\t\tevt.cancelable && evt.preventDefault();\n\t\t\t}\n\n\n\t\t\tmoved = true;\n\n\t\t\ttarget = _closest(target, options.draggable, el, true);\n\n\t\t\t// target is dragEl or target is animated\n\t\t\tif (dragEl.contains(evt.target) || target.animated) {\n\t\t\t\treturn completed(false);\n\t\t\t}\n\n\t\t\tif (target !== dragEl) {\n\t\t\t\tignoreNextClick = false;\n\t\t\t}\n\n\t\t\tif (activeSortable && !options.disabled &&\n\t\t\t\t(isOwner\n\t\t\t\t\t? canSort || (revert = !rootEl.contains(dragEl)) // Reverting item into the original list\n\t\t\t\t\t: (\n\t\t\t\t\t\tputSortable === this ||\n\t\t\t\t\t\t(\n\t\t\t\t\t\t\t(this.lastPutMode = activeGroup.checkPull(this, activeSortable, dragEl, evt)) &&\n\t\t\t\t\t\t\tgroup.checkPut(this, activeSortable, dragEl, evt)\n\t\t\t\t\t\t)\n\t\t\t\t\t)\n\t\t\t\t)\n\t\t\t) {\n\t\t\t\tvar axis = this._getDirection(evt, target);\n\n\t\t\t\tdragRect = _getRect(dragEl);\n\n\t\t\t\tif (revert) {\n\t\t\t\t\tthis._hideClone();\n\t\t\t\t\tparentEl = rootEl; // actualization\n\n\t\t\t\t\tif (nextEl) {\n\t\t\t\t\t\trootEl.insertBefore(dragEl, nextEl);\n\t\t\t\t\t} else {\n\t\t\t\t\t\trootEl.appendChild(dragEl);\n\t\t\t\t\t}\n\n\t\t\t\t\treturn completed(true);\n\t\t\t\t}\n\n\t\t\t\tvar elLastChild = _lastChild(el);\n\n\t\t\t\tif (!elLastChild || _ghostIsLast(evt, axis, el) && !elLastChild.animated) {\n\t\t\t\t\t// assign target only if condition is true\n\t\t\t\t\tif (elLastChild && el === evt.target) {\n\t\t\t\t\t\ttarget = elLastChild;\n\t\t\t\t\t}\n\n\t\t\t\t\tif (target) {\n\t\t\t\t\t\ttargetRect = _getRect(target);\n\t\t\t\t\t}\n\n\t\t\t\t\tif (isOwner) {\n\t\t\t\t\t\tactiveSortable._hideClone();\n\t\t\t\t\t} else {\n\t\t\t\t\t\tactiveSortable._showClone(this);\n\t\t\t\t\t}\n\n\t\t\t\t\tif (_onMove(rootEl, el, dragEl, dragRect, target, targetRect, evt, !!target) !== false) {\n\t\t\t\t\t\tel.appendChild(dragEl);\n\t\t\t\t\t\tparentEl = el; // actualization\n\t\t\t\t\t\trealDragElRect = null;\n\n\t\t\t\t\t\tchanged();\n\t\t\t\t\t\treturn completed(true);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\telse if (target && target !== dragEl && target.parentNode === el) {\n\t\t\t\t\tvar direction = 0,\n\t\t\t\t\t\ttargetBeforeFirstSwap,\n\t\t\t\t\t\taligned = target.sortableMouseAligned,\n\t\t\t\t\t\tdifferentLevel = dragEl.parentNode !== el,\n\t\t\t\t\t\tside1 = axis === 'vertical' ? 'top' : 'left',\n\t\t\t\t\t\tscrolledPastTop = _isScrolledPast(target, 'top') || _isScrolledPast(dragEl, 'top'),\n\t\t\t\t\t\tscrollBefore = scrolledPastTop ? scrolledPastTop.scrollTop : void 0;\n\n\n\t\t\t\t\tif (lastTarget !== target) {\n\t\t\t\t\t\tlastMode = null;\n\t\t\t\t\t\ttargetBeforeFirstSwap = _getRect(target)[side1];\n\t\t\t\t\t\tpastFirstInvertThresh = false;\n\t\t\t\t\t}\n\n\t\t\t\t\t// Reference: https://www.lucidchart.com/documents/view/10fa0e93-e362-4126-aca2-b709ee56bd8b/0\n\t\t\t\t\tif (\n\t\t\t\t\t\t_isElInRowColumn(dragEl, target, axis) && aligned ||\n\t\t\t\t\t\tdifferentLevel ||\n\t\t\t\t\t\tscrolledPastTop ||\n\t\t\t\t\t\toptions.invertSwap ||\n\t\t\t\t\t\tlastMode === 'insert' ||\n\t\t\t\t\t\t// Needed, in the case that we are inside target and inserted because not aligned... aligned will stay false while inside\n\t\t\t\t\t\t// and lastMode will change to 'insert', but we must swap\n\t\t\t\t\t\tlastMode === 'swap'\n\t\t\t\t\t) {\n\t\t\t\t\t\t// New target that we will be inside\n\t\t\t\t\t\tif (lastMode !== 'swap') {\n\t\t\t\t\t\t\tisCircumstantialInvert = options.invertSwap || differentLevel;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tdirection = _getSwapDirection(evt, target, axis,\n\t\t\t\t\t\t\toptions.swapThreshold, options.invertedSwapThreshold == null ? options.swapThreshold : options.invertedSwapThreshold,\n\t\t\t\t\t\t\tisCircumstantialInvert,\n\t\t\t\t\t\t\tlastTarget === target);\n\t\t\t\t\t\tlastMode = 'swap';\n\t\t\t\t\t} else {\n\t\t\t\t\t\t// Insert at position\n\t\t\t\t\t\tdirection = _getInsertDirection(target);\n\t\t\t\t\t\tlastMode = 'insert';\n\t\t\t\t\t}\n\t\t\t\t\tif (direction === 0) return completed(false);\n\n\t\t\t\t\trealDragElRect = null;\n\t\t\t\t\tlastTarget = target;\n\n\t\t\t\t\tlastDirection = direction;\n\n\t\t\t\t\ttargetRect = _getRect(target);\n\n\t\t\t\t\tvar nextSibling = target.nextElementSibling,\n\t\t\t\t\t\tafter = false;\n\n\t\t\t\t\tafter = direction === 1;\n\n\t\t\t\t\tvar moveVector = _onMove(rootEl, el, dragEl, dragRect, target, targetRect, evt, after);\n\n\t\t\t\t\tif (moveVector !== false) {\n\t\t\t\t\t\tif (moveVector === 1 || moveVector === -1) {\n\t\t\t\t\t\t\tafter = (moveVector === 1);\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\t_silent = true;\n\t\t\t\t\t\tsetTimeout(_unsilent, 30);\n\n\t\t\t\t\t\tif (isOwner) {\n\t\t\t\t\t\t\tactiveSortable._hideClone();\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tactiveSortable._showClone(this);\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tif (after && !nextSibling) {\n\t\t\t\t\t\t\tel.appendChild(dragEl);\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\ttarget.parentNode.insertBefore(dragEl, after ? nextSibling : target);\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\t// Undo chrome's scroll adjustment\n\t\t\t\t\t\tif (scrolledPastTop) {\n\t\t\t\t\t\t\t_scrollBy(scrolledPastTop, 0, scrollBefore - scrolledPastTop.scrollTop);\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tparentEl = dragEl.parentNode; // actualization\n\n\t\t\t\t\t\t// must be done before animation\n\t\t\t\t\t\tif (targetBeforeFirstSwap !== undefined && !isCircumstantialInvert) {\n\t\t\t\t\t\t\ttargetMoveDistance = abs(targetBeforeFirstSwap - _getRect(target)[side1]);\n\t\t\t\t\t\t}\n\t\t\t\t\t\tchanged();\n\n\t\t\t\t\t\treturn completed(true);\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tif (el.contains(dragEl)) {\n\t\t\t\t\treturn completed(false);\n\t\t\t\t}\n\t\t\t}\n\n\t\t\treturn false;\n\t\t},\n\n\t\t_animate: function (prevRect, target) {\n\t\t\tvar ms = this.options.animation;\n\n\t\t\tif (ms) {\n\t\t\t\tvar currentRect = _getRect(target);\n\n\t\t\t\tif (target === dragEl) {\n\t\t\t\t\trealDragElRect = currentRect;\n\t\t\t\t}\n\n\t\t\t\tif (prevRect.nodeType === 1) {\n\t\t\t\t\tprevRect = _getRect(prevRect);\n\t\t\t\t}\n\n\t\t\t\t// Check if actually moving position\n\t\t\t\tif ((prevRect.left + prevRect.width / 2) !== (currentRect.left + currentRect.width / 2)\n\t\t\t\t\t|| (prevRect.top + prevRect.height / 2) !== (currentRect.top + currentRect.height / 2)\n\t\t\t\t) {\n\t\t\t\t\tvar matrix = _matrix(this.el),\n\t\t\t\t\t\tscaleX = matrix && matrix.a,\n\t\t\t\t\t\tscaleY = matrix && matrix.d;\n\n\t\t\t\t\t_css(target, 'transition', 'none');\n\t\t\t\t\t_css(target, 'transform', 'translate3d('\n\t\t\t\t\t\t+ (prevRect.left - currentRect.left) / (scaleX ? scaleX : 1) + 'px,'\n\t\t\t\t\t\t+ (prevRect.top - currentRect.top) / (scaleY ? scaleY : 1) + 'px,0)'\n\t\t\t\t\t);\n\n\t\t\t\t\tthis._repaint(target);\n\t\t\t\t\t_css(target, 'transition', 'transform ' + ms + 'ms' + (this.options.easing ? ' ' + this.options.easing : ''));\n\t\t\t\t\t_css(target, 'transform', 'translate3d(0,0,0)');\n\t\t\t\t}\n\n\t\t\t\t(typeof target.animated === 'number') && clearTimeout(target.animated);\n\t\t\t\ttarget.animated = setTimeout(function () {\n\t\t\t\t\t_css(target, 'transition', '');\n\t\t\t\t\t_css(target, 'transform', '');\n\t\t\t\t\ttarget.animated = false;\n\t\t\t\t}, ms);\n\t\t\t}\n\t\t},\n\n\t\t_repaint: function(target) {\n\t\t\treturn target.offsetWidth;\n\t\t},\n\n\t\t_offMoveEvents: function() {\n\t\t\t_off(document, 'touchmove', this._onTouchMove);\n\t\t\t_off(document, 'pointermove', this._onTouchMove);\n\t\t\t_off(document, 'dragover', nearestEmptyInsertDetectEvent);\n\t\t\t_off(document, 'mousemove', nearestEmptyInsertDetectEvent);\n\t\t\t_off(document, 'touchmove', nearestEmptyInsertDetectEvent);\n\t\t},\n\n\t\t_offUpEvents: function () {\n\t\t\tvar ownerDocument = this.el.ownerDocument;\n\n\t\t\t_off(ownerDocument, 'mouseup', this._onDrop);\n\t\t\t_off(ownerDocument, 'touchend', this._onDrop);\n\t\t\t_off(ownerDocument, 'pointerup', this._onDrop);\n\t\t\t_off(ownerDocument, 'touchcancel', this._onDrop);\n\t\t\t_off(document, 'selectstart', this);\n\t\t},\n\n\t\t_onDrop: function (/**Event*/evt) {\n\t\t\tvar el = this.el,\n\t\t\t\toptions = this.options;\n\t\t\tawaitingDragStarted = false;\n\t\t\tscrolling = false;\n\t\t\tisCircumstantialInvert = false;\n\t\t\tpastFirstInvertThresh = false;\n\n\t\t\tclearInterval(this._loopId);\n\n\t\t\tclearInterval(pointerElemChangedInterval);\n\t\t\t_clearAutoScrolls();\n\t\t\t_cancelThrottle();\n\n\t\t\tclearTimeout(this._dragStartTimer);\n\n\t\t\t_cancelNextTick(this._cloneId);\n\t\t\t_cancelNextTick(this._dragStartId);\n\n\t\t\t// Unbind events\n\t\t\t_off(document, 'mousemove', this._onTouchMove);\n\n\n\t\t\tif (this.nativeDraggable) {\n\t\t\t\t_off(document, 'drop', this);\n\t\t\t\t_off(el, 'dragstart', this._onDragStart);\n\t\t\t\t_off(document, 'dragover', this._handleAutoScroll);\n\t\t\t\t_off(document, 'dragover', _checkAlignment);\n\t\t\t}\n\n\t\t\tif (Safari) {\n\t\t\t\t_css(document.body, 'user-select', '');\n\t\t\t}\n\n\t\t\tthis._offMoveEvents();\n\t\t\tthis._offUpEvents();\n\n\t\t\tif (evt) {\n\t\t\t\tif (moved) {\n\t\t\t\t\tevt.cancelable && evt.preventDefault();\n\t\t\t\t\t!options.dropBubble && evt.stopPropagation();\n\t\t\t\t}\n\n\t\t\t\tghostEl && ghostEl.parentNode && ghostEl.parentNode.removeChild(ghostEl);\n\n\t\t\t\tif (rootEl === parentEl || (putSortable && putSortable.lastPutMode !== 'clone')) {\n\t\t\t\t\t// Remove clone\n\t\t\t\t\tcloneEl && cloneEl.parentNode && cloneEl.parentNode.removeChild(cloneEl);\n\t\t\t\t}\n\n\t\t\t\tif (dragEl) {\n\t\t\t\t\tif (this.nativeDraggable) {\n\t\t\t\t\t\t_off(dragEl, 'dragend', this);\n\t\t\t\t\t}\n\n\t\t\t\t\t_disableDraggable(dragEl);\n\t\t\t\t\tdragEl.style['will-change'] = '';\n\n\t\t\t\t\t// Remove class's\n\t\t\t\t\t_toggleClass(dragEl, putSortable ? putSortable.options.ghostClass : this.options.ghostClass, false);\n\t\t\t\t\t_toggleClass(dragEl, this.options.chosenClass, false);\n\n\t\t\t\t\t// Drag stop event\n\t\t\t\t\t_dispatchEvent(this, rootEl, 'unchoose', dragEl, parentEl, rootEl, oldIndex, null, oldDraggableIndex, null, evt);\n\n\t\t\t\t\tif (rootEl !== parentEl) {\n\t\t\t\t\t\tnewIndex = _index(dragEl);\n\t\t\t\t\t\tnewDraggableIndex = _index(dragEl, options.draggable);\n\n\t\t\t\t\t\tif (newIndex >= 0) {\n\t\t\t\t\t\t\t// Add event\n\t\t\t\t\t\t\t_dispatchEvent(null, parentEl, 'add', dragEl, parentEl, rootEl, oldIndex, newIndex, oldDraggableIndex, newDraggableIndex, evt);\n\n\t\t\t\t\t\t\t// Remove event\n\t\t\t\t\t\t\t_dispatchEvent(this, rootEl, 'remove', dragEl, parentEl, rootEl, oldIndex, newIndex, oldDraggableIndex, newDraggableIndex, evt);\n\n\t\t\t\t\t\t\t// drag from one list and drop into another\n\t\t\t\t\t\t\t_dispatchEvent(null, parentEl, 'sort', dragEl, parentEl, rootEl, oldIndex, newIndex, oldDraggableIndex, newDraggableIndex, evt);\n\t\t\t\t\t\t\t_dispatchEvent(this, rootEl, 'sort', dragEl, parentEl, rootEl, oldIndex, newIndex, oldDraggableIndex, newDraggableIndex, evt);\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tputSortable && putSortable.save();\n\t\t\t\t\t}\n\t\t\t\t\telse {\n\t\t\t\t\t\tif (dragEl.nextSibling !== nextEl) {\n\t\t\t\t\t\t\t// Get the index of the dragged element within its parent\n\t\t\t\t\t\t\tnewIndex = _index(dragEl);\n\t\t\t\t\t\t\tnewDraggableIndex = _index(dragEl, options.draggable);\n\n\t\t\t\t\t\t\tif (newIndex >= 0) {\n\t\t\t\t\t\t\t\t// drag & drop within the same list\n\t\t\t\t\t\t\t\t_dispatchEvent(this, rootEl, 'update', dragEl, parentEl, rootEl, oldIndex, newIndex, oldDraggableIndex, newDraggableIndex, evt);\n\t\t\t\t\t\t\t\t_dispatchEvent(this, rootEl, 'sort', dragEl, parentEl, rootEl, oldIndex, newIndex, oldDraggableIndex, newDraggableIndex, evt);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t\tif (Sortable.active) {\n\t\t\t\t\t\t/* jshint eqnull:true */\n\t\t\t\t\t\tif (newIndex == null || newIndex === -1) {\n\t\t\t\t\t\t\tnewIndex = oldIndex;\n\t\t\t\t\t\t\tnewDraggableIndex = oldDraggableIndex;\n\t\t\t\t\t\t}\n\t\t\t\t\t\t_dispatchEvent(this, rootEl, 'end', dragEl, parentEl, rootEl, oldIndex, newIndex, oldDraggableIndex, newDraggableIndex, evt);\n\n\t\t\t\t\t\t// Save sorting\n\t\t\t\t\t\tthis.save();\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t}\n\t\t\tthis._nulling();\n\t\t},\n\n\t\t_nulling: function() {\n\t\t\trootEl =\n\t\t\tdragEl =\n\t\t\tparentEl =\n\t\t\tghostEl =\n\t\t\tnextEl =\n\t\t\tcloneEl =\n\t\t\tlastDownEl =\n\n\t\t\tscrollEl =\n\t\t\tscrollParentEl =\n\t\t\tautoScrolls.length =\n\n\t\t\tpointerElemChangedInterval =\n\t\t\tlastPointerElemX =\n\t\t\tlastPointerElemY =\n\n\t\t\ttapEvt =\n\t\t\ttouchEvt =\n\n\t\t\tmoved =\n\t\t\tnewIndex =\n\t\t\toldIndex =\n\n\t\t\tlastTarget =\n\t\t\tlastDirection =\n\n\t\t\trealDragElRect =\n\n\t\t\tputSortable =\n\t\t\tactiveGroup =\n\t\t\tSortable.active = null;\n\n\t\t\tsavedInputChecked.forEach(function (el) {\n\t\t\t\tel.checked = true;\n\t\t\t});\n\n\t\t\tsavedInputChecked.length = 0;\n\t\t},\n\n\t\thandleEvent: function (/**Event*/evt) {\n\t\t\tswitch (evt.type) {\n\t\t\t\tcase 'drop':\n\t\t\t\tcase 'dragend':\n\t\t\t\t\tthis._onDrop(evt);\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase 'dragenter':\n\t\t\t\tcase 'dragover':\n\t\t\t\t\tif (dragEl) {\n\t\t\t\t\t\tthis._onDragOver(evt);\n\t\t\t\t\t\t_globalDragOver(evt);\n\t\t\t\t\t}\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase 'selectstart':\n\t\t\t\t\tevt.preventDefault();\n\t\t\t\t\tbreak;\n\t\t\t}\n\t\t},\n\n\n\t\t/**\n\t\t * Serializes the item into an array of string.\n\t\t * @returns {String[]}\n\t\t */\n\t\ttoArray: function () {\n\t\t\tvar order = [],\n\t\t\t\tel,\n\t\t\t\tchildren = this.el.children,\n\t\t\t\ti = 0,\n\t\t\t\tn = children.length,\n\t\t\t\toptions = this.options;\n\n\t\t\tfor (; i < n; i++) {\n\t\t\t\tel = children[i];\n\t\t\t\tif (_closest(el, options.draggable, this.el, false)) {\n\t\t\t\t\torder.push(el.getAttribute(options.dataIdAttr) || _generateId(el));\n\t\t\t\t}\n\t\t\t}\n\n\t\t\treturn order;\n\t\t},\n\n\n\t\t/**\n\t\t * Sorts the elements according to the array.\n\t\t * @param  {String[]}  order  order of the items\n\t\t */\n\t\tsort: function (order) {\n\t\t\tvar items = {}, rootEl = this.el;\n\n\t\t\tthis.toArray().forEach(function (id, i) {\n\t\t\t\tvar el = rootEl.children[i];\n\n\t\t\t\tif (_closest(el, this.options.draggable, rootEl, false)) {\n\t\t\t\t\titems[id] = el;\n\t\t\t\t}\n\t\t\t}, this);\n\n\t\t\torder.forEach(function (id) {\n\t\t\t\tif (items[id]) {\n\t\t\t\t\trootEl.removeChild(items[id]);\n\t\t\t\t\trootEl.appendChild(items[id]);\n\t\t\t\t}\n\t\t\t});\n\t\t},\n\n\n\t\t/**\n\t\t * Save the current sorting\n\t\t */\n\t\tsave: function () {\n\t\t\tvar store = this.options.store;\n\t\t\tstore && store.set && store.set(this);\n\t\t},\n\n\n\t\t/**\n\t\t * For each element in the set, get the first element that matches the selector by testing the element itself and traversing up through its ancestors in the DOM tree.\n\t\t * @param   {HTMLElement}  el\n\t\t * @param   {String}       [selector]  default: `options.draggable`\n\t\t * @returns {HTMLElement|null}\n\t\t */\n\t\tclosest: function (el, selector) {\n\t\t\treturn _closest(el, selector || this.options.draggable, this.el, false);\n\t\t},\n\n\n\t\t/**\n\t\t * Set/get option\n\t\t * @param   {string} name\n\t\t * @param   {*}      [value]\n\t\t * @returns {*}\n\t\t */\n\t\toption: function (name, value) {\n\t\t\tvar options = this.options;\n\n\t\t\tif (value === void 0) {\n\t\t\t\treturn options[name];\n\t\t\t} else {\n\t\t\t\toptions[name] = value;\n\n\t\t\t\tif (name === 'group') {\n\t\t\t\t\t_prepareGroup(options);\n\t\t\t\t}\n\t\t\t}\n\t\t},\n\n\n\t\t/**\n\t\t * Destroy\n\t\t */\n\t\tdestroy: function () {\n\t\t\tvar el = this.el;\n\n\t\t\tel[expando] = null;\n\n\t\t\t_off(el, 'mousedown', this._onTapStart);\n\t\t\t_off(el, 'touchstart', this._onTapStart);\n\t\t\t_off(el, 'pointerdown', this._onTapStart);\n\n\t\t\tif (this.nativeDraggable) {\n\t\t\t\t_off(el, 'dragover', this);\n\t\t\t\t_off(el, 'dragenter', this);\n\t\t\t}\n\t\t\t// Remove draggable attributes\n\t\t\tArray.prototype.forEach.call(el.querySelectorAll('[draggable]'), function (el) {\n\t\t\t\tel.removeAttribute('draggable');\n\t\t\t});\n\n\t\t\tthis._onDrop();\n\n\t\t\tsortables.splice(sortables.indexOf(this.el), 1);\n\n\t\t\tthis.el = el = null;\n\t\t},\n\n\t\t_hideClone: function() {\n\t\t\tif (!cloneEl.cloneHidden) {\n\t\t\t\t_css(cloneEl, 'display', 'none');\n\t\t\t\tcloneEl.cloneHidden = true;\n\t\t\t\tif (cloneEl.parentNode && this.options.removeCloneOnHide) {\n\t\t\t\t\tcloneEl.parentNode.removeChild(cloneEl);\n\t\t\t\t}\n\t\t\t}\n\t\t},\n\n\t\t_showClone: function(putSortable) {\n\t\t\tif (putSortable.lastPutMode !== 'clone') {\n\t\t\t\tthis._hideClone();\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tif (cloneEl.cloneHidden) {\n\t\t\t\t// show clone at dragEl or original position\n\t\t\t\tif (rootEl.contains(dragEl) && !this.options.group.revertClone) {\n\t\t\t\t\trootEl.insertBefore(cloneEl, dragEl);\n\t\t\t\t} else if (nextEl) {\n\t\t\t\t\trootEl.insertBefore(cloneEl, nextEl);\n\t\t\t\t} else {\n\t\t\t\t\trootEl.appendChild(cloneEl);\n\t\t\t\t}\n\n\t\t\t\tif (this.options.group.revertClone) {\n\t\t\t\t\tthis._animate(dragEl, cloneEl);\n\t\t\t\t}\n\t\t\t\t_css(cloneEl, 'display', '');\n\t\t\t\tcloneEl.cloneHidden = false;\n\t\t\t}\n\t\t}\n\t};\n\n\tfunction _closest(/**HTMLElement*/el, /**String*/selector, /**HTMLElement*/ctx, includeCTX) {\n\t\tif (el) {\n\t\t\tctx = ctx || document;\n\n\t\t\tdo {\n\t\t\t\tif (\n\t\t\t\t\tselector != null &&\n\t\t\t\t\t(\n\t\t\t\t\t\tselector[0] === '>' ?\n\t\t\t\t\t\tel.parentNode === ctx && _matches(el, selector) :\n\t\t\t\t\t\t_matches(el, selector)\n\t\t\t\t\t) ||\n\t\t\t\t\tincludeCTX && el === ctx\n\t\t\t\t) {\n\t\t\t\t\treturn el;\n\t\t\t\t}\n\n\t\t\t\tif (el === ctx) break;\n\t\t\t\t/* jshint boss:true */\n\t\t\t} while (el = _getParentOrHost(el));\n\t\t}\n\n\t\treturn null;\n\t}\n\n\n\tfunction _getParentOrHost(el) {\n\t\treturn (el.host && el !== document && el.host.nodeType)\n\t\t\t? el.host\n\t\t\t: el.parentNode;\n\t}\n\n\n\tfunction _globalDragOver(/**Event*/evt) {\n\t\tif (evt.dataTransfer) {\n\t\t\tevt.dataTransfer.dropEffect = 'move';\n\t\t}\n\t\tevt.cancelable && evt.preventDefault();\n\t}\n\n\n\tfunction _on(el, event, fn) {\n\t\tel.addEventListener(event, fn, IE11OrLess ? false : captureMode);\n\t}\n\n\n\tfunction _off(el, event, fn) {\n\t\tel.removeEventListener(event, fn, IE11OrLess ? false : captureMode);\n\t}\n\n\n\tfunction _toggleClass(el, name, state) {\n\t\tif (el && name) {\n\t\t\tif (el.classList) {\n\t\t\t\tel.classList[state ? 'add' : 'remove'](name);\n\t\t\t}\n\t\t\telse {\n\t\t\t\tvar className = (' ' + el.className + ' ').replace(R_SPACE, ' ').replace(' ' + name + ' ', ' ');\n\t\t\t\tel.className = (className + (state ? ' ' + name : '')).replace(R_SPACE, ' ');\n\t\t\t}\n\t\t}\n\t}\n\n\n\tfunction _css(el, prop, val) {\n\t\tvar style = el && el.style;\n\n\t\tif (style) {\n\t\t\tif (val === void 0) {\n\t\t\t\tif (document.defaultView && document.defaultView.getComputedStyle) {\n\t\t\t\t\tval = document.defaultView.getComputedStyle(el, '');\n\t\t\t\t}\n\t\t\t\telse if (el.currentStyle) {\n\t\t\t\t\tval = el.currentStyle;\n\t\t\t\t}\n\n\t\t\t\treturn prop === void 0 ? val : val[prop];\n\t\t\t}\n\t\t\telse {\n\t\t\t\tif (!(prop in style) && prop.indexOf('webkit') === -1) {\n\t\t\t\t\tprop = '-webkit-' + prop;\n\t\t\t\t}\n\n\t\t\t\tstyle[prop] = val + (typeof val === 'string' ? '' : 'px');\n\t\t\t}\n\t\t}\n\t}\n\n\tfunction _matrix(el) {\n\t\tvar appliedTransforms = '';\n\t\tdo {\n\t\t\tvar transform = _css(el, 'transform');\n\n\t\t\tif (transform && transform !== 'none') {\n\t\t\t\tappliedTransforms = transform + ' ' + appliedTransforms;\n\t\t\t}\n\t\t\t/* jshint boss:true */\n\t\t} while (el = el.parentNode);\n\n\t\tif (window.DOMMatrix) {\n\t\t\treturn new DOMMatrix(appliedTransforms);\n\t\t} else if (window.WebKitCSSMatrix) {\n\t\t\treturn new WebKitCSSMatrix(appliedTransforms);\n\t\t} else if (window.CSSMatrix) {\n\t\t\treturn new CSSMatrix(appliedTransforms);\n\t\t}\n\t}\n\n\n\tfunction _find(ctx, tagName, iterator) {\n\t\tif (ctx) {\n\t\t\tvar list = ctx.getElementsByTagName(tagName), i = 0, n = list.length;\n\n\t\t\tif (iterator) {\n\t\t\t\tfor (; i < n; i++) {\n\t\t\t\t\titerator(list[i], i);\n\t\t\t\t}\n\t\t\t}\n\n\t\t\treturn list;\n\t\t}\n\n\t\treturn [];\n\t}\n\n\n\n\tfunction _dispatchEvent(\n\t\tsortable, rootEl, name,\n\t\ttargetEl, toEl, fromEl,\n\t\tstartIndex, newIndex,\n\t\tstartDraggableIndex, newDraggableIndex,\n\t\toriginalEvt\n\t) {\n\t\tsortable = (sortable || rootEl[expando]);\n\t\tvar evt,\n\t\t\toptions = sortable.options,\n\t\t\tonName = 'on' + name.charAt(0).toUpperCase() + name.substr(1);\n\t\t// Support for new CustomEvent feature\n\t\tif (window.CustomEvent && !IE11OrLess && !Edge) {\n\t\t\tevt = new CustomEvent(name, {\n\t\t\t\tbubbles: true,\n\t\t\t\tcancelable: true\n\t\t\t});\n\t\t} else {\n\t\t\tevt = document.createEvent('Event');\n\t\t\tevt.initEvent(name, true, true);\n\t\t}\n\n\t\tevt.to = toEl || rootEl;\n\t\tevt.from = fromEl || rootEl;\n\t\tevt.item = targetEl || rootEl;\n\t\tevt.clone = cloneEl;\n\n\t\tevt.oldIndex = startIndex;\n\t\tevt.newIndex = newIndex;\n\n\t\tevt.oldDraggableIndex = startDraggableIndex;\n\t\tevt.newDraggableIndex = newDraggableIndex;\n\n\t\tevt.originalEvent = originalEvt;\n\t\tevt.pullMode = putSortable ? putSortable.lastPutMode : undefined;\n\n\t\tif (rootEl) {\n\t\t\trootEl.dispatchEvent(evt);\n\t\t}\n\n\t\tif (options[onName]) {\n\t\t\toptions[onName].call(sortable, evt);\n\t\t}\n\t}\n\n\n\tfunction _onMove(fromEl, toEl, dragEl, dragRect, targetEl, targetRect, originalEvt, willInsertAfter) {\n\t\tvar evt,\n\t\t\tsortable = fromEl[expando],\n\t\t\tonMoveFn = sortable.options.onMove,\n\t\t\tretVal;\n\t\t// Support for new CustomEvent feature\n\t\tif (window.CustomEvent && !IE11OrLess && !Edge) {\n\t\t\tevt = new CustomEvent('move', {\n\t\t\t\tbubbles: true,\n\t\t\t\tcancelable: true\n\t\t\t});\n\t\t} else {\n\t\t\tevt = document.createEvent('Event');\n\t\t\tevt.initEvent('move', true, true);\n\t\t}\n\n\t\tevt.to = toEl;\n\t\tevt.from = fromEl;\n\t\tevt.dragged = dragEl;\n\t\tevt.draggedRect = dragRect;\n\t\tevt.related = targetEl || toEl;\n\t\tevt.relatedRect = targetRect || _getRect(toEl);\n\t\tevt.willInsertAfter = willInsertAfter;\n\n\t\tevt.originalEvent = originalEvt;\n\n\t\tfromEl.dispatchEvent(evt);\n\n\t\tif (onMoveFn) {\n\t\t\tretVal = onMoveFn.call(sortable, evt, originalEvt);\n\t\t}\n\n\t\treturn retVal;\n\t}\n\n\tfunction _disableDraggable(el) {\n\t\tel.draggable = false;\n\t}\n\n\tfunction _unsilent() {\n\t\t_silent = false;\n\t}\n\n\t/**\n\t * Gets nth child of el, ignoring hidden children, sortable's elements (does not ignore clone if it's visible)\n\t * and non-draggable elements\n\t * @param  {HTMLElement} el       The parent element\n\t * @param  {Number} childNum      The index of the child\n\t * @param  {Object} options       Parent Sortable's options\n\t * @return {HTMLElement}          The child at index childNum, or null if not found\n\t */\n\tfunction _getChild(el, childNum, options) {\n\t\tvar currentChild = 0,\n\t\t\ti = 0,\n\t\t\tchildren = el.children;\n\n\t\twhile (i < children.length) {\n\t\t\tif (\n\t\t\t\tchildren[i].style.display !== 'none' &&\n\t\t\t\tchildren[i] !== ghostEl &&\n\t\t\t\tchildren[i] !== dragEl &&\n\t\t\t\t_closest(children[i], options.draggable, el, false)\n\t\t\t) {\n\t\t\t\tif (currentChild === childNum) {\n\t\t\t\t\treturn children[i];\n\t\t\t\t}\n\t\t\t\tcurrentChild++;\n\t\t\t}\n\n\t\t\ti++;\n\t\t}\n\t\treturn null;\n\t}\n\n\t/**\n\t * Gets the last child in the el, ignoring ghostEl or invisible elements (clones)\n\t * @param  {HTMLElement} el       Parent element\n\t * @return {HTMLElement}          The last child, ignoring ghostEl\n\t */\n\tfunction _lastChild(el) {\n\t\tvar last = el.lastElementChild;\n\n\t\twhile (last && (last === ghostEl || _css(last, 'display') === 'none')) {\n\t\t\tlast = last.previousElementSibling;\n\t\t}\n\n\t\treturn last || null;\n\t}\n\n\tfunction _ghostIsLast(evt, axis, el) {\n\t\tvar elRect = _getRect(_lastChild(el)),\n\t\t\tmouseOnAxis = axis === 'vertical' ? evt.clientY : evt.clientX,\n\t\t\tmouseOnOppAxis = axis === 'vertical' ? evt.clientX : evt.clientY,\n\t\t\ttargetS2 = axis === 'vertical' ? elRect.bottom : elRect.right,\n\t\t\ttargetS1Opp = axis === 'vertical' ? elRect.left : elRect.top,\n\t\t\ttargetS2Opp = axis === 'vertical' ? elRect.right : elRect.bottom,\n\t\t\tspacer = 10;\n\n\t\treturn (\n\t\t\taxis === 'vertical' ?\n\t\t\t\t(mouseOnOppAxis > targetS2Opp + spacer || mouseOnOppAxis <= targetS2Opp && mouseOnAxis > targetS2 && mouseOnOppAxis >= targetS1Opp) :\n\t\t\t\t(mouseOnAxis > targetS2 && mouseOnOppAxis > targetS1Opp || mouseOnAxis <= targetS2 && mouseOnOppAxis > targetS2Opp + spacer)\n\t\t);\n\t}\n\n\tfunction _getSwapDirection(evt, target, axis, swapThreshold, invertedSwapThreshold, invertSwap, isLastTarget) {\n\t\tvar targetRect = _getRect(target),\n\t\t\tmouseOnAxis = axis === 'vertical' ? evt.clientY : evt.clientX,\n\t\t\ttargetLength = axis === 'vertical' ? targetRect.height : targetRect.width,\n\t\t\ttargetS1 = axis === 'vertical' ? targetRect.top : targetRect.left,\n\t\t\ttargetS2 = axis === 'vertical' ? targetRect.bottom : targetRect.right,\n\t\t\tdragRect = _getRect(dragEl),\n\t\t\tinvert = false;\n\n\n\t\tif (!invertSwap) {\n\t\t\t// Never invert or create dragEl shadow when target movemenet causes mouse to move past the end of regular swapThreshold\n\t\t\tif (isLastTarget && targetMoveDistance < targetLength * swapThreshold) { // multiplied only by swapThreshold because mouse will already be inside target by (1 - threshold) * targetLength / 2\n\t\t\t\t// check if past first invert threshold on side opposite of lastDirection\n\t\t\t\tif (!pastFirstInvertThresh &&\n\t\t\t\t\t(lastDirection === 1 ?\n\t\t\t\t\t\t(\n\t\t\t\t\t\t\tmouseOnAxis > targetS1 + targetLength * invertedSwapThreshold / 2\n\t\t\t\t\t\t) :\n\t\t\t\t\t\t(\n\t\t\t\t\t\t\tmouseOnAxis < targetS2 - targetLength * invertedSwapThreshold / 2\n\t\t\t\t\t\t)\n\t\t\t\t\t)\n\t\t\t\t)\n\t\t\t\t{\n\t\t\t\t\t// past first invert threshold, do not restrict inverted threshold to dragEl shadow\n\t\t\t\t\tpastFirstInvertThresh = true;\n\t\t\t\t}\n\n\t\t\t\tif (!pastFirstInvertThresh) {\n\t\t\t\t\tvar dragS1 = axis === 'vertical' ? dragRect.top : dragRect.left,\n\t\t\t\t\t\tdragS2 = axis === 'vertical' ? dragRect.bottom : dragRect.right;\n\t\t\t\t\t// dragEl shadow (target move distance shadow)\n\t\t\t\t\tif (\n\t\t\t\t\t\tlastDirection === 1 ?\n\t\t\t\t\t\t(\n\t\t\t\t\t\t\tmouseOnAxis < targetS1 + targetMoveDistance // over dragEl shadow\n\t\t\t\t\t\t) :\n\t\t\t\t\t\t(\n\t\t\t\t\t\t\tmouseOnAxis > targetS2 - targetMoveDistance\n\t\t\t\t\t\t)\n\t\t\t\t\t)\n\t\t\t\t\t{\n\t\t\t\t\t\treturn lastDirection * -1;\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\tinvert = true;\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\t// Regular\n\t\t\t\tif (\n\t\t\t\t\tmouseOnAxis > targetS1 + (targetLength * (1 - swapThreshold) / 2) &&\n\t\t\t\t\tmouseOnAxis < targetS2 - (targetLength * (1 - swapThreshold) / 2)\n\t\t\t\t) {\n\t\t\t\t\treturn _getInsertDirection(target);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tinvert = invert || invertSwap;\n\n\t\tif (invert) {\n\t\t\t// Invert of regular\n\t\t\tif (\n\t\t\t\tmouseOnAxis < targetS1 + (targetLength * invertedSwapThreshold / 2) ||\n\t\t\t\tmouseOnAxis > targetS2 - (targetLength * invertedSwapThreshold / 2)\n\t\t\t)\n\t\t\t{\n\t\t\t\treturn ((mouseOnAxis > targetS1 + targetLength / 2) ? 1 : -1);\n\t\t\t}\n\t\t}\n\n\t\treturn 0;\n\t}\n\n\t/**\n\t * Gets the direction dragEl must be swapped relative to target in order to make it\n\t * seem that dragEl has been \"inserted\" into that element's position\n\t * @param  {HTMLElement} target       The target whose position dragEl is being inserted at\n\t * @return {Number}                   Direction dragEl must be swapped\n\t */\n\tfunction _getInsertDirection(target) {\n\t\tvar dragElIndex = _index(dragEl),\n\t\t\ttargetIndex = _index(target);\n\n\t\tif (dragElIndex < targetIndex) {\n\t\t\treturn 1;\n\t\t} else {\n\t\t\treturn -1;\n\t\t}\n\t}\n\n\n\t/**\n\t * Generate id\n\t * @param   {HTMLElement} el\n\t * @returns {String}\n\t * @private\n\t */\n\tfunction _generateId(el) {\n\t\tvar str = el.tagName + el.className + el.src + el.href + el.textContent,\n\t\t\ti = str.length,\n\t\t\tsum = 0;\n\n\t\twhile (i--) {\n\t\t\tsum += str.charCodeAt(i);\n\t\t}\n\n\t\treturn sum.toString(36);\n\t}\n\n\t/**\n\t * Returns the index of an element within its parent for a selected set of\n\t * elements\n\t * @param  {HTMLElement} el\n\t * @param  {selector} selector\n\t * @return {number}\n\t */\n\tfunction _index(el, selector) {\n\t\tvar index = 0;\n\n\t\tif (!el || !el.parentNode) {\n\t\t\treturn -1;\n\t\t}\n\n\t\twhile (el && (el = el.previousElementSibling)) {\n\t\t\tif ((el.nodeName.toUpperCase() !== 'TEMPLATE') && el !== cloneEl && (!selector || _matches(el, selector))) {\n\t\t\t\tindex++;\n\t\t\t}\n\t\t}\n\n\t\treturn index;\n\t}\n\n\tfunction _matches(/**HTMLElement*/el, /**String*/selector) {\n\t\tif (!selector) return;\n\n\t\tselector[0] === '>' && (selector = selector.substring(1));\n\n\t\tif (el) {\n\t\t\ttry {\n\t\t\t\tif (el.matches) {\n\t\t\t\t\treturn el.matches(selector);\n\t\t\t\t} else if (el.msMatchesSelector) {\n\t\t\t\t\treturn el.msMatchesSelector(selector);\n\t\t\t\t} else if (el.webkitMatchesSelector) {\n\t\t\t\t\treturn el.webkitMatchesSelector(selector);\n\t\t\t\t}\n\t\t\t} catch(_) {\n\t\t\t\treturn false;\n\t\t\t}\n\t\t}\n\n\t\treturn false;\n\t}\n\n\tvar _throttleTimeout;\n\tfunction _throttle(callback, ms) {\n\t\treturn function () {\n\t\t\tif (!_throttleTimeout) {\n\t\t\t\tvar args = arguments,\n\t\t\t\t\t_this = this;\n\n\t\t\t\t_throttleTimeout = setTimeout(function () {\n\t\t\t\t\tif (args.length === 1) {\n\t\t\t\t\t\tcallback.call(_this, args[0]);\n\t\t\t\t\t} else {\n\t\t\t\t\t\tcallback.apply(_this, args);\n\t\t\t\t\t}\n\n\t\t\t\t\t_throttleTimeout = void 0;\n\t\t\t\t}, ms);\n\t\t\t}\n\t\t};\n\t}\n\n\tfunction _cancelThrottle() {\n\t\tclearTimeout(_throttleTimeout);\n\t\t_throttleTimeout = void 0;\n\t}\n\n\tfunction _extend(dst, src) {\n\t\tif (dst && src) {\n\t\t\tfor (var key in src) {\n\t\t\t\tif (src.hasOwnProperty(key)) {\n\t\t\t\t\tdst[key] = src[key];\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\treturn dst;\n\t}\n\n\tfunction _clone(el) {\n\t\tif (Polymer && Polymer.dom) {\n\t\t\treturn Polymer.dom(el).cloneNode(true);\n\t\t}\n\t\telse if ($) {\n\t\t\treturn $(el).clone(true)[0];\n\t\t}\n\t\telse {\n\t\t\treturn el.cloneNode(true);\n\t\t}\n\t}\n\n\tfunction _saveInputCheckedState(root) {\n\t\tsavedInputChecked.length = 0;\n\n\t\tvar inputs = root.getElementsByTagName('input');\n\t\tvar idx = inputs.length;\n\n\t\twhile (idx--) {\n\t\t\tvar el = inputs[idx];\n\t\t\tel.checked && savedInputChecked.push(el);\n\t\t}\n\t}\n\n\tfunction _nextTick(fn) {\n\t\treturn setTimeout(fn, 0);\n\t}\n\n\tfunction _cancelNextTick(id) {\n\t\treturn clearTimeout(id);\n\t}\n\n\n\t/**\n\t * Returns the \"bounding client rect\" of given element\n\t * @param  {HTMLElement} el                The element whose boundingClientRect is wanted\n\t * @param  {[HTMLElement]} container       the parent the element will be placed in\n\t * @param  {[Boolean]} adjustForTransform  Whether the rect should compensate for parent's transform\n\t * @return {Object}                        The boundingClientRect of el\n\t */\n\tfunction _getRect(el, adjustForTransform, container, adjustForFixed) {\n\t\tif (!el.getBoundingClientRect && el !== win) return;\n\n\t\tvar elRect,\n\t\t\ttop,\n\t\t\tleft,\n\t\t\tbottom,\n\t\t\tright,\n\t\t\theight,\n\t\t\twidth;\n\n\t\tif (el !== win && el !== _getWindowScrollingElement()) {\n\t\t\telRect = el.getBoundingClientRect();\n\t\t\ttop = elRect.top;\n\t\t\tleft = elRect.left;\n\t\t\tbottom = elRect.bottom;\n\t\t\tright = elRect.right;\n\t\t\theight = elRect.height;\n\t\t\twidth = elRect.width;\n\t\t} else {\n\t\t\ttop = 0;\n\t\t\tleft = 0;\n\t\t\tbottom = window.innerHeight;\n\t\t\tright = window.innerWidth;\n\t\t\theight = window.innerHeight;\n\t\t\twidth = window.innerWidth;\n\t\t}\n\n\t\tif (adjustForFixed && el !== win) {\n\t\t\t// Adjust for translate()\n\t\t\tcontainer = container || el.parentNode;\n\n\t\t\t// solves #1123 (see: https://stackoverflow.com/a/37953806/6088312)\n\t\t\t// Not needed on <= IE11\n\t\t\tif (!IE11OrLess) {\n\t\t\t\tdo {\n\t\t\t\t\tif (container && container.getBoundingClientRect && _css(container, 'transform') !== 'none') {\n\t\t\t\t\t\tvar containerRect = container.getBoundingClientRect();\n\n\t\t\t\t\t\t// Set relative to edges of padding box of container\n\t\t\t\t\t\ttop -= containerRect.top + parseInt(_css(container, 'border-top-width'));\n\t\t\t\t\t\tleft -= containerRect.left + parseInt(_css(container, 'border-left-width'));\n\t\t\t\t\t\tbottom = top + elRect.height;\n\t\t\t\t\t\tright = left + elRect.width;\n\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t\t/* jshint boss:true */\n\t\t\t\t} while (container = container.parentNode);\n\t\t\t}\n\t\t}\n\n\t\tif (adjustForTransform && el !== win) {\n\t\t\t// Adjust for scale()\n\t\t\tvar matrix = _matrix(container || el),\n\t\t\t\tscaleX = matrix && matrix.a,\n\t\t\t\tscaleY = matrix && matrix.d;\n\n\t\t\tif (matrix) {\n\t\t\t\ttop /= scaleY;\n\t\t\t\tleft /= scaleX;\n\n\t\t\t\twidth /= scaleX;\n\t\t\t\theight /= scaleY;\n\n\t\t\t\tbottom = top + height;\n\t\t\t\tright = left + width;\n\t\t\t}\n\t\t}\n\n\t\treturn {\n\t\t\ttop: top,\n\t\t\tleft: left,\n\t\t\tbottom: bottom,\n\t\t\tright: right,\n\t\t\twidth: width,\n\t\t\theight: height\n\t\t};\n\t}\n\n\n\t/**\n\t * Checks if a side of an element is scrolled past a side of it's parents\n\t * @param  {HTMLElement}  el       The element who's side being scrolled out of view is in question\n\t * @param  {String}       side     Side of the element in question ('top', 'left', 'right', 'bottom')\n\t * @return {HTMLElement}           The parent scroll element that the el's side is scrolled past, or null if there is no such element\n\t */\n\tfunction _isScrolledPast(el, side) {\n\t\tvar parent = _getParentAutoScrollElement(el, true),\n\t\t\telSide = _getRect(el)[side];\n\n\t\t/* jshint boss:true */\n\t\twhile (parent) {\n\t\t\tvar parentSide = _getRect(parent)[side],\n\t\t\t\tvisible;\n\n\t\t\tif (side === 'top' || side === 'left') {\n\t\t\t\tvisible = elSide >= parentSide;\n\t\t\t} else {\n\t\t\t\tvisible = elSide <= parentSide;\n\t\t\t}\n\n\t\t\tif (!visible) return parent;\n\n\t\t\tif (parent === _getWindowScrollingElement()) break;\n\n\t\t\tparent = _getParentAutoScrollElement(parent, false);\n\t\t}\n\n\t\treturn false;\n\t}\n\n\t/**\n\t * Returns the scroll offset of the given element, added with all the scroll offsets of parent elements.\n\t * The value is returned in real pixels.\n\t * @param  {HTMLElement} el\n\t * @return {Array}             Offsets in the format of [left, top]\n\t */\n\tfunction _getRelativeScrollOffset(el) {\n\t\tvar offsetLeft = 0,\n\t\t\toffsetTop = 0,\n\t\t\twinScroller = _getWindowScrollingElement();\n\n\t\tif (el) {\n\t\t\tdo {\n\t\t\t\tvar matrix = _matrix(el),\n\t\t\t\t\tscaleX = matrix.a,\n\t\t\t\t\tscaleY = matrix.d;\n\n\t\t\t\toffsetLeft += el.scrollLeft * scaleX;\n\t\t\t\toffsetTop += el.scrollTop * scaleY;\n\t\t\t} while (el !== winScroller && (el = el.parentNode));\n\t\t}\n\n\t\treturn [offsetLeft, offsetTop];\n\t}\n\n\t// Fixed #973:\n\t_on(document, 'touchmove', function(evt) {\n\t\tif ((Sortable.active || awaitingDragStarted) && evt.cancelable) {\n\t\t\tevt.preventDefault();\n\t\t}\n\t});\n\n\n\t// Export utils\n\tSortable.utils = {\n\t\ton: _on,\n\t\toff: _off,\n\t\tcss: _css,\n\t\tfind: _find,\n\t\tis: function (el, selector) {\n\t\t\treturn !!_closest(el, selector, el, false);\n\t\t},\n\t\textend: _extend,\n\t\tthrottle: _throttle,\n\t\tclosest: _closest,\n\t\ttoggleClass: _toggleClass,\n\t\tclone: _clone,\n\t\tindex: _index,\n\t\tnextTick: _nextTick,\n\t\tcancelNextTick: _cancelNextTick,\n\t\tdetectDirection: _detectDirection,\n\t\tgetChild: _getChild\n\t};\n\n\n\t/**\n\t * Create sortable instance\n\t * @param {HTMLElement}  el\n\t * @param {Object}      [options]\n\t */\n\tSortable.create = function (el, options) {\n\t\treturn new Sortable(el, options);\n\t};\n\n\n\t// Export\n\tSortable.version = '1.9.0';\n\treturn Sortable;\n});\n","'use strict';\n\nfunction _interopDefault (ex) { return (ex && (typeof ex === 'object') && 'default' in ex) ? ex['default'] : ex; }\n\nvar Sortable = _interopDefault(require('sortablejs'));\n\nfunction $(expr, con) {\n    return typeof expr === 'string' ?\n        (con || document).querySelector(expr) :\n        expr || null;\n}\n\n$.each = (expr, con) => {\n    return typeof expr === 'string' ?\n        Array.from((con || document).querySelectorAll(expr)) :\n        expr || null;\n};\n\n$.create = (tag, o) => {\n    let element = document.createElement(tag);\n\n    for (let i in o) {\n        let val = o[i];\n\n        if (i === 'inside') {\n            $(val).appendChild(element);\n        } else\n        if (i === 'around') {\n            let ref = $(val);\n            ref.parentNode.insertBefore(element, ref);\n            element.appendChild(ref);\n        } else\n        if (i === 'styles') {\n            if (typeof val === 'object') {\n                Object.keys(val).map(prop => {\n                    element.style[prop] = val[prop];\n                });\n            }\n        } else\n        if (i in element) {\n            element[i] = val;\n        } else {\n            element.setAttribute(i, val);\n        }\n    }\n\n    return element;\n};\n\n$.on = (element, event, selector, callback) => {\n    if (!callback) {\n        callback = selector;\n        $.bind(element, event, callback);\n    } else {\n        $.delegate(element, event, selector, callback);\n    }\n};\n\n$.off = (element, event, handler) => {\n    element.removeEventListener(event, handler);\n};\n\n$.bind = (element, event, callback) => {\n    event.split(/\\s+/).forEach(function (event) {\n        element.addEventListener(event, callback);\n    });\n};\n\n$.delegate = (element, event, selector, callback) => {\n    element.addEventListener(event, function (e) {\n        const delegatedTarget = e.target.closest(selector);\n        if (delegatedTarget) {\n            e.delegatedTarget = delegatedTarget;\n            callback.call(this, e, delegatedTarget);\n        }\n    });\n};\n\n$.unbind = (element, o) => {\n    if (element) {\n        for (let event in o) {\n            let callback = o[event];\n\n            event.split(/\\s+/).forEach(function (event) {\n                element.removeEventListener(event, callback);\n            });\n        }\n    }\n};\n\n$.fire = (target, type, properties) => {\n    let evt = document.createEvent('HTMLEvents');\n\n    evt.initEvent(type, true, true);\n\n    for (let j in properties) {\n        evt[j] = properties[j];\n    }\n\n    return target.dispatchEvent(evt);\n};\n\n$.data = (element, attrs) => { // eslint-disable-line\n    if (!attrs) {\n        return element.dataset;\n    }\n\n    for (const attr in attrs) {\n        element.dataset[attr] = attrs[attr];\n    }\n};\n\n$.style = (elements, styleMap) => { // eslint-disable-line\n\n    if (typeof styleMap === 'string') {\n        return $.getStyle(elements, styleMap);\n    }\n\n    if (!Array.isArray(elements)) {\n        elements = [elements];\n    }\n\n    elements.map(element => {\n        for (const prop in styleMap) {\n            element.style[prop] = styleMap[prop];\n        }\n    });\n};\n\n$.removeStyle = (elements, styleProps) => {\n    if (!Array.isArray(elements)) {\n        elements = [elements];\n    }\n\n    if (!Array.isArray(styleProps)) {\n        styleProps = [styleProps];\n    }\n\n    elements.map(element => {\n        for (const prop of styleProps) {\n            element.style[prop] = '';\n        }\n    });\n};\n\n$.getStyle = (element, prop) => {\n    if (!prop) {\n        return getComputedStyle(element);\n    }\n\n    let val = getComputedStyle(element)[prop];\n\n    if (['width', 'height'].includes(prop)) {\n        val = parseFloat(val);\n    }\n\n    return val;\n};\n\n$.closest = (selector, element) => {\n    if (!element) return null;\n\n    if (element.matches(selector)) {\n        return element;\n    }\n\n    return $.closest(selector, element.parentNode);\n};\n\n$.inViewport = (el, parentEl) => {\n    const {\n        top,\n        left,\n        bottom,\n        right\n    } = el.getBoundingClientRect();\n    const {\n        top: pTop,\n        left: pLeft,\n        bottom: pBottom,\n        right: pRight\n    } = parentEl.getBoundingClientRect();\n\n    return top >= pTop && left >= pLeft && bottom <= pBottom && right <= pRight;\n};\n\n$.scrollTop = function scrollTop(element, pixels) {\n    requestAnimationFrame(() => {\n        element.scrollTop = pixels;\n    });\n};\n\n$.scrollbarSize = function scrollbarSize() {\n    if (!$.scrollBarSizeValue) {\n        $.scrollBarSizeValue = getScrollBarSize();\n    }\n    return $.scrollBarSizeValue;\n};\n\nfunction getScrollBarSize() {\n    // assume scrollbar width and height would be the same\n\n    // Create the measurement node\n    const scrollDiv = document.createElement('div');\n    $.style(scrollDiv, {\n        width: '100px',\n        height: '100px',\n        overflow: 'scroll',\n        position: 'absolute',\n        top: '-9999px'\n    });\n    document.body.appendChild(scrollDiv);\n\n    // Get the scrollbar width\n    const scrollbarWidth = scrollDiv.offsetWidth - scrollDiv.clientWidth;\n\n    // Delete the DIV\n    document.body.removeChild(scrollDiv);\n\n    return scrollbarWidth;\n}\n\n$.hasVerticalOverflow = function (element) {\n    return element.scrollHeight > element.offsetHeight + 10;\n};\n\n$.hasHorizontalOverflow = function (element) {\n    return element.scrollWidth > element.offsetWidth + 10;\n};\n\n$.measureTextWidth = function (text) {\n    const div = document.createElement('div');\n    div.style.position = 'absolute';\n    div.style.visibility = 'hidden';\n    div.style.height = 'auto';\n    div.style.width = 'auto';\n    div.style.whiteSpace = 'nowrap';\n    div.innerText = text;\n    document.body.appendChild(div);\n    return div.clientWidth + 1;\n};\n\n/**\n * Checks if `value` is the\n * [language type](http://www.ecma-international.org/ecma-262/7.0/#sec-ecmascript-language-types)\n * of `Object`. (e.g. arrays, functions, objects, regexes, `new Number(0)`, and `new String('')`)\n *\n * @static\n * @memberOf _\n * @since 0.1.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is an object, else `false`.\n * @example\n *\n * _.isObject({});\n * // => true\n *\n * _.isObject([1, 2, 3]);\n * // => true\n *\n * _.isObject(_.noop);\n * // => true\n *\n * _.isObject(null);\n * // => false\n */\nfunction isObject(value) {\n  var type = typeof value;\n  return value != null && (type == 'object' || type == 'function');\n}\n\nvar isObject_1 = isObject;\n\nvar commonjsGlobal = typeof window !== 'undefined' ? window : typeof global !== 'undefined' ? global : typeof self !== 'undefined' ? self : {};\n\nfunction commonjsRequire () {\n\tthrow new Error('Dynamic requires are not currently supported by rollup-plugin-commonjs');\n}\n\nfunction unwrapExports (x) {\n\treturn x && x.__esModule && Object.prototype.hasOwnProperty.call(x, 'default') ? x['default'] : x;\n}\n\nfunction createCommonjsModule(fn, module) {\n\treturn module = { exports: {} }, fn(module, module.exports), module.exports;\n}\n\n/** Detect free variable `global` from Node.js. */\nvar freeGlobal = typeof commonjsGlobal == 'object' && commonjsGlobal && commonjsGlobal.Object === Object && commonjsGlobal;\n\nvar _freeGlobal = freeGlobal;\n\n/** Detect free variable `self`. */\nvar freeSelf = typeof self == 'object' && self && self.Object === Object && self;\n\n/** Used as a reference to the global object. */\nvar root = _freeGlobal || freeSelf || Function('return this')();\n\nvar _root = root;\n\n/**\n * Gets the timestamp of the number of milliseconds that have elapsed since\n * the Unix epoch (1 January 1970 00:00:00 UTC).\n *\n * @static\n * @memberOf _\n * @since 2.4.0\n * @category Date\n * @returns {number} Returns the timestamp.\n * @example\n *\n * _.defer(function(stamp) {\n *   console.log(_.now() - stamp);\n * }, _.now());\n * // => Logs the number of milliseconds it took for the deferred invocation.\n */\nvar now = function() {\n  return _root.Date.now();\n};\n\nvar now_1 = now;\n\n/** Built-in value references. */\nvar Symbol = _root.Symbol;\n\nvar _Symbol = Symbol;\n\n/** Used for built-in method references. */\nvar objectProto = Object.prototype;\n\n/** Used to check objects for own properties. */\nvar hasOwnProperty = objectProto.hasOwnProperty;\n\n/**\n * Used to resolve the\n * [`toStringTag`](http://ecma-international.org/ecma-262/7.0/#sec-object.prototype.tostring)\n * of values.\n */\nvar nativeObjectToString = objectProto.toString;\n\n/** Built-in value references. */\nvar symToStringTag = _Symbol ? _Symbol.toStringTag : undefined;\n\n/**\n * A specialized version of `baseGetTag` which ignores `Symbol.toStringTag` values.\n *\n * @private\n * @param {*} value The value to query.\n * @returns {string} Returns the raw `toStringTag`.\n */\nfunction getRawTag(value) {\n  var isOwn = hasOwnProperty.call(value, symToStringTag),\n      tag = value[symToStringTag];\n\n  try {\n    value[symToStringTag] = undefined;\n  } catch (e) {}\n\n  var result = nativeObjectToString.call(value);\n  {\n    if (isOwn) {\n      value[symToStringTag] = tag;\n    } else {\n      delete value[symToStringTag];\n    }\n  }\n  return result;\n}\n\nvar _getRawTag = getRawTag;\n\n/** Used for built-in method references. */\nvar objectProto$1 = Object.prototype;\n\n/**\n * Used to resolve the\n * [`toStringTag`](http://ecma-international.org/ecma-262/7.0/#sec-object.prototype.tostring)\n * of values.\n */\nvar nativeObjectToString$1 = objectProto$1.toString;\n\n/**\n * Converts `value` to a string using `Object.prototype.toString`.\n *\n * @private\n * @param {*} value The value to convert.\n * @returns {string} Returns the converted string.\n */\nfunction objectToString(value) {\n  return nativeObjectToString$1.call(value);\n}\n\nvar _objectToString = objectToString;\n\n/** `Object#toString` result references. */\nvar nullTag = '[object Null]',\n    undefinedTag = '[object Undefined]';\n\n/** Built-in value references. */\nvar symToStringTag$1 = _Symbol ? _Symbol.toStringTag : undefined;\n\n/**\n * The base implementation of `getTag` without fallbacks for buggy environments.\n *\n * @private\n * @param {*} value The value to query.\n * @returns {string} Returns the `toStringTag`.\n */\nfunction baseGetTag(value) {\n  if (value == null) {\n    return value === undefined ? undefinedTag : nullTag;\n  }\n  return (symToStringTag$1 && symToStringTag$1 in Object(value))\n    ? _getRawTag(value)\n    : _objectToString(value);\n}\n\nvar _baseGetTag = baseGetTag;\n\n/**\n * Checks if `value` is object-like. A value is object-like if it's not `null`\n * and has a `typeof` result of \"object\".\n *\n * @static\n * @memberOf _\n * @since 4.0.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is object-like, else `false`.\n * @example\n *\n * _.isObjectLike({});\n * // => true\n *\n * _.isObjectLike([1, 2, 3]);\n * // => true\n *\n * _.isObjectLike(_.noop);\n * // => false\n *\n * _.isObjectLike(null);\n * // => false\n */\nfunction isObjectLike(value) {\n  return value != null && typeof value == 'object';\n}\n\nvar isObjectLike_1 = isObjectLike;\n\n/** `Object#toString` result references. */\nvar symbolTag = '[object Symbol]';\n\n/**\n * Checks if `value` is classified as a `Symbol` primitive or object.\n *\n * @static\n * @memberOf _\n * @since 4.0.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is a symbol, else `false`.\n * @example\n *\n * _.isSymbol(Symbol.iterator);\n * // => true\n *\n * _.isSymbol('abc');\n * // => false\n */\nfunction isSymbol(value) {\n  return typeof value == 'symbol' ||\n    (isObjectLike_1(value) && _baseGetTag(value) == symbolTag);\n}\n\nvar isSymbol_1 = isSymbol;\n\n/** Used as references for various `Number` constants. */\nvar NAN = 0 / 0;\n\n/** Used to match leading and trailing whitespace. */\nvar reTrim = /^\\s+|\\s+$/g;\n\n/** Used to detect bad signed hexadecimal string values. */\nvar reIsBadHex = /^[-+]0x[0-9a-f]+$/i;\n\n/** Used to detect binary string values. */\nvar reIsBinary = /^0b[01]+$/i;\n\n/** Used to detect octal string values. */\nvar reIsOctal = /^0o[0-7]+$/i;\n\n/** Built-in method references without a dependency on `root`. */\nvar freeParseInt = parseInt;\n\n/**\n * Converts `value` to a number.\n *\n * @static\n * @memberOf _\n * @since 4.0.0\n * @category Lang\n * @param {*} value The value to process.\n * @returns {number} Returns the number.\n * @example\n *\n * _.toNumber(3.2);\n * // => 3.2\n *\n * _.toNumber(Number.MIN_VALUE);\n * // => 5e-324\n *\n * _.toNumber(Infinity);\n * // => Infinity\n *\n * _.toNumber('3.2');\n * // => 3.2\n */\nfunction toNumber(value) {\n  if (typeof value == 'number') {\n    return value;\n  }\n  if (isSymbol_1(value)) {\n    return NAN;\n  }\n  if (isObject_1(value)) {\n    var other = typeof value.valueOf == 'function' ? value.valueOf() : value;\n    value = isObject_1(other) ? (other + '') : other;\n  }\n  if (typeof value != 'string') {\n    return value === 0 ? value : +value;\n  }\n  value = value.replace(reTrim, '');\n  var isBinary = reIsBinary.test(value);\n  return (isBinary || reIsOctal.test(value))\n    ? freeParseInt(value.slice(2), isBinary ? 2 : 8)\n    : (reIsBadHex.test(value) ? NAN : +value);\n}\n\nvar toNumber_1 = toNumber;\n\n/** Error message constants. */\nvar FUNC_ERROR_TEXT = 'Expected a function';\n\n/* Built-in method references for those with the same name as other `lodash` methods. */\nvar nativeMax = Math.max,\n    nativeMin = Math.min;\n\n/**\n * Creates a debounced function that delays invoking `func` until after `wait`\n * milliseconds have elapsed since the last time the debounced function was\n * invoked. The debounced function comes with a `cancel` method to cancel\n * delayed `func` invocations and a `flush` method to immediately invoke them.\n * Provide `options` to indicate whether `func` should be invoked on the\n * leading and/or trailing edge of the `wait` timeout. The `func` is invoked\n * with the last arguments provided to the debounced function. Subsequent\n * calls to the debounced function return the result of the last `func`\n * invocation.\n *\n * **Note:** If `leading` and `trailing` options are `true`, `func` is\n * invoked on the trailing edge of the timeout only if the debounced function\n * is invoked more than once during the `wait` timeout.\n *\n * If `wait` is `0` and `leading` is `false`, `func` invocation is deferred\n * until to the next tick, similar to `setTimeout` with a timeout of `0`.\n *\n * See [David Corbacho's article](https://css-tricks.com/debouncing-throttling-explained-examples/)\n * for details over the differences between `_.debounce` and `_.throttle`.\n *\n * @static\n * @memberOf _\n * @since 0.1.0\n * @category Function\n * @param {Function} func The function to debounce.\n * @param {number} [wait=0] The number of milliseconds to delay.\n * @param {Object} [options={}] The options object.\n * @param {boolean} [options.leading=false]\n *  Specify invoking on the leading edge of the timeout.\n * @param {number} [options.maxWait]\n *  The maximum time `func` is allowed to be delayed before it's invoked.\n * @param {boolean} [options.trailing=true]\n *  Specify invoking on the trailing edge of the timeout.\n * @returns {Function} Returns the new debounced function.\n * @example\n *\n * // Avoid costly calculations while the window size is in flux.\n * jQuery(window).on('resize', _.debounce(calculateLayout, 150));\n *\n * // Invoke `sendMail` when clicked, debouncing subsequent calls.\n * jQuery(element).on('click', _.debounce(sendMail, 300, {\n *   'leading': true,\n *   'trailing': false\n * }));\n *\n * // Ensure `batchLog` is invoked once after 1 second of debounced calls.\n * var debounced = _.debounce(batchLog, 250, { 'maxWait': 1000 });\n * var source = new EventSource('/stream');\n * jQuery(source).on('message', debounced);\n *\n * // Cancel the trailing debounced invocation.\n * jQuery(window).on('popstate', debounced.cancel);\n */\nfunction debounce(func, wait, options) {\n  var lastArgs,\n      lastThis,\n      maxWait,\n      result,\n      timerId,\n      lastCallTime,\n      lastInvokeTime = 0,\n      leading = false,\n      maxing = false,\n      trailing = true;\n\n  if (typeof func != 'function') {\n    throw new TypeError(FUNC_ERROR_TEXT);\n  }\n  wait = toNumber_1(wait) || 0;\n  if (isObject_1(options)) {\n    leading = !!options.leading;\n    maxing = 'maxWait' in options;\n    maxWait = maxing ? nativeMax(toNumber_1(options.maxWait) || 0, wait) : maxWait;\n    trailing = 'trailing' in options ? !!options.trailing : trailing;\n  }\n\n  function invokeFunc(time) {\n    var args = lastArgs,\n        thisArg = lastThis;\n\n    lastArgs = lastThis = undefined;\n    lastInvokeTime = time;\n    result = func.apply(thisArg, args);\n    return result;\n  }\n\n  function leadingEdge(time) {\n    // Reset any `maxWait` timer.\n    lastInvokeTime = time;\n    // Start the timer for the trailing edge.\n    timerId = setTimeout(timerExpired, wait);\n    // Invoke the leading edge.\n    return leading ? invokeFunc(time) : result;\n  }\n\n  function remainingWait(time) {\n    var timeSinceLastCall = time - lastCallTime,\n        timeSinceLastInvoke = time - lastInvokeTime,\n        timeWaiting = wait - timeSinceLastCall;\n\n    return maxing\n      ? nativeMin(timeWaiting, maxWait - timeSinceLastInvoke)\n      : timeWaiting;\n  }\n\n  function shouldInvoke(time) {\n    var timeSinceLastCall = time - lastCallTime,\n        timeSinceLastInvoke = time - lastInvokeTime;\n\n    // Either this is the first call, activity has stopped and we're at the\n    // trailing edge, the system time has gone backwards and we're treating\n    // it as the trailing edge, or we've hit the `maxWait` limit.\n    return (lastCallTime === undefined || (timeSinceLastCall >= wait) ||\n      (timeSinceLastCall < 0) || (maxing && timeSinceLastInvoke >= maxWait));\n  }\n\n  function timerExpired() {\n    var time = now_1();\n    if (shouldInvoke(time)) {\n      return trailingEdge(time);\n    }\n    // Restart the timer.\n    timerId = setTimeout(timerExpired, remainingWait(time));\n  }\n\n  function trailingEdge(time) {\n    timerId = undefined;\n\n    // Only invoke if we have `lastArgs` which means `func` has been\n    // debounced at least once.\n    if (trailing && lastArgs) {\n      return invokeFunc(time);\n    }\n    lastArgs = lastThis = undefined;\n    return result;\n  }\n\n  function cancel() {\n    if (timerId !== undefined) {\n      clearTimeout(timerId);\n    }\n    lastInvokeTime = 0;\n    lastArgs = lastCallTime = lastThis = timerId = undefined;\n  }\n\n  function flush() {\n    return timerId === undefined ? result : trailingEdge(now_1());\n  }\n\n  function debounced() {\n    var time = now_1(),\n        isInvoking = shouldInvoke(time);\n\n    lastArgs = arguments;\n    lastThis = this;\n    lastCallTime = time;\n\n    if (isInvoking) {\n      if (timerId === undefined) {\n        return leadingEdge(lastCallTime);\n      }\n      if (maxing) {\n        // Handle invocations in a tight loop.\n        timerId = setTimeout(timerExpired, wait);\n        return invokeFunc(lastCallTime);\n      }\n    }\n    if (timerId === undefined) {\n      timerId = setTimeout(timerExpired, wait);\n    }\n    return result;\n  }\n  debounced.cancel = cancel;\n  debounced.flush = flush;\n  return debounced;\n}\n\nvar debounce_1 = debounce;\n\n/** Error message constants. */\nvar FUNC_ERROR_TEXT$1 = 'Expected a function';\n\n/**\n * Creates a throttled function that only invokes `func` at most once per\n * every `wait` milliseconds. The throttled function comes with a `cancel`\n * method to cancel delayed `func` invocations and a `flush` method to\n * immediately invoke them. Provide `options` to indicate whether `func`\n * should be invoked on the leading and/or trailing edge of the `wait`\n * timeout. The `func` is invoked with the last arguments provided to the\n * throttled function. Subsequent calls to the throttled function return the\n * result of the last `func` invocation.\n *\n * **Note:** If `leading` and `trailing` options are `true`, `func` is\n * invoked on the trailing edge of the timeout only if the throttled function\n * is invoked more than once during the `wait` timeout.\n *\n * If `wait` is `0` and `leading` is `false`, `func` invocation is deferred\n * until to the next tick, similar to `setTimeout` with a timeout of `0`.\n *\n * See [David Corbacho's article](https://css-tricks.com/debouncing-throttling-explained-examples/)\n * for details over the differences between `_.throttle` and `_.debounce`.\n *\n * @static\n * @memberOf _\n * @since 0.1.0\n * @category Function\n * @param {Function} func The function to throttle.\n * @param {number} [wait=0] The number of milliseconds to throttle invocations to.\n * @param {Object} [options={}] The options object.\n * @param {boolean} [options.leading=true]\n *  Specify invoking on the leading edge of the timeout.\n * @param {boolean} [options.trailing=true]\n *  Specify invoking on the trailing edge of the timeout.\n * @returns {Function} Returns the new throttled function.\n * @example\n *\n * // Avoid excessively updating the position while scrolling.\n * jQuery(window).on('scroll', _.throttle(updatePosition, 100));\n *\n * // Invoke `renewToken` when the click event is fired, but not more than once every 5 minutes.\n * var throttled = _.throttle(renewToken, 300000, { 'trailing': false });\n * jQuery(element).on('click', throttled);\n *\n * // Cancel the trailing throttled invocation.\n * jQuery(window).on('popstate', throttled.cancel);\n */\nfunction throttle(func, wait, options) {\n  var leading = true,\n      trailing = true;\n\n  if (typeof func != 'function') {\n    throw new TypeError(FUNC_ERROR_TEXT$1);\n  }\n  if (isObject_1(options)) {\n    leading = 'leading' in options ? !!options.leading : leading;\n    trailing = 'trailing' in options ? !!options.trailing : trailing;\n  }\n  return debounce_1(func, wait, {\n    'leading': leading,\n    'maxWait': wait,\n    'trailing': trailing\n  });\n}\n\nvar throttle_1 = throttle;\n\n/** `Object#toString` result references. */\nvar asyncTag = '[object AsyncFunction]',\n    funcTag = '[object Function]',\n    genTag = '[object GeneratorFunction]',\n    proxyTag = '[object Proxy]';\n\n/**\n * Checks if `value` is classified as a `Function` object.\n *\n * @static\n * @memberOf _\n * @since 0.1.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is a function, else `false`.\n * @example\n *\n * _.isFunction(_);\n * // => true\n *\n * _.isFunction(/abc/);\n * // => false\n */\nfunction isFunction(value) {\n  if (!isObject_1(value)) {\n    return false;\n  }\n  // The use of `Object#toString` avoids issues with the `typeof` operator\n  // in Safari 9 which returns 'object' for typed arrays and other constructors.\n  var tag = _baseGetTag(value);\n  return tag == funcTag || tag == genTag || tag == asyncTag || tag == proxyTag;\n}\n\nvar isFunction_1 = isFunction;\n\n/** Used to detect overreaching core-js shims. */\nvar coreJsData = _root['__core-js_shared__'];\n\nvar _coreJsData = coreJsData;\n\n/** Used to detect methods masquerading as native. */\nvar maskSrcKey = (function() {\n  var uid = /[^.]+$/.exec(_coreJsData && _coreJsData.keys && _coreJsData.keys.IE_PROTO || '');\n  return uid ? ('Symbol(src)_1.' + uid) : '';\n}());\n\n/**\n * Checks if `func` has its source masked.\n *\n * @private\n * @param {Function} func The function to check.\n * @returns {boolean} Returns `true` if `func` is masked, else `false`.\n */\nfunction isMasked(func) {\n  return !!maskSrcKey && (maskSrcKey in func);\n}\n\nvar _isMasked = isMasked;\n\n/** Used for built-in method references. */\nvar funcProto = Function.prototype;\n\n/** Used to resolve the decompiled source of functions. */\nvar funcToString = funcProto.toString;\n\n/**\n * Converts `func` to its source code.\n *\n * @private\n * @param {Function} func The function to convert.\n * @returns {string} Returns the source code.\n */\nfunction toSource(func) {\n  if (func != null) {\n    try {\n      return funcToString.call(func);\n    } catch (e) {}\n    try {\n      return (func + '');\n    } catch (e) {}\n  }\n  return '';\n}\n\nvar _toSource = toSource;\n\n/**\n * Used to match `RegExp`\n * [syntax characters](http://ecma-international.org/ecma-262/7.0/#sec-patterns).\n */\nvar reRegExpChar = /[\\\\^$.*+?()[\\]{}|]/g;\n\n/** Used to detect host constructors (Safari). */\nvar reIsHostCtor = /^\\[object .+?Constructor\\]$/;\n\n/** Used for built-in method references. */\nvar funcProto$1 = Function.prototype,\n    objectProto$2 = Object.prototype;\n\n/** Used to resolve the decompiled source of functions. */\nvar funcToString$1 = funcProto$1.toString;\n\n/** Used to check objects for own properties. */\nvar hasOwnProperty$1 = objectProto$2.hasOwnProperty;\n\n/** Used to detect if a method is native. */\nvar reIsNative = RegExp('^' +\n  funcToString$1.call(hasOwnProperty$1).replace(reRegExpChar, '\\\\$&')\n  .replace(/hasOwnProperty|(function).*?(?=\\\\\\()| for .+?(?=\\\\\\])/g, '$1.*?') + '$'\n);\n\n/**\n * The base implementation of `_.isNative` without bad shim checks.\n *\n * @private\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is a native function,\n *  else `false`.\n */\nfunction baseIsNative(value) {\n  if (!isObject_1(value) || _isMasked(value)) {\n    return false;\n  }\n  var pattern = isFunction_1(value) ? reIsNative : reIsHostCtor;\n  return pattern.test(_toSource(value));\n}\n\nvar _baseIsNative = baseIsNative;\n\n/**\n * Gets the value at `key` of `object`.\n *\n * @private\n * @param {Object} [object] The object to query.\n * @param {string} key The key of the property to get.\n * @returns {*} Returns the property value.\n */\nfunction getValue(object, key) {\n  return object == null ? undefined : object[key];\n}\n\nvar _getValue = getValue;\n\n/**\n * Gets the native function at `key` of `object`.\n *\n * @private\n * @param {Object} object The object to query.\n * @param {string} key The key of the method to get.\n * @returns {*} Returns the function if it's native, else `undefined`.\n */\nfunction getNative(object, key) {\n  var value = _getValue(object, key);\n  return _baseIsNative(value) ? value : undefined;\n}\n\nvar _getNative = getNative;\n\n/* Built-in method references that are verified to be native. */\nvar nativeCreate = _getNative(Object, 'create');\n\nvar _nativeCreate = nativeCreate;\n\n/**\n * Removes all key-value entries from the hash.\n *\n * @private\n * @name clear\n * @memberOf Hash\n */\nfunction hashClear() {\n  this.__data__ = _nativeCreate ? _nativeCreate(null) : {};\n  this.size = 0;\n}\n\nvar _hashClear = hashClear;\n\n/**\n * Removes `key` and its value from the hash.\n *\n * @private\n * @name delete\n * @memberOf Hash\n * @param {Object} hash The hash to modify.\n * @param {string} key The key of the value to remove.\n * @returns {boolean} Returns `true` if the entry was removed, else `false`.\n */\nfunction hashDelete(key) {\n  var result = this.has(key) && delete this.__data__[key];\n  this.size -= result ? 1 : 0;\n  return result;\n}\n\nvar _hashDelete = hashDelete;\n\n/** Used to stand-in for `undefined` hash values. */\nvar HASH_UNDEFINED = '__lodash_hash_undefined__';\n\n/** Used for built-in method references. */\nvar objectProto$3 = Object.prototype;\n\n/** Used to check objects for own properties. */\nvar hasOwnProperty$2 = objectProto$3.hasOwnProperty;\n\n/**\n * Gets the hash value for `key`.\n *\n * @private\n * @name get\n * @memberOf Hash\n * @param {string} key The key of the value to get.\n * @returns {*} Returns the entry value.\n */\nfunction hashGet(key) {\n  var data = this.__data__;\n  if (_nativeCreate) {\n    var result = data[key];\n    return result === HASH_UNDEFINED ? undefined : result;\n  }\n  return hasOwnProperty$2.call(data, key) ? data[key] : undefined;\n}\n\nvar _hashGet = hashGet;\n\n/** Used for built-in method references. */\nvar objectProto$4 = Object.prototype;\n\n/** Used to check objects for own properties. */\nvar hasOwnProperty$3 = objectProto$4.hasOwnProperty;\n\n/**\n * Checks if a hash value for `key` exists.\n *\n * @private\n * @name has\n * @memberOf Hash\n * @param {string} key The key of the entry to check.\n * @returns {boolean} Returns `true` if an entry for `key` exists, else `false`.\n */\nfunction hashHas(key) {\n  var data = this.__data__;\n  return _nativeCreate ? (data[key] !== undefined) : hasOwnProperty$3.call(data, key);\n}\n\nvar _hashHas = hashHas;\n\n/** Used to stand-in for `undefined` hash values. */\nvar HASH_UNDEFINED$1 = '__lodash_hash_undefined__';\n\n/**\n * Sets the hash `key` to `value`.\n *\n * @private\n * @name set\n * @memberOf Hash\n * @param {string} key The key of the value to set.\n * @param {*} value The value to set.\n * @returns {Object} Returns the hash instance.\n */\nfunction hashSet(key, value) {\n  var data = this.__data__;\n  this.size += this.has(key) ? 0 : 1;\n  data[key] = (_nativeCreate && value === undefined) ? HASH_UNDEFINED$1 : value;\n  return this;\n}\n\nvar _hashSet = hashSet;\n\n/**\n * Creates a hash object.\n *\n * @private\n * @constructor\n * @param {Array} [entries] The key-value pairs to cache.\n */\nfunction Hash(entries) {\n  var index = -1,\n      length = entries == null ? 0 : entries.length;\n\n  this.clear();\n  while (++index < length) {\n    var entry = entries[index];\n    this.set(entry[0], entry[1]);\n  }\n}\n\n// Add methods to `Hash`.\nHash.prototype.clear = _hashClear;\nHash.prototype['delete'] = _hashDelete;\nHash.prototype.get = _hashGet;\nHash.prototype.has = _hashHas;\nHash.prototype.set = _hashSet;\n\nvar _Hash = Hash;\n\n/**\n * Removes all key-value entries from the list cache.\n *\n * @private\n * @name clear\n * @memberOf ListCache\n */\nfunction listCacheClear() {\n  this.__data__ = [];\n  this.size = 0;\n}\n\nvar _listCacheClear = listCacheClear;\n\n/**\n * Performs a\n * [`SameValueZero`](http://ecma-international.org/ecma-262/7.0/#sec-samevaluezero)\n * comparison between two values to determine if they are equivalent.\n *\n * @static\n * @memberOf _\n * @since 4.0.0\n * @category Lang\n * @param {*} value The value to compare.\n * @param {*} other The other value to compare.\n * @returns {boolean} Returns `true` if the values are equivalent, else `false`.\n * @example\n *\n * var object = { 'a': 1 };\n * var other = { 'a': 1 };\n *\n * _.eq(object, object);\n * // => true\n *\n * _.eq(object, other);\n * // => false\n *\n * _.eq('a', 'a');\n * // => true\n *\n * _.eq('a', Object('a'));\n * // => false\n *\n * _.eq(NaN, NaN);\n * // => true\n */\nfunction eq(value, other) {\n  return value === other || (value !== value && other !== other);\n}\n\nvar eq_1 = eq;\n\n/**\n * Gets the index at which the `key` is found in `array` of key-value pairs.\n *\n * @private\n * @param {Array} array The array to inspect.\n * @param {*} key The key to search for.\n * @returns {number} Returns the index of the matched value, else `-1`.\n */\nfunction assocIndexOf(array, key) {\n  var length = array.length;\n  while (length--) {\n    if (eq_1(array[length][0], key)) {\n      return length;\n    }\n  }\n  return -1;\n}\n\nvar _assocIndexOf = assocIndexOf;\n\n/** Used for built-in method references. */\nvar arrayProto = Array.prototype;\n\n/** Built-in value references. */\nvar splice = arrayProto.splice;\n\n/**\n * Removes `key` and its value from the list cache.\n *\n * @private\n * @name delete\n * @memberOf ListCache\n * @param {string} key The key of the value to remove.\n * @returns {boolean} Returns `true` if the entry was removed, else `false`.\n */\nfunction listCacheDelete(key) {\n  var data = this.__data__,\n      index = _assocIndexOf(data, key);\n\n  if (index < 0) {\n    return false;\n  }\n  var lastIndex = data.length - 1;\n  if (index == lastIndex) {\n    data.pop();\n  } else {\n    splice.call(data, index, 1);\n  }\n  --this.size;\n  return true;\n}\n\nvar _listCacheDelete = listCacheDelete;\n\n/**\n * Gets the list cache value for `key`.\n *\n * @private\n * @name get\n * @memberOf ListCache\n * @param {string} key The key of the value to get.\n * @returns {*} Returns the entry value.\n */\nfunction listCacheGet(key) {\n  var data = this.__data__,\n      index = _assocIndexOf(data, key);\n\n  return index < 0 ? undefined : data[index][1];\n}\n\nvar _listCacheGet = listCacheGet;\n\n/**\n * Checks if a list cache value for `key` exists.\n *\n * @private\n * @name has\n * @memberOf ListCache\n * @param {string} key The key of the entry to check.\n * @returns {boolean} Returns `true` if an entry for `key` exists, else `false`.\n */\nfunction listCacheHas(key) {\n  return _assocIndexOf(this.__data__, key) > -1;\n}\n\nvar _listCacheHas = listCacheHas;\n\n/**\n * Sets the list cache `key` to `value`.\n *\n * @private\n * @name set\n * @memberOf ListCache\n * @param {string} key The key of the value to set.\n * @param {*} value The value to set.\n * @returns {Object} Returns the list cache instance.\n */\nfunction listCacheSet(key, value) {\n  var data = this.__data__,\n      index = _assocIndexOf(data, key);\n\n  if (index < 0) {\n    ++this.size;\n    data.push([key, value]);\n  } else {\n    data[index][1] = value;\n  }\n  return this;\n}\n\nvar _listCacheSet = listCacheSet;\n\n/**\n * Creates an list cache object.\n *\n * @private\n * @constructor\n * @param {Array} [entries] The key-value pairs to cache.\n */\nfunction ListCache(entries) {\n  var index = -1,\n      length = entries == null ? 0 : entries.length;\n\n  this.clear();\n  while (++index < length) {\n    var entry = entries[index];\n    this.set(entry[0], entry[1]);\n  }\n}\n\n// Add methods to `ListCache`.\nListCache.prototype.clear = _listCacheClear;\nListCache.prototype['delete'] = _listCacheDelete;\nListCache.prototype.get = _listCacheGet;\nListCache.prototype.has = _listCacheHas;\nListCache.prototype.set = _listCacheSet;\n\nvar _ListCache = ListCache;\n\n/* Built-in method references that are verified to be native. */\nvar Map = _getNative(_root, 'Map');\n\nvar _Map = Map;\n\n/**\n * Removes all key-value entries from the map.\n *\n * @private\n * @name clear\n * @memberOf MapCache\n */\nfunction mapCacheClear() {\n  this.size = 0;\n  this.__data__ = {\n    'hash': new _Hash,\n    'map': new (_Map || _ListCache),\n    'string': new _Hash\n  };\n}\n\nvar _mapCacheClear = mapCacheClear;\n\n/**\n * Checks if `value` is suitable for use as unique object key.\n *\n * @private\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is suitable, else `false`.\n */\nfunction isKeyable(value) {\n  var type = typeof value;\n  return (type == 'string' || type == 'number' || type == 'symbol' || type == 'boolean')\n    ? (value !== '__proto__')\n    : (value === null);\n}\n\nvar _isKeyable = isKeyable;\n\n/**\n * Gets the data for `map`.\n *\n * @private\n * @param {Object} map The map to query.\n * @param {string} key The reference key.\n * @returns {*} Returns the map data.\n */\nfunction getMapData(map, key) {\n  var data = map.__data__;\n  return _isKeyable(key)\n    ? data[typeof key == 'string' ? 'string' : 'hash']\n    : data.map;\n}\n\nvar _getMapData = getMapData;\n\n/**\n * Removes `key` and its value from the map.\n *\n * @private\n * @name delete\n * @memberOf MapCache\n * @param {string} key The key of the value to remove.\n * @returns {boolean} Returns `true` if the entry was removed, else `false`.\n */\nfunction mapCacheDelete(key) {\n  var result = _getMapData(this, key)['delete'](key);\n  this.size -= result ? 1 : 0;\n  return result;\n}\n\nvar _mapCacheDelete = mapCacheDelete;\n\n/**\n * Gets the map value for `key`.\n *\n * @private\n * @name get\n * @memberOf MapCache\n * @param {string} key The key of the value to get.\n * @returns {*} Returns the entry value.\n */\nfunction mapCacheGet(key) {\n  return _getMapData(this, key).get(key);\n}\n\nvar _mapCacheGet = mapCacheGet;\n\n/**\n * Checks if a map value for `key` exists.\n *\n * @private\n * @name has\n * @memberOf MapCache\n * @param {string} key The key of the entry to check.\n * @returns {boolean} Returns `true` if an entry for `key` exists, else `false`.\n */\nfunction mapCacheHas(key) {\n  return _getMapData(this, key).has(key);\n}\n\nvar _mapCacheHas = mapCacheHas;\n\n/**\n * Sets the map `key` to `value`.\n *\n * @private\n * @name set\n * @memberOf MapCache\n * @param {string} key The key of the value to set.\n * @param {*} value The value to set.\n * @returns {Object} Returns the map cache instance.\n */\nfunction mapCacheSet(key, value) {\n  var data = _getMapData(this, key),\n      size = data.size;\n\n  data.set(key, value);\n  this.size += data.size == size ? 0 : 1;\n  return this;\n}\n\nvar _mapCacheSet = mapCacheSet;\n\n/**\n * Creates a map cache object to store key-value pairs.\n *\n * @private\n * @constructor\n * @param {Array} [entries] The key-value pairs to cache.\n */\nfunction MapCache(entries) {\n  var index = -1,\n      length = entries == null ? 0 : entries.length;\n\n  this.clear();\n  while (++index < length) {\n    var entry = entries[index];\n    this.set(entry[0], entry[1]);\n  }\n}\n\n// Add methods to `MapCache`.\nMapCache.prototype.clear = _mapCacheClear;\nMapCache.prototype['delete'] = _mapCacheDelete;\nMapCache.prototype.get = _mapCacheGet;\nMapCache.prototype.has = _mapCacheHas;\nMapCache.prototype.set = _mapCacheSet;\n\nvar _MapCache = MapCache;\n\n/** Used to stand-in for `undefined` hash values. */\nvar HASH_UNDEFINED$2 = '__lodash_hash_undefined__';\n\n/**\n * Adds `value` to the array cache.\n *\n * @private\n * @name add\n * @memberOf SetCache\n * @alias push\n * @param {*} value The value to cache.\n * @returns {Object} Returns the cache instance.\n */\nfunction setCacheAdd(value) {\n  this.__data__.set(value, HASH_UNDEFINED$2);\n  return this;\n}\n\nvar _setCacheAdd = setCacheAdd;\n\n/**\n * Checks if `value` is in the array cache.\n *\n * @private\n * @name has\n * @memberOf SetCache\n * @param {*} value The value to search for.\n * @returns {number} Returns `true` if `value` is found, else `false`.\n */\nfunction setCacheHas(value) {\n  return this.__data__.has(value);\n}\n\nvar _setCacheHas = setCacheHas;\n\n/**\n *\n * Creates an array cache object to store unique values.\n *\n * @private\n * @constructor\n * @param {Array} [values] The values to cache.\n */\nfunction SetCache(values) {\n  var index = -1,\n      length = values == null ? 0 : values.length;\n\n  this.__data__ = new _MapCache;\n  while (++index < length) {\n    this.add(values[index]);\n  }\n}\n\n// Add methods to `SetCache`.\nSetCache.prototype.add = SetCache.prototype.push = _setCacheAdd;\nSetCache.prototype.has = _setCacheHas;\n\nvar _SetCache = SetCache;\n\n/**\n * The base implementation of `_.findIndex` and `_.findLastIndex` without\n * support for iteratee shorthands.\n *\n * @private\n * @param {Array} array The array to inspect.\n * @param {Function} predicate The function invoked per iteration.\n * @param {number} fromIndex The index to search from.\n * @param {boolean} [fromRight] Specify iterating from right to left.\n * @returns {number} Returns the index of the matched value, else `-1`.\n */\nfunction baseFindIndex(array, predicate, fromIndex, fromRight) {\n  var length = array.length,\n      index = fromIndex + (fromRight ? 1 : -1);\n\n  while ((fromRight ? index-- : ++index < length)) {\n    if (predicate(array[index], index, array)) {\n      return index;\n    }\n  }\n  return -1;\n}\n\nvar _baseFindIndex = baseFindIndex;\n\n/**\n * The base implementation of `_.isNaN` without support for number objects.\n *\n * @private\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is `NaN`, else `false`.\n */\nfunction baseIsNaN(value) {\n  return value !== value;\n}\n\nvar _baseIsNaN = baseIsNaN;\n\n/**\n * A specialized version of `_.indexOf` which performs strict equality\n * comparisons of values, i.e. `===`.\n *\n * @private\n * @param {Array} array The array to inspect.\n * @param {*} value The value to search for.\n * @param {number} fromIndex The index to search from.\n * @returns {number} Returns the index of the matched value, else `-1`.\n */\nfunction strictIndexOf(array, value, fromIndex) {\n  var index = fromIndex - 1,\n      length = array.length;\n\n  while (++index < length) {\n    if (array[index] === value) {\n      return index;\n    }\n  }\n  return -1;\n}\n\nvar _strictIndexOf = strictIndexOf;\n\n/**\n * The base implementation of `_.indexOf` without `fromIndex` bounds checks.\n *\n * @private\n * @param {Array} array The array to inspect.\n * @param {*} value The value to search for.\n * @param {number} fromIndex The index to search from.\n * @returns {number} Returns the index of the matched value, else `-1`.\n */\nfunction baseIndexOf(array, value, fromIndex) {\n  return value === value\n    ? _strictIndexOf(array, value, fromIndex)\n    : _baseFindIndex(array, _baseIsNaN, fromIndex);\n}\n\nvar _baseIndexOf = baseIndexOf;\n\n/**\n * A specialized version of `_.includes` for arrays without support for\n * specifying an index to search from.\n *\n * @private\n * @param {Array} [array] The array to inspect.\n * @param {*} target The value to search for.\n * @returns {boolean} Returns `true` if `target` is found, else `false`.\n */\nfunction arrayIncludes(array, value) {\n  var length = array == null ? 0 : array.length;\n  return !!length && _baseIndexOf(array, value, 0) > -1;\n}\n\nvar _arrayIncludes = arrayIncludes;\n\n/**\n * This function is like `arrayIncludes` except that it accepts a comparator.\n *\n * @private\n * @param {Array} [array] The array to inspect.\n * @param {*} target The value to search for.\n * @param {Function} comparator The comparator invoked per element.\n * @returns {boolean} Returns `true` if `target` is found, else `false`.\n */\nfunction arrayIncludesWith(array, value, comparator) {\n  var index = -1,\n      length = array == null ? 0 : array.length;\n\n  while (++index < length) {\n    if (comparator(value, array[index])) {\n      return true;\n    }\n  }\n  return false;\n}\n\nvar _arrayIncludesWith = arrayIncludesWith;\n\n/**\n * Checks if a `cache` value for `key` exists.\n *\n * @private\n * @param {Object} cache The cache to query.\n * @param {string} key The key of the entry to check.\n * @returns {boolean} Returns `true` if an entry for `key` exists, else `false`.\n */\nfunction cacheHas(cache, key) {\n  return cache.has(key);\n}\n\nvar _cacheHas = cacheHas;\n\n/* Built-in method references that are verified to be native. */\nvar Set = _getNative(_root, 'Set');\n\nvar _Set = Set;\n\n/**\n * This method returns `undefined`.\n *\n * @static\n * @memberOf _\n * @since 2.3.0\n * @category Util\n * @example\n *\n * _.times(2, _.noop);\n * // => [undefined, undefined]\n */\nfunction noop() {\n  // No operation performed.\n}\n\nvar noop_1 = noop;\n\n/**\n * Converts `set` to an array of its values.\n *\n * @private\n * @param {Object} set The set to convert.\n * @returns {Array} Returns the values.\n */\nfunction setToArray(set) {\n  var index = -1,\n      result = Array(set.size);\n\n  set.forEach(function(value) {\n    result[++index] = value;\n  });\n  return result;\n}\n\nvar _setToArray = setToArray;\n\n/** Used as references for various `Number` constants. */\nvar INFINITY = 1 / 0;\n\n/**\n * Creates a set object of `values`.\n *\n * @private\n * @param {Array} values The values to add to the set.\n * @returns {Object} Returns the new set.\n */\nvar createSet = !(_Set && (1 / _setToArray(new _Set([,-0]))[1]) == INFINITY) ? noop_1 : function(values) {\n  return new _Set(values);\n};\n\nvar _createSet = createSet;\n\n/** Used as the size to enable large array optimizations. */\nvar LARGE_ARRAY_SIZE = 200;\n\n/**\n * The base implementation of `_.uniqBy` without support for iteratee shorthands.\n *\n * @private\n * @param {Array} array The array to inspect.\n * @param {Function} [iteratee] The iteratee invoked per element.\n * @param {Function} [comparator] The comparator invoked per element.\n * @returns {Array} Returns the new duplicate free array.\n */\nfunction baseUniq(array, iteratee, comparator) {\n  var index = -1,\n      includes = _arrayIncludes,\n      length = array.length,\n      isCommon = true,\n      result = [],\n      seen = result;\n\n  if (comparator) {\n    isCommon = false;\n    includes = _arrayIncludesWith;\n  }\n  else if (length >= LARGE_ARRAY_SIZE) {\n    var set = iteratee ? null : _createSet(array);\n    if (set) {\n      return _setToArray(set);\n    }\n    isCommon = false;\n    includes = _cacheHas;\n    seen = new _SetCache;\n  }\n  else {\n    seen = iteratee ? [] : result;\n  }\n  outer:\n  while (++index < length) {\n    var value = array[index],\n        computed = iteratee ? iteratee(value) : value;\n\n    value = (comparator || value !== 0) ? value : 0;\n    if (isCommon && computed === computed) {\n      var seenIndex = seen.length;\n      while (seenIndex--) {\n        if (seen[seenIndex] === computed) {\n          continue outer;\n        }\n      }\n      if (iteratee) {\n        seen.push(computed);\n      }\n      result.push(value);\n    }\n    else if (!includes(seen, computed, comparator)) {\n      if (seen !== result) {\n        seen.push(computed);\n      }\n      result.push(value);\n    }\n  }\n  return result;\n}\n\nvar _baseUniq = baseUniq;\n\n/**\n * Creates a duplicate-free version of an array, using\n * [`SameValueZero`](http://ecma-international.org/ecma-262/7.0/#sec-samevaluezero)\n * for equality comparisons, in which only the first occurrence of each element\n * is kept. The order of result values is determined by the order they occur\n * in the array.\n *\n * @static\n * @memberOf _\n * @since 0.1.0\n * @category Array\n * @param {Array} array The array to inspect.\n * @returns {Array} Returns the new duplicate free array.\n * @example\n *\n * _.uniq([2, 1, 2]);\n * // => [2, 1]\n */\nfunction uniq(array) {\n  return (array && array.length) ? _baseUniq(array) : [];\n}\n\nvar uniq_1 = uniq;\n\nfunction camelCaseToDash(str) {\n    return str.replace(/([A-Z])/g, (g) => `-${g[0].toLowerCase()}`);\n}\n\nfunction makeDataAttributeString(props) {\n    const keys = Object.keys(props);\n\n    return keys\n        .map((key) => {\n            const _key = camelCaseToDash(key);\n            const val = props[key];\n\n            if (val === undefined) return '';\n            return `data-${_key}=\"${val}\" `;\n        })\n        .join('')\n        .trim();\n}\n\nfunction copyTextToClipboard(text) {\n    // https://stackoverflow.com/a/30810322/5353542\n    var textArea = document.createElement('textarea');\n\n    //\n    // *** This styling is an extra step which is likely not required. ***\n    //\n    // Why is it here? To ensure:\n    // 1. the element is able to have focus and selection.\n    // 2. if element was to flash render it has minimal visual impact.\n    // 3. less flakyness with selection and copying which **might** occur if\n    //    the textarea element is not visible.\n    //\n    // The likelihood is the element won't even render, not even a flash,\n    // so some of these are just precautions. However in IE the element\n    // is visible whilst the popup box asking the user for permission for\n    // the web page to copy to the clipboard.\n    //\n\n    // Place in top-left corner of screen regardless of scroll position.\n    textArea.style.position = 'fixed';\n    textArea.style.top = 0;\n    textArea.style.left = 0;\n\n    // Ensure it has a small width and height. Setting to 1px / 1em\n    // doesn't work as this gives a negative w/h on some browsers.\n    textArea.style.width = '2em';\n    textArea.style.height = '2em';\n\n    // We don't need padding, reducing the size if it does flash render.\n    textArea.style.padding = 0;\n\n    // Clean up any borders.\n    textArea.style.border = 'none';\n    textArea.style.outline = 'none';\n    textArea.style.boxShadow = 'none';\n\n    // Avoid flash of white box if rendered for any reason.\n    textArea.style.background = 'transparent';\n\n    textArea.value = text;\n\n    document.body.appendChild(textArea);\n\n    textArea.select();\n\n    try {\n        document.execCommand('copy');\n    } catch (err) {\n        console.log('Oops, unable to copy');\n    }\n\n    document.body.removeChild(textArea);\n}\n\nfunction isNumeric(val) {\n    return !isNaN(val);\n}\n\nlet throttle$1 = throttle_1;\n\nlet debounce$1 = debounce_1;\n\nfunction nextTick(fn, context = null) {\n    return (...args) => {\n        return new Promise(resolve => {\n            const execute = () => {\n                const out = fn.apply(context, args);\n                resolve(out);\n            };\n            setTimeout(execute);\n        });\n    };\n}\nfunction linkProperties(target, source, properties) {\n    const props = properties.reduce((acc, prop) => {\n        acc[prop] = {\n            get() {\n                return source[prop];\n            }\n        };\n        return acc;\n    }, {});\n    Object.defineProperties(target, props);\n}\nfunction isSet(val) {\n    return val !== undefined || val !== null;\n}\n\nfunction notSet(val) {\n    return !isSet(val);\n}\n\nfunction isNumber(val) {\n    return !isNaN(val);\n}\n\nfunction ensureArray(val) {\n    if (!Array.isArray(val)) {\n        return [val];\n    }\n    return val;\n}\n\nfunction uniq$1(arr) {\n    return uniq_1(arr);\n}\n\nfunction numberSortAsc(a, b) {\n    return a - b;\n}\nfunction stripHTML(html) {\n    return html.replace(/<[^>]*>/g, '');\n}\n\nclass DataManager {\n    constructor(options) {\n        this.options = options;\n        this.sortRows = nextTick(this.sortRows, this);\n        this.switchColumn = nextTick(this.switchColumn, this);\n        this.removeColumn = nextTick(this.removeColumn, this);\n        this.options.filterRows = nextTick(this.options.filterRows, this);\n    }\n\n    init(data, columns) {\n        if (!data) {\n            data = this.options.data;\n        }\n        if (columns) {\n            this.options.columns = columns;\n        }\n\n        this.data = data;\n\n        this.rowCount = 0;\n        this.columns = [];\n        this.rows = [];\n\n        this.prepareColumns();\n        this.prepareRows();\n        this.prepareTreeRows();\n        this.prepareRowView();\n        this.prepareNumericColumns();\n    }\n\n    // computed property\n    get currentSort() {\n        const col = this.columns.find(col => col.sortOrder !== 'none');\n        return col || {\n            colIndex: -1,\n            sortOrder: 'none'\n        };\n    }\n\n    prepareColumns() {\n        this.columns = [];\n        this.validateColumns();\n        this.prepareDefaultColumns();\n        this.prepareHeader();\n    }\n\n    prepareDefaultColumns() {\n        if (this.options.checkboxColumn && !this.hasColumnById('_checkbox')) {\n            const cell = {\n                id: '_checkbox',\n                content: this.getCheckboxHTML(),\n                editable: false,\n                resizable: false,\n                sortable: false,\n                focusable: false,\n                dropdown: false,\n                width: 32\n            };\n            this.columns.push(cell);\n        }\n\n        if (this.options.serialNoColumn && !this.hasColumnById('_rowIndex')) {\n            let cell = {\n                id: '_rowIndex',\n                content: '',\n                align: 'center',\n                editable: false,\n                resizable: false,\n                focusable: false,\n                dropdown: false\n            };\n\n            this.columns.push(cell);\n        }\n    }\n\n    prepareHeader() {\n        let columns = this.columns.concat(this.options.columns);\n        const baseCell = {\n            isHeader: 1,\n            editable: true,\n            sortable: true,\n            resizable: true,\n            focusable: true,\n            dropdown: true,\n            width: null,\n            format: (value) => {\n                if (value === null || value === undefined) {\n                    return '';\n                }\n                return value + '';\n            }\n        };\n\n        this.columns = columns\n            .map((cell, i) => this.prepareCell(cell, i))\n            .map(col => Object.assign({}, baseCell, col))\n            .map(col => {\n                col.content = col.content || col.name || '';\n                col.id = col.id || col.content;\n                return col;\n            });\n    }\n\n    prepareCell(content, i) {\n        const cell = {\n            content: '',\n            sortOrder: 'none',\n            colIndex: i,\n            column: this.columns[i]\n        };\n\n        if (content !== null && typeof content === 'object') {\n            // passed as column/header\n            Object.assign(cell, content);\n        } else {\n            cell.content = content;\n        }\n\n        return cell;\n    }\n\n    prepareNumericColumns() {\n        const row0 = this.getRow(0);\n        if (!row0) return;\n        this.columns = this.columns.map((column, i) => {\n\n            const cellValue = row0[i].content;\n            if (!column.align && isNumeric(cellValue)) {\n                column.align = 'right';\n            }\n\n            return column;\n        });\n    }\n\n    prepareRows() {\n        this.validateData(this.data);\n\n        this.rows = this.data.map((d, i) => {\n            const index = this._getNextRowCount();\n\n            let row = [];\n            let meta = {\n                rowIndex: index\n            };\n\n            if (Array.isArray(d)) {\n                // row is an array\n                if (this.options.checkboxColumn) {\n                    row.push(this.getCheckboxHTML());\n                }\n                if (this.options.serialNoColumn) {\n                    row.push((index + 1) + '');\n                }\n                row = row.concat(d);\n\n                while (row.length < this.columns.length) {\n                    row.push('');\n                }\n\n            } else {\n                // row is an object\n                for (let col of this.columns) {\n                    if (col.id === '_checkbox') {\n                        row.push(this.getCheckboxHTML());\n                    } else if (col.id === '_rowIndex') {\n                        row.push((index + 1) + '');\n                    } else {\n                        row.push(d[col.id]);\n                    }\n                }\n\n                meta.indent = d.indent || 0;\n            }\n\n            return this.prepareRow(row, meta);\n        });\n    }\n\n    prepareTreeRows() {\n        this.rows.forEach((row, i) => {\n            if (isNumber(row.meta.indent)) {\n                // if (i === 36) debugger;\n                const nextRow = this.getRow(i + 1);\n                row.meta.isLeaf = !nextRow ||\n                    notSet(nextRow.meta.indent) ||\n                    nextRow.meta.indent <= row.meta.indent;\n                row.meta.isTreeNodeClose = false;\n            }\n        });\n    }\n\n    prepareRowView() {\n        // This is order in which rows will be rendered in the table.\n        // When sorting happens, only this.rowViewOrder will change\n        // and not the original this.rows\n        this.rowViewOrder = this.rows.map(row => row.meta.rowIndex);\n    }\n\n    prepareRow(row, meta) {\n        const baseRowCell = {\n            rowIndex: meta.rowIndex,\n            indent: meta.indent\n        };\n\n        row = row\n            .map((cell, i) => this.prepareCell(cell, i))\n            .map(cell => Object.assign({}, baseRowCell, cell));\n\n        // monkey patched in array object\n        row.meta = meta;\n        return row;\n    }\n\n    validateColumns() {\n        const columns = this.options.columns;\n        if (!Array.isArray(columns)) {\n            throw new DataError('`columns` must be an array');\n        }\n\n        columns.forEach((column, i) => {\n            if (typeof column !== 'string' && typeof column !== 'object') {\n                throw new DataError(`column \"${i}\" must be a string or an object`);\n            }\n        });\n    }\n\n    validateData(data) {\n        if (Array.isArray(data) &&\n            (data.length === 0 || Array.isArray(data[0]) || typeof data[0] === 'object')) {\n            return true;\n        }\n        throw new DataError('`data` must be an array of arrays or objects');\n    }\n\n    appendRows(rows) {\n        this.validateData(rows);\n\n        this.rows.push(...this.prepareRows(rows));\n    }\n\n    sortRows(colIndex, sortOrder = 'none') {\n        colIndex = +colIndex;\n\n        // reset sortOrder and update for colIndex\n        this.getColumns()\n            .map(col => {\n                if (col.colIndex === colIndex) {\n                    col.sortOrder = sortOrder;\n                } else {\n                    col.sortOrder = 'none';\n                }\n            });\n\n        this._sortRows(colIndex, sortOrder);\n    }\n\n    _sortRows(colIndex, sortOrder) {\n\n        if (this.currentSort.colIndex === colIndex) {\n            // reverse the array if only sortOrder changed\n            if (\n                (this.currentSort.sortOrder === 'asc' && sortOrder === 'desc') ||\n                (this.currentSort.sortOrder === 'desc' && sortOrder === 'asc')\n            ) {\n                this.reverseArray(this.rowViewOrder);\n                this.currentSort.sortOrder = sortOrder;\n                return;\n            }\n        }\n\n        this.rowViewOrder.sort((a, b) => {\n            const aIndex = a;\n            const bIndex = b;\n            const aContent = this.getCell(colIndex, a).content;\n            const bContent = this.getCell(colIndex, b).content;\n\n            if (sortOrder === 'none') {\n                return aIndex - bIndex;\n            } else if (sortOrder === 'asc') {\n                if (aContent < bContent) return -1;\n                if (aContent > bContent) return 1;\n                if (aContent === bContent) return 0;\n            } else if (sortOrder === 'desc') {\n                if (aContent < bContent) return 1;\n                if (aContent > bContent) return -1;\n                if (aContent === bContent) return 0;\n            }\n            return 0;\n        });\n\n        if (this.hasColumnById('_rowIndex')) {\n            // update row index\n            const srNoColIndex = this.getColumnIndexById('_rowIndex');\n            this.rows.forEach((row, index) => {\n                const viewIndex = this.rowViewOrder.indexOf(index);\n                const cell = row[srNoColIndex];\n                cell.content = (viewIndex + 1) + '';\n            });\n        }\n    }\n\n    reverseArray(array) {\n        let left = null;\n        let right = null;\n        let length = array.length;\n\n        for (left = 0, right = length - 1; left < right; left += 1, right -= 1) {\n            const temporary = array[left];\n\n            array[left] = array[right];\n            array[right] = temporary;\n        }\n    }\n\n    switchColumn(index1, index2) {\n        // update columns\n        const temp = this.columns[index1];\n        this.columns[index1] = this.columns[index2];\n        this.columns[index2] = temp;\n\n        this.columns[index1].colIndex = index1;\n        this.columns[index2].colIndex = index2;\n\n        // update rows\n        this.rows.forEach(row => {\n            const newCell1 = Object.assign({}, row[index1], {\n                colIndex: index2\n            });\n            const newCell2 = Object.assign({}, row[index2], {\n                colIndex: index1\n            });\n\n            row[index2] = newCell1;\n            row[index1] = newCell2;\n        });\n    }\n\n    removeColumn(index) {\n        index = +index;\n        const filter = cell => cell.colIndex !== index;\n        const map = (cell, i) => Object.assign({}, cell, {\n            colIndex: i\n        });\n        // update columns\n        this.columns = this.columns\n            .filter(filter)\n            .map(map);\n\n        // update rows\n        this.rows.forEach(row => {\n            // remove cell\n            row.splice(index, 1);\n            // update colIndex\n            row.forEach((cell, i) => {\n                cell.colIndex = i;\n            });\n        });\n    }\n\n    updateRow(row, rowIndex) {\n        if (row.length < this.columns.length) {\n            if (this.hasColumnById('_rowIndex')) {\n                const val = (rowIndex + 1) + '';\n\n                row = [val].concat(row);\n            }\n\n            if (this.hasColumnById('_checkbox')) {\n                const val = '<input type=\"checkbox\" />';\n\n                row = [val].concat(row);\n            }\n        }\n\n        const _row = this.prepareRow(row, {rowIndex});\n        const index = this.rows.findIndex(row => row[0].rowIndex === rowIndex);\n        this.rows[index] = _row;\n\n        return _row;\n    }\n\n    updateCell(colIndex, rowIndex, options) {\n        let cell;\n        if (typeof colIndex === 'object') {\n            // cell object was passed,\n            // must have colIndex, rowIndex\n            cell = colIndex;\n            colIndex = cell.colIndex;\n            rowIndex = cell.rowIndex;\n            // the object passed must be merged with original cell\n            options = cell;\n        }\n        cell = this.getCell(colIndex, rowIndex);\n\n        // mutate object directly\n        for (let key in options) {\n            const newVal = options[key];\n            if (newVal !== undefined) {\n                cell[key] = newVal;\n            }\n        }\n\n        return cell;\n    }\n\n    updateColumn(colIndex, keyValPairs) {\n        const column = this.getColumn(colIndex);\n        for (let key in keyValPairs) {\n            const newVal = keyValPairs[key];\n            if (newVal !== undefined) {\n                column[key] = newVal;\n            }\n        }\n        return column;\n    }\n\n    filterRows(filters) {\n        return this.options.filterRows(this.rows, filters)\n            .then(result => {\n                if (!result) {\n                    result = this.getAllRowIndices();\n                }\n\n                if (!result.then) {\n                    result = Promise.resolve(result);\n                }\n\n                return result.then(rowsToShow => {\n                    this._filteredRows = rowsToShow;\n\n                    const rowsToHide = this.getAllRowIndices()\n                        .filter(index => !rowsToShow.includes(index));\n\n                    return {\n                        rowsToHide,\n                        rowsToShow\n                    };\n                });\n            });\n    }\n\n    getFilteredRowIndices() {\n        return this._filteredRows || this.getAllRowIndices();\n    }\n\n    getAllRowIndices() {\n        return this.rows.map(row => row.meta.rowIndex);\n    }\n\n    getRowCount() {\n        return this.rowCount;\n    }\n\n    _getNextRowCount() {\n        const val = this.rowCount;\n\n        this.rowCount++;\n        return val;\n    }\n\n    getRows(start, end) {\n        return this.rows.slice(start, end);\n    }\n\n    getRowsForView(start, end) {\n        const rows = this.rowViewOrder.map(i => this.rows[i]);\n        return rows.slice(start, end);\n    }\n\n    getColumns(skipStandardColumns) {\n        let columns = this.columns;\n\n        if (skipStandardColumns) {\n            columns = columns.slice(this.getStandardColumnCount());\n        }\n\n        return columns;\n    }\n\n    getStandardColumnCount() {\n        if (this.options.checkboxColumn && this.options.serialNoColumn) {\n            return 2;\n        }\n\n        if (this.options.checkboxColumn || this.options.serialNoColumn) {\n            return 1;\n        }\n\n        return 0;\n    }\n\n    getColumnCount(skipStandardColumns) {\n        let val = this.columns.length;\n\n        if (skipStandardColumns) {\n            val = val - this.getStandardColumnCount();\n        }\n\n        return val;\n    }\n\n    getColumn(colIndex) {\n        colIndex = +colIndex;\n\n        if (colIndex < 0) {\n            // negative indexes\n            colIndex = this.columns.length + colIndex;\n        }\n\n        return this.columns.find(col => col.colIndex === colIndex);\n    }\n\n    getColumnById(id) {\n        return this.columns.find(col => col.id === id);\n    }\n\n    getRow(rowIndex) {\n        rowIndex = +rowIndex;\n        return this.rows[rowIndex];\n    }\n\n    getCell(colIndex, rowIndex) {\n        rowIndex = +rowIndex;\n        colIndex = +colIndex;\n        return this.getRow(rowIndex)[colIndex];\n    }\n\n    getChildren(parentRowIndex) {\n        parentRowIndex = +parentRowIndex;\n        const parentIndent = this.getRow(parentRowIndex).meta.indent;\n        const out = [];\n\n        for (let i = parentRowIndex + 1; i < this.rowCount; i++) {\n            const row = this.getRow(i);\n            if (isNaN(row.meta.indent)) continue;\n\n            if (row.meta.indent > parentIndent) {\n                out.push(i);\n            }\n\n            if (row.meta.indent === parentIndent) {\n                break;\n            }\n        }\n\n        return out;\n    }\n\n    getImmediateChildren(parentRowIndex) {\n        parentRowIndex = +parentRowIndex;\n        const parentIndent = this.getRow(parentRowIndex).meta.indent;\n        const out = [];\n        const childIndent = parentIndent + 1;\n\n        for (let i = parentRowIndex + 1; i < this.rowCount; i++) {\n            const row = this.getRow(i);\n            if (isNaN(row.meta.indent) || row.meta.indent > childIndent) continue;\n\n            if (row.meta.indent === childIndent) {\n                out.push(i);\n            }\n\n            if (row.meta.indent === parentIndent) {\n                break;\n            }\n        }\n\n        return out;\n    }\n\n    get() {\n        return {\n            columns: this.columns,\n            rows: this.rows\n        };\n    }\n\n    /**\n     * Returns the original data which was passed\n     * based on rowIndex\n     * @param {Number} rowIndex\n     * @returns Array|Object\n     * @memberof DataManager\n     */\n    getData(rowIndex) {\n        return this.data[rowIndex];\n    }\n\n    hasColumn(name) {\n        return Boolean(this.columns.find(col => col.content === name));\n    }\n\n    hasColumnById(id) {\n        return Boolean(this.columns.find(col => col.id === id));\n    }\n\n    getColumnIndex(name) {\n        return this.columns.findIndex(col => col.content === name);\n    }\n\n    getColumnIndexById(id) {\n        return this.columns.findIndex(col => col.id === id);\n    }\n\n    getCheckboxHTML() {\n        return '<input type=\"checkbox\" />';\n    }\n}\n\n// Custom Errors\nclass DataError extends TypeError {}\n\n/* eslint-disable max-len */\n\n// Icons from https://feathericons.com/\n\nlet icons = {\n    chevronDown: '<svg xmlns=\"http://www.w3.org/2000/svg\" width=\"16\" height=\"16\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"2\" stroke-linecap=\"round\" stroke-linejoin=\"round\" class=\"feather feather-chevron-down\"><polyline points=\"6 9 12 15 18 9\"></polyline></svg>',\n    chevronRight: '<svg xmlns=\"http://www.w3.org/2000/svg\" width=\"16\" height=\"16\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"2\" stroke-linecap=\"round\" stroke-linejoin=\"round\" class=\"feather feather-chevron-right\"><polyline points=\"9 18 15 12 9 6\"></polyline></svg>'\n};\n\nclass CellManager {\n    constructor(instance) {\n        this.instance = instance;\n        linkProperties(this, this.instance, [\n            'wrapper',\n            'options',\n            'style',\n            'header',\n            'bodyScrollable',\n            'columnmanager',\n            'rowmanager',\n            'datamanager',\n            'keyboard'\n        ]);\n\n        this.bindEvents();\n    }\n\n    bindEvents() {\n        this.bindFocusCell();\n        this.bindEditCell();\n        this.bindKeyboardSelection();\n        this.bindCopyCellContents();\n        this.bindMouseEvents();\n        this.bindTreeEvents();\n    }\n\n    bindFocusCell() {\n        this.bindKeyboardNav();\n    }\n\n    bindEditCell() {\n        this.$editingCell = null;\n\n        $.on(this.bodyScrollable, 'dblclick', '.dt-cell', (e, cell) => {\n            this.activateEditing(cell);\n        });\n\n        this.keyboard.on('enter', () => {\n            if (this.$focusedCell && !this.$editingCell) {\n                // enter keypress on focused cell\n                this.activateEditing(this.$focusedCell);\n            } else if (this.$editingCell) {\n                // enter keypress on editing cell\n                this.submitEditing();\n                this.deactivateEditing();\n            }\n        });\n    }\n\n    bindKeyboardNav() {\n        const focusCell = (direction) => {\n            if (!this.$focusedCell || this.$editingCell) {\n                return false;\n            }\n\n            let $cell = this.$focusedCell;\n\n            if (direction === 'left' || direction === 'shift+tab') {\n                $cell = this.getLeftCell$($cell);\n            } else if (direction === 'right' || direction === 'tab') {\n                $cell = this.getRightCell$($cell);\n            } else if (direction === 'up') {\n                $cell = this.getAboveCell$($cell);\n            } else if (direction === 'down') {\n                $cell = this.getBelowCell$($cell);\n            }\n\n            this.focusCell($cell);\n            return true;\n        };\n\n        const focusLastCell = (direction) => {\n            if (!this.$focusedCell || this.$editingCell) {\n                return false;\n            }\n\n            let $cell = this.$focusedCell;\n            const {\n                rowIndex,\n                colIndex\n            } = $.data($cell);\n\n            if (direction === 'left') {\n                $cell = this.getLeftMostCell$(rowIndex);\n            } else if (direction === 'right') {\n                $cell = this.getRightMostCell$(rowIndex);\n            } else if (direction === 'up') {\n                $cell = this.getTopMostCell$(colIndex);\n            } else if (direction === 'down') {\n                $cell = this.getBottomMostCell$(colIndex);\n            }\n\n            this.focusCell($cell);\n            return true;\n        };\n\n        ['left', 'right', 'up', 'down', 'tab', 'shift+tab']\n            .map(direction => this.keyboard.on(direction, () => focusCell(direction)));\n\n        ['left', 'right', 'up', 'down']\n            .map(direction => this.keyboard.on(`ctrl+${direction}`, () => focusLastCell(direction)));\n\n        this.keyboard.on('esc', () => {\n            this.deactivateEditing();\n            this.columnmanager.toggleFilter(false);\n        });\n\n        if (this.options.inlineFilters) {\n            this.keyboard.on('ctrl+f', (e) => {\n                const $cell = $.closest('.dt-cell', e.target);\n                const { colIndex } = $.data($cell);\n\n                this.activateFilter(colIndex);\n                return true;\n            });\n\n            $.on(this.header, 'focusin', '.dt-filter', () => {\n                this.unfocusCell(this.$focusedCell);\n            });\n        }\n    }\n\n    bindKeyboardSelection() {\n        const getNextSelectionCursor = (direction) => {\n            let $selectionCursor = this.getSelectionCursor();\n\n            if (direction === 'left') {\n                $selectionCursor = this.getLeftCell$($selectionCursor);\n            } else if (direction === 'right') {\n                $selectionCursor = this.getRightCell$($selectionCursor);\n            } else if (direction === 'up') {\n                $selectionCursor = this.getAboveCell$($selectionCursor);\n            } else if (direction === 'down') {\n                $selectionCursor = this.getBelowCell$($selectionCursor);\n            }\n\n            return $selectionCursor;\n        };\n\n        ['left', 'right', 'up', 'down']\n            .map(direction =>\n                this.keyboard.on(`shift+${direction}`, () => this.selectArea(getNextSelectionCursor(direction))));\n    }\n\n    bindCopyCellContents() {\n        this.keyboard.on('ctrl+c', () => {\n            const noOfCellsCopied = this.copyCellContents(this.$focusedCell, this.$selectionCursor);\n            const message = `${noOfCellsCopied} cell${noOfCellsCopied > 1 ? 's' : ''} copied`;\n            if (noOfCellsCopied) {\n                this.instance.showToastMessage(message, 2);\n            }\n        });\n\n        if (this.options.pasteFromClipboard) {\n            this.keyboard.on('ctrl+v', (e) => {\n                // hack\n                // https://stackoverflow.com/a/2177059/5353542\n                this.instance.pasteTarget.focus();\n\n                setTimeout(() => {\n                    const data = this.instance.pasteTarget.value;\n                    this.instance.pasteTarget.value = '';\n                    this.pasteContentInCell(data);\n                }, 10);\n\n                return false;\n            });\n        }\n    }\n\n    bindMouseEvents() {\n        let mouseDown = null;\n\n        $.on(this.bodyScrollable, 'mousedown', '.dt-cell', (e) => {\n            mouseDown = true;\n            this.focusCell($(e.delegatedTarget));\n        });\n\n        $.on(this.bodyScrollable, 'mouseup', () => {\n            mouseDown = false;\n        });\n\n        const selectArea = (e) => {\n            if (!mouseDown) return;\n            this.selectArea($(e.delegatedTarget));\n        };\n\n        $.on(this.bodyScrollable, 'mousemove', '.dt-cell', throttle$1(selectArea, 50));\n    }\n\n    bindTreeEvents() {\n        $.on(this.bodyScrollable, 'click', '.dt-tree-node__toggle', (e, $toggle) => {\n            const $cell = $.closest('.dt-cell', $toggle);\n            const { rowIndex } = $.data($cell);\n\n            if ($cell.classList.contains('dt-cell--tree-close')) {\n                this.rowmanager.openSingleNode(rowIndex);\n            } else {\n                this.rowmanager.closeSingleNode(rowIndex);\n            }\n        });\n    }\n\n    focusCell($cell, {\n        skipClearSelection = 0,\n        skipDOMFocus = 0,\n        skipScrollToCell = 0\n    } = {}) {\n        if (!$cell) return;\n\n        // don't focus if already editing cell\n        if ($cell === this.$editingCell) return;\n\n        const {\n            colIndex,\n            isHeader\n        } = $.data($cell);\n        if (isHeader) {\n            return;\n        }\n\n        const column = this.columnmanager.getColumn(colIndex);\n        if (column.focusable === false) {\n            return;\n        }\n\n        if (!skipScrollToCell) {\n            this.scrollToCell($cell);\n        }\n\n        this.deactivateEditing();\n        if (!skipClearSelection) {\n            this.clearSelection();\n        }\n\n        if (this.$focusedCell) {\n            this.$focusedCell.classList.remove('dt-cell--focus');\n        }\n\n        this.$focusedCell = $cell;\n        $cell.classList.add('dt-cell--focus');\n\n        if (!skipDOMFocus) {\n            // so that keyboard nav works\n            $cell.focus();\n        }\n\n        this.highlightRowColumnHeader($cell);\n    }\n\n    unfocusCell($cell) {\n        if (!$cell) return;\n\n        // remove cell border\n        $cell.classList.remove('dt-cell--focus');\n        this.$focusedCell = null;\n\n        // reset header background\n        if (this.lastHeaders) {\n            this.lastHeaders.forEach(header => header.classList.remove('dt-cell--highlight'));\n        }\n    }\n\n    highlightRowColumnHeader($cell) {\n        const {\n            colIndex,\n            rowIndex\n        } = $.data($cell);\n\n        const srNoColIndex = this.datamanager.getColumnIndexById('_rowIndex');\n        const colHeaderSelector = `.dt-cell--header-${colIndex}`;\n        const rowHeaderSelector = `.dt-cell--${srNoColIndex}-${rowIndex}`;\n\n        if (this.lastHeaders) {\n            this.lastHeaders.forEach(header => header.classList.remove('dt-cell--highlight'));\n        }\n\n        const colHeader = $(colHeaderSelector, this.wrapper);\n        const rowHeader = $(rowHeaderSelector, this.wrapper);\n\n        this.lastHeaders = [colHeader, rowHeader];\n        this.lastHeaders.forEach(header => header.classList.add('dt-cell--highlight'));\n    }\n\n    selectAreaOnClusterChanged() {\n        if (!(this.$focusedCell && this.$selectionCursor)) return;\n        const {\n            colIndex,\n            rowIndex\n        } = $.data(this.$selectionCursor);\n        const $cell = this.getCell$(colIndex, rowIndex);\n\n        if (!$cell || $cell === this.$selectionCursor) return;\n\n        // selectArea needs $focusedCell\n        const fCell = $.data(this.$focusedCell);\n        this.$focusedCell = this.getCell$(fCell.colIndex, fCell.rowIndex);\n\n        this.selectArea($cell);\n    }\n\n    focusCellOnClusterChanged() {\n        if (!this.$focusedCell) return;\n\n        const {\n            colIndex,\n            rowIndex\n        } = $.data(this.$focusedCell);\n        const $cell = this.getCell$(colIndex, rowIndex);\n\n        if (!$cell) return;\n        // this function is called after hyperlist renders the rows after scroll,\n        // focusCell calls clearSelection which resets the area selection\n        // so a flag to skip it\n        // we also skip DOM focus and scroll to cell\n        // because it fights with the user scroll\n        this.focusCell($cell, {\n            skipClearSelection: 1,\n            skipDOMFocus: 1,\n            skipScrollToCell: 1\n        });\n    }\n\n    selectArea($selectionCursor) {\n        if (!this.$focusedCell) return;\n\n        if (this._selectArea(this.$focusedCell, $selectionCursor)) {\n            // valid selection\n            this.$selectionCursor = $selectionCursor;\n        }\n    }\n\n    _selectArea($cell1, $cell2) {\n        if ($cell1 === $cell2) return false;\n\n        const cells = this.getCellsInRange($cell1, $cell2);\n        if (!cells) return false;\n\n        this.clearSelection();\n        this._selectedCells = cells.map(index => this.getCell$(...index));\n        requestAnimationFrame(() => {\n            this._selectedCells.map($cell => $cell.classList.add('dt-cell--highlight'));\n        });\n        return true;\n    }\n\n    getCellsInRange($cell1, $cell2) {\n        let colIndex1, rowIndex1, colIndex2, rowIndex2;\n\n        if (typeof $cell1 === 'number') {\n            [colIndex1, rowIndex1, colIndex2, rowIndex2] = arguments;\n        } else\n        if (typeof $cell1 === 'object') {\n            if (!($cell1 && $cell2)) {\n                return false;\n            }\n\n            const cell1 = $.data($cell1);\n            const cell2 = $.data($cell2);\n\n            colIndex1 = +cell1.colIndex;\n            rowIndex1 = +cell1.rowIndex;\n            colIndex2 = +cell2.colIndex;\n            rowIndex2 = +cell2.rowIndex;\n        }\n\n        if (rowIndex1 > rowIndex2) {\n            [rowIndex1, rowIndex2] = [rowIndex2, rowIndex1];\n        }\n\n        if (colIndex1 > colIndex2) {\n            [colIndex1, colIndex2] = [colIndex2, colIndex1];\n        }\n\n        if (this.isStandardCell(colIndex1) || this.isStandardCell(colIndex2)) {\n            return false;\n        }\n\n        const cells = [];\n        let colIndex = colIndex1;\n        let rowIndex = rowIndex1;\n        const rowIndices = [];\n\n        while (rowIndex <= rowIndex2) {\n            rowIndices.push(rowIndex);\n            rowIndex += 1;\n        }\n\n        rowIndices.map((rowIndex) => {\n            while (colIndex <= colIndex2) {\n                cells.push([colIndex, rowIndex]);\n                colIndex++;\n            }\n            colIndex = colIndex1;\n        });\n\n        return cells;\n    }\n\n    clearSelection() {\n        (this._selectedCells || [])\n            .forEach($cell => $cell.classList.remove('dt-cell--highlight'));\n\n        this._selectedCells = [];\n        this.$selectionCursor = null;\n    }\n\n    getSelectionCursor() {\n        return this.$selectionCursor || this.$focusedCell;\n    }\n\n    activateEditing($cell) {\n        this.focusCell($cell);\n        const {\n            rowIndex,\n            colIndex\n        } = $.data($cell);\n\n        const col = this.columnmanager.getColumn(colIndex);\n        if (col && (col.editable === false || col.focusable === false)) {\n            return;\n        }\n\n        const cell = this.getCell(colIndex, rowIndex);\n        if (cell && cell.editable === false) {\n            return;\n        }\n\n        if (this.$editingCell) {\n            const {\n                _rowIndex,\n                _colIndex\n            } = $.data(this.$editingCell);\n\n            if (rowIndex === _rowIndex && colIndex === _colIndex) {\n                // editing the same cell\n                return;\n            }\n        }\n\n        this.$editingCell = $cell;\n        $cell.classList.add('dt-cell--editing');\n\n        const $editCell = $('.dt-cell__edit', $cell);\n        $editCell.innerHTML = '';\n\n        const editor = this.getEditor(colIndex, rowIndex, cell.content, $editCell);\n\n        if (editor) {\n            this.currentCellEditor = editor;\n            // initialize editing input with cell value\n            editor.initValue(cell.content, rowIndex, col);\n        }\n    }\n\n    deactivateEditing() {\n        // keep focus on the cell so that keyboard navigation works\n        if (this.$focusedCell) this.$focusedCell.focus();\n\n        if (!this.$editingCell) return;\n        this.$editingCell.classList.remove('dt-cell--editing');\n        this.$editingCell = null;\n    }\n\n    getEditor(colIndex, rowIndex, value, parent) {\n        const column = this.datamanager.getColumn(colIndex);\n        const row = this.datamanager.getRow(rowIndex);\n        const data = this.datamanager.getData(rowIndex);\n        let editor = this.options.getEditor ?\n            this.options.getEditor(colIndex, rowIndex, value, parent, column, row, data) :\n            this.getDefaultEditor(parent);\n\n        if (editor === false) {\n            // explicitly returned false\n            return false;\n        }\n        if (editor === undefined) {\n            // didn't return editor, fallback to default\n            editor = this.getDefaultEditor(parent);\n        }\n\n        return editor;\n    }\n\n    getDefaultEditor(parent) {\n        const $input = $.create('input', {\n            class: 'dt-input',\n            type: 'text',\n            inside: parent\n        });\n\n        return {\n            initValue(value) {\n                $input.focus();\n                $input.value = value;\n            },\n            getValue() {\n                return $input.value;\n            },\n            setValue(value) {\n                $input.value = value;\n            }\n        };\n    }\n\n    submitEditing() {\n        if (!this.$editingCell) return;\n        const $cell = this.$editingCell;\n        const {\n            rowIndex,\n            colIndex\n        } = $.data($cell);\n        const col = this.datamanager.getColumn(colIndex);\n\n        if ($cell) {\n            const editor = this.currentCellEditor;\n\n            if (editor) {\n                let valuePromise = editor.getValue();\n\n                // convert to stubbed Promise\n                if (!valuePromise.then) {\n                    valuePromise = Promise.resolve(valuePromise);\n                }\n\n                valuePromise.then((value) => {\n                    const done = editor.setValue(value, rowIndex, col);\n                    const oldValue = this.getCell(colIndex, rowIndex).content;\n\n                    // update cell immediately\n                    this.updateCell(colIndex, rowIndex, value);\n                    $cell.focus();\n\n                    if (done && done.then) {\n                        // revert to oldValue if promise fails\n                        done.catch((e) => {\n                            console.log(e);\n                            this.updateCell(colIndex, rowIndex, oldValue);\n                        });\n                    }\n                });\n            }\n        }\n\n        this.currentCellEditor = null;\n    }\n\n    copyCellContents($cell1, $cell2) {\n        if (!$cell2 && $cell1) {\n            // copy only focusedCell\n            const {\n                colIndex,\n                rowIndex\n            } = $.data($cell1);\n            const cell = this.getCell(colIndex, rowIndex);\n            copyTextToClipboard(cell.content);\n            return 1;\n        }\n        const cells = this.getCellsInRange($cell1, $cell2);\n\n        if (!cells) return 0;\n\n        const rows = cells\n            // get cell objects\n            .map(index => this.getCell(...index))\n            // convert to array of rows\n            .reduce((acc, curr) => {\n                const rowIndex = curr.rowIndex;\n\n                acc[rowIndex] = acc[rowIndex] || [];\n                acc[rowIndex].push(curr.content);\n\n                return acc;\n            }, []);\n\n        const values = rows\n            // join values by tab\n            .map(row => row.join('\\t'))\n            // join rows by newline\n            .join('\\n');\n\n        copyTextToClipboard(values);\n\n        // return no of cells copied\n        return rows.reduce((total, row) => total + row.length, 0);\n    }\n\n    pasteContentInCell(data) {\n        if (!this.$focusedCell) return;\n\n        const matrix = data\n            .split('\\n')\n            .map(row => row.split('\\t'))\n            .filter(row => row.length && row.every(it => it));\n\n        let { colIndex, rowIndex } = $.data(this.$focusedCell);\n\n        let focusedCell = {\n            colIndex: +colIndex,\n            rowIndex: +rowIndex\n        };\n\n        matrix.forEach((row, i) => {\n            let rowIndex = i + focusedCell.rowIndex;\n            row.forEach((cell, j) => {\n                let colIndex = j + focusedCell.colIndex;\n                this.updateCell(colIndex, rowIndex, cell);\n            });\n        });\n    }\n\n    activateFilter(colIndex) {\n        this.columnmanager.toggleFilter();\n        this.columnmanager.focusFilter(colIndex);\n\n        if (!this.columnmanager.isFilterShown) {\n            // put focus back on cell\n            this.$focusedCell && this.$focusedCell.focus();\n        }\n    }\n\n    updateCell(colIndex, rowIndex, value) {\n        const cell = this.datamanager.updateCell(colIndex, rowIndex, {\n            content: value\n        });\n        this.refreshCell(cell);\n    }\n\n    refreshCell(cell) {\n        const $cell = $(this.selector(cell.colIndex, cell.rowIndex), this.bodyScrollable);\n        $cell.innerHTML = this.getCellContent(cell);\n    }\n\n    toggleTreeButton(rowIndex, flag) {\n        const colIndex = this.columnmanager.getFirstColumnIndex();\n        const $cell = this.getCell$(colIndex, rowIndex);\n        if ($cell) {\n            $cell.classList[flag ? 'remove' : 'add']('dt-cell--tree-close');\n        }\n    }\n\n    isStandardCell(colIndex) {\n        // Standard cells are in Sr. No and Checkbox column\n        return colIndex < this.columnmanager.getFirstColumnIndex();\n    }\n\n    getCell$(colIndex, rowIndex) {\n        return $(this.selector(colIndex, rowIndex), this.bodyScrollable);\n    }\n\n    getAboveCell$($cell) {\n        const {\n            colIndex\n        } = $.data($cell);\n\n        let $aboveRow = $cell.parentElement.previousElementSibling;\n        while ($aboveRow && $aboveRow.classList.contains('dt-row--hide')) {\n            $aboveRow = $aboveRow.previousElementSibling;\n        }\n\n        if (!$aboveRow) return $cell;\n        return $(`.dt-cell--col-${colIndex}`, $aboveRow);\n    }\n\n    getBelowCell$($cell) {\n        const {\n            colIndex\n        } = $.data($cell);\n\n        let $belowRow = $cell.parentElement.nextElementSibling;\n        while ($belowRow && $belowRow.classList.contains('dt-row--hide')) {\n            $belowRow = $belowRow.nextElementSibling;\n        }\n\n        if (!$belowRow) return $cell;\n        return $(`.dt-cell--col-${colIndex}`, $belowRow);\n    }\n\n    getLeftCell$($cell) {\n        return $cell.previousElementSibling;\n    }\n\n    getRightCell$($cell) {\n        return $cell.nextElementSibling;\n    }\n\n    getLeftMostCell$(rowIndex) {\n        return this.getCell$(this.columnmanager.getFirstColumnIndex(), rowIndex);\n    }\n\n    getRightMostCell$(rowIndex) {\n        return this.getCell$(this.columnmanager.getLastColumnIndex(), rowIndex);\n    }\n\n    getTopMostCell$(colIndex) {\n        return this.getCell$(colIndex, this.rowmanager.getFirstRowIndex());\n    }\n\n    getBottomMostCell$(colIndex) {\n        return this.getCell$(colIndex, this.rowmanager.getLastRowIndex());\n    }\n\n    getCell(colIndex, rowIndex) {\n        return this.instance.datamanager.getCell(colIndex, rowIndex);\n    }\n\n    getRowHeight() {\n        return $.style($('.dt-row', this.bodyScrollable), 'height');\n    }\n\n    scrollToCell($cell) {\n        if ($.inViewport($cell, this.bodyScrollable)) return false;\n\n        const {\n            rowIndex\n        } = $.data($cell);\n        this.rowmanager.scrollToRow(rowIndex);\n        return false;\n    }\n\n    getRowCountPerPage() {\n        return Math.ceil(this.instance.getViewportHeight() / this.getRowHeight());\n    }\n\n    getCellHTML(cell) {\n        const {\n            rowIndex,\n            colIndex,\n            isHeader,\n            isFilter,\n            isTotalRow\n        } = cell;\n        const dataAttr = makeDataAttributeString({\n            rowIndex,\n            colIndex,\n            isHeader,\n            isFilter,\n            isTotalRow\n        });\n\n        const row = this.datamanager.getRow(rowIndex);\n\n        const isBodyCell = !(isHeader || isFilter || isTotalRow);\n\n        const className = [\n            'dt-cell',\n            'dt-cell--col-' + colIndex,\n            isBodyCell ? `dt-cell--${colIndex}-${rowIndex}` : '',\n            isBodyCell ? 'dt-cell--row-' + rowIndex : '',\n            isHeader ? 'dt-cell--header' : '',\n            isHeader ? `dt-cell--header-${colIndex}` : '',\n            isFilter ? 'dt-cell--filter' : '',\n            isBodyCell && row.meta.isTreeNodeClose ? 'dt-cell--tree-close' : ''\n        ].join(' ');\n\n        return `\n            <div class=\"${className}\" ${dataAttr} tabindex=\"0\">\n                ${this.getCellContent(cell)}\n            </div>\n        `;\n    }\n\n    getCellContent(cell) {\n        const {\n            isHeader,\n            isFilter,\n            colIndex\n        } = cell;\n\n        const editable = !isHeader && cell.editable !== false;\n        const editCellHTML = editable ? this.getEditCellHTML(colIndex) : '';\n\n        const sortable = isHeader && cell.sortable !== false;\n        const sortIndicator = sortable ?\n            `<span class=\"sort-indicator\">\n                ${this.options.sortIndicator[cell.sortOrder]}\n            </span>` :\n            '';\n\n        const resizable = isHeader && cell.resizable !== false;\n        const resizeColumn = resizable ? '<span class=\"dt-cell__resize-handle\"></span>' : '';\n\n        const hasDropdown = isHeader && cell.dropdown !== false;\n        const dropdown = hasDropdown ? this.columnmanager.getDropdownHTML() : '';\n\n        const customFormatter = cell.format || (cell.column && cell.column.format) || null;\n\n        let contentHTML;\n        if (isHeader || isFilter || !customFormatter) {\n            contentHTML = cell.content;\n        } else {\n            const row = this.datamanager.getRow(cell.rowIndex);\n            const data = this.datamanager.getData(cell.rowIndex);\n            contentHTML = customFormatter(cell.content, row, cell.column, data);\n        }\n\n        cell.html = contentHTML;\n\n        if (this.options.treeView && !(isHeader || isFilter) && cell.indent !== undefined) {\n            const nextRow = this.datamanager.getRow(cell.rowIndex + 1);\n            const addToggle = nextRow && nextRow.meta.indent > cell.indent;\n            const leftPadding = 20;\n            const unit = 'px';\n\n            // Add toggle and indent in the first column\n            const firstColumnIndex = this.datamanager.getColumnIndexById('_rowIndex') + 1;\n            if (firstColumnIndex === cell.colIndex) {\n                const padding = ((cell.indent || 0)) * leftPadding;\n                const toggleHTML = addToggle ?\n                    `<span class=\"dt-tree-node__toggle\" style=\"left: ${padding - leftPadding}${unit}\">\n                        <span class=\"icon-open\">${icons.chevronDown}</span>\n                        <span class=\"icon-close\">${icons.chevronRight}</span>\n                    </span>` : '';\n                contentHTML = `<span class=\"dt-tree-node\" style=\"padding-left: ${padding}${unit}\">\n                    ${toggleHTML}\n                    <span>${contentHTML}</span>\n                </span>`;\n            }\n        }\n\n        const className = [\n            'dt-cell__content',\n            isHeader ? `dt-cell__content--header-${colIndex}` : `dt-cell__content--col-${colIndex}`\n        ].join(' ');\n\n        return `\n            <div class=\"${className}\">\n                ${contentHTML}\n                ${sortIndicator}\n                ${resizeColumn}\n                ${dropdown}\n            </div>\n            ${editCellHTML}\n        `;\n    }\n\n    getEditCellHTML(colIndex) {\n        return `<div class=\"dt-cell__edit dt-cell__edit--col-${colIndex}\"></div>`;\n    }\n\n    selector(colIndex, rowIndex) {\n        return `.dt-cell--${colIndex}-${rowIndex}`;\n    }\n}\n\nclass ColumnManager {\n    constructor(instance) {\n        this.instance = instance;\n\n        linkProperties(this, this.instance, [\n            'options',\n            'fireEvent',\n            'header',\n            'datamanager',\n            'cellmanager',\n            'style',\n            'wrapper',\n            'rowmanager',\n            'bodyScrollable',\n            'bodyRenderer'\n        ]);\n\n        this.bindEvents();\n    }\n\n    renderHeader() {\n        this.header.innerHTML = '<div></div>';\n        this.refreshHeader();\n    }\n\n    refreshHeader() {\n        const columns = this.datamanager.getColumns();\n\n        // refresh html\n        $('div', this.header).innerHTML = this.getHeaderHTML(columns);\n\n        this.$filterRow = $('.dt-row-filter', this.header);\n        if (this.$filterRow) {\n            $.style(this.$filterRow, { display: 'none' });\n        }\n        // reset columnMap\n        this.$columnMap = [];\n        this.bindMoveColumn();\n    }\n\n    getHeaderHTML(columns) {\n        let html = this.rowmanager.getRowHTML(columns, {\n            isHeader: 1\n        });\n        if (this.options.inlineFilters) {\n            html += this.rowmanager.getRowHTML(columns, {\n                isFilter: 1\n            });\n        }\n        return html;\n    }\n\n    bindEvents() {\n        this.bindDropdown();\n        this.bindResizeColumn();\n        this.bindPerfectColumnWidth();\n        this.bindFilter();\n    }\n\n    bindDropdown() {\n        let toggleClass = '.dt-dropdown__toggle';\n        let dropdownClass = '.dt-dropdown__list';\n\n        // attach the dropdown list to container\n        this.instance.dropdownContainer.innerHTML = this.getDropdownListHTML();\n        this.$dropdownList = this.instance.dropdownContainer.firstElementChild;\n\n        $.on(this.header, 'click', toggleClass, e => {\n            this.openDropdown(e);\n        });\n\n        const deactivateDropdownOnBodyClick = (e) => {\n            const selector = [\n                toggleClass, toggleClass + ' *',\n                dropdownClass, dropdownClass + ' *'\n            ].join(',');\n            if (e.target.matches(selector)) return;\n            deactivateDropdown();\n        };\n        $.on(document.body, 'click', deactivateDropdownOnBodyClick);\n        document.addEventListener('scroll', deactivateDropdown, true);\n\n        this.instance.on('onDestroy', () => {\n            $.off(document.body, 'click', deactivateDropdownOnBodyClick);\n            $.off(document, 'scroll', deactivateDropdown);\n        });\n\n        $.on(this.$dropdownList, 'click', '.dt-dropdown__list-item', (e, $item) => {\n            if (!this._dropdownActiveColIndex) return;\n            const dropdownItems = this.options.headerDropdown;\n            const { index } = $.data($item);\n            const colIndex = this._dropdownActiveColIndex;\n            let callback = dropdownItems[index].action;\n\n            callback && callback.call(this.instance, this.getColumn(colIndex));\n            this.hideDropdown();\n        });\n\n        const _this = this;\n        function deactivateDropdown(e) {\n            _this.hideDropdown();\n        }\n\n        this.hideDropdown();\n    }\n\n    openDropdown(e) {\n        if (!this._dropdownWidth) {\n            $.style(this.$dropdownList, { display: '' });\n            this._dropdownWidth = $.style(this.$dropdownList, 'width');\n        }\n        $.style(this.$dropdownList, {\n            display: '',\n            left: (e.clientX - this._dropdownWidth + 4) + 'px',\n            top: (e.clientY + 4) + 'px'\n        });\n        const $cell = $.closest('.dt-cell', e.target);\n        const { colIndex } = $.data($cell);\n        this._dropdownActiveColIndex = colIndex;\n    }\n\n    hideDropdown() {\n        $.style(this.$dropdownList, {\n            display: 'none'\n        });\n        this._dropdownActiveColIndex = null;\n    }\n\n    bindResizeColumn() {\n        let isDragging = false;\n        let $resizingCell, startWidth, startX;\n\n        $.on(this.header, 'mousedown', '.dt-cell .dt-cell__resize-handle', (e, $handle) => {\n            document.body.classList.add('dt-resize');\n            const $cell = $handle.parentNode.parentNode;\n            $resizingCell = $cell;\n            const {\n                colIndex\n            } = $.data($resizingCell);\n            const col = this.getColumn(colIndex);\n\n            if (col && col.resizable === false) {\n                return;\n            }\n\n            isDragging = true;\n            startWidth = $.style($('.dt-cell__content', $resizingCell), 'width');\n            startX = e.pageX;\n        });\n\n        const onMouseup = (e) => {\n            document.body.classList.remove('dt-resize');\n            if (!$resizingCell) return;\n            isDragging = false;\n\n            const {\n                colIndex\n            } = $.data($resizingCell);\n            this.setColumnWidth(colIndex);\n            this.style.setBodyStyle();\n            $resizingCell = null;\n        };\n        $.on(document.body, 'mouseup', onMouseup);\n        this.instance.on('onDestroy', () => {\n            $.off(document.body, 'mouseup', onMouseup);\n        });\n\n        const onMouseMove = (e) => {\n            if (!isDragging) return;\n            const finalWidth = startWidth + (e.pageX - startX);\n            const {\n                colIndex\n            } = $.data($resizingCell);\n\n            let columnMinWidth = this.options.minimumColumnWidth;\n            if (columnMinWidth > finalWidth) {\n                // don't resize past 30 pixels\n                return;\n            }\n            this.datamanager.updateColumn(colIndex, {\n                width: finalWidth\n            });\n            this.setColumnHeaderWidth(colIndex);\n        };\n        $.on(document.body, 'mousemove', onMouseMove);\n        this.instance.on('onDestroy', () => {\n            $.off(document.body, 'mousemove', onMouseMove);\n        });\n    }\n\n    bindPerfectColumnWidth() {\n        $.on(this.header, 'dblclick', '.dt-cell .dt-cell__resize-handle', (e, $handle) => {\n            const $cell = $handle.parentNode.parentNode;\n            const { colIndex } = $.data($cell);\n\n            let longestCell = this.bodyRenderer.visibleRows\n                .map(d => d[colIndex])\n                .reduce((acc, curr) => acc.content.length > curr.content.length ? acc : curr);\n\n            let $longestCellHTML = this.cellmanager.getCellHTML(longestCell);\n            let $div = document.createElement('div');\n            $div.innerHTML = $longestCellHTML;\n            let cellText = $div.querySelector('.dt-cell__content').textContent;\n\n            let {\n                borderLeftWidth,\n                borderRightWidth,\n                paddingLeft,\n                paddingRight\n            } = $.getStyle(this.bodyScrollable.querySelector('.dt-cell__content'));\n\n            let padding = [borderLeftWidth, borderRightWidth, paddingLeft, paddingRight]\n                .map(parseFloat)\n                .reduce((sum, val) => sum + val);\n\n            let width = $.measureTextWidth(cellText) + padding;\n            this.datamanager.updateColumn(colIndex, { width });\n            this.setColumnHeaderWidth(colIndex);\n            this.setColumnWidth(colIndex);\n        });\n    }\n\n    bindMoveColumn() {\n        const $parent = $('.dt-row', this.header);\n\n        this.sortable = Sortable.create($parent, {\n            onEnd: (e) => {\n                const {\n                    oldIndex,\n                    newIndex\n                } = e;\n                const $draggedCell = e.item;\n                const {\n                    colIndex\n                } = $.data($draggedCell);\n                if (+colIndex === newIndex) return;\n\n                this.switchColumn(oldIndex, newIndex);\n            },\n            preventOnFilter: false,\n            filter: '.dt-cell__resize-handle, .dt-dropdown',\n            chosenClass: 'dt-cell--dragging',\n            animation: 150\n        });\n    }\n\n    sortColumn(colIndex, nextSortOrder) {\n        this.instance.freeze();\n        this.sortRows(colIndex, nextSortOrder)\n            .then(() => {\n                this.refreshHeader();\n                return this.rowmanager.refreshRows();\n            })\n            .then(() => this.instance.unfreeze())\n            .then(() => {\n                this.fireEvent('onSortColumn', this.getColumn(colIndex));\n            });\n    }\n\n    removeColumn(colIndex) {\n        const removedCol = this.getColumn(colIndex);\n        this.instance.freeze();\n        this.datamanager.removeColumn(colIndex)\n            .then(() => {\n                this.refreshHeader();\n                return this.rowmanager.refreshRows();\n            })\n            .then(() => this.instance.unfreeze())\n            .then(() => {\n                this.fireEvent('onRemoveColumn', removedCol);\n            });\n    }\n\n    switchColumn(oldIndex, newIndex) {\n        this.instance.freeze();\n        this.datamanager.switchColumn(oldIndex, newIndex)\n            .then(() => {\n                this.refreshHeader();\n                return this.rowmanager.refreshRows();\n            })\n            .then(() => {\n                this.setColumnWidth(oldIndex);\n                this.setColumnWidth(newIndex);\n                this.instance.unfreeze();\n            })\n            .then(() => {\n                this.fireEvent('onSwitchColumn',\n                    this.getColumn(oldIndex), this.getColumn(newIndex)\n                );\n            });\n    }\n\n    toggleFilter(flag) {\n        if (!this.options.inlineFilters) return;\n\n        let showFilter;\n        if (flag === undefined) {\n            showFilter = !this.isFilterShown;\n        } else {\n            showFilter = flag;\n        }\n\n        if (showFilter) {\n            $.style(this.$filterRow, { display: '' });\n        } else {\n            $.style(this.$filterRow, { display: 'none' });\n        }\n\n        this.isFilterShown = showFilter;\n        this.style.setBodyStyle();\n    }\n\n    focusFilter(colIndex) {\n        if (!this.isFilterShown) return;\n\n        const $filterInput = $(`.dt-cell--col-${colIndex} .dt-filter`, this.$filterRow);\n        $filterInput.focus();\n    }\n\n    bindFilter() {\n        if (!this.options.inlineFilters) return;\n        const handler = e => {\n            this.applyFilter(this.getAppliedFilters());\n        };\n        $.on(this.header, 'keydown', '.dt-filter', debounce$1(handler, 300));\n    }\n\n    applyFilter(filters) {\n        this.datamanager.filterRows(filters)\n            .then(({\n                rowsToShow\n            }) => {\n                this.rowmanager.showRows(rowsToShow);\n            });\n    }\n\n    getAppliedFilters() {\n        const filters = {};\n        $.each('.dt-filter', this.header).map((input) => {\n            const value = input.value;\n            if (value) {\n                filters[input.dataset.colIndex] = value;\n            }\n        });\n        return filters;\n    }\n\n    applyDefaultSortOrder() {\n        // sort rows if any 1 column has a default sortOrder set\n        const columnsToSort = this.getColumns().filter(col => col.sortOrder !== 'none');\n\n        if (columnsToSort.length === 1) {\n            const column = columnsToSort[0];\n            this.sortColumn(column.colIndex, column.sortOrder);\n        }\n    }\n\n    sortRows(colIndex, sortOrder) {\n        return this.datamanager.sortRows(colIndex, sortOrder);\n    }\n\n    getColumn(colIndex) {\n        return this.datamanager.getColumn(colIndex);\n    }\n\n    getColumns() {\n        return this.datamanager.getColumns();\n    }\n\n    setColumnWidth(colIndex, width) {\n        colIndex = +colIndex;\n\n        let columnWidth = width || this.getColumn(colIndex).width;\n\n        const selector = [\n            `.dt-cell__content--col-${colIndex}`,\n            `.dt-cell__edit--col-${colIndex}`\n        ].join(', ');\n\n        const styles = {\n            width: columnWidth + 'px'\n        };\n\n        this.style.setStyle(selector, styles);\n    }\n\n    setColumnHeaderWidth(colIndex) {\n        colIndex = +colIndex;\n        this.$columnMap = this.$columnMap || [];\n        const selector = `.dt-cell__content--header-${colIndex}`;\n        const {\n            width\n        } = this.getColumn(colIndex);\n\n        let $column = this.$columnMap[colIndex];\n        if (!$column) {\n            $column = this.header.querySelector(selector);\n            this.$columnMap[colIndex] = $column;\n        }\n\n        $column.style.width = width + 'px';\n    }\n\n    getColumnMinWidth(colIndex) {\n        colIndex = +colIndex;\n        return this.getColumn(colIndex).minWidth || 24;\n    }\n\n    getFirstColumnIndex() {\n        return this.datamanager.getColumnIndexById('_rowIndex') + 1;\n    }\n\n    getHeaderCell$(colIndex) {\n        return $(`.dt-cell--header-${colIndex}`, this.header);\n    }\n\n    getLastColumnIndex() {\n        return this.datamanager.getColumnCount() - 1;\n    }\n\n    getDropdownHTML() {\n        const { dropdownButton } = this.options;\n\n        return `\n            <div class=\"dt-dropdown\">\n                <div class=\"dt-dropdown__toggle\">${dropdownButton}</div>\n            </div>\n      `;\n    }\n\n    getDropdownListHTML() {\n        const { headerDropdown: dropdownItems } = this.options;\n\n        return `\n            <div class=\"dt-dropdown__list\">\n            ${dropdownItems.map((d, i) => `\n                <div class=\"dt-dropdown__list-item\" data-index=\"${i}\">${d.label}</div>\n            `).join('')}\n            </div>\n        `;\n    }\n}\n\nclass RowManager {\n    constructor(instance) {\n        this.instance = instance;\n        linkProperties(this, this.instance, [\n            'options',\n            'fireEvent',\n            'wrapper',\n            'bodyScrollable',\n            'bodyRenderer',\n            'style'\n        ]);\n\n        this.bindEvents();\n        this.refreshRows = nextTick(this.refreshRows, this);\n    }\n\n    get datamanager() {\n        return this.instance.datamanager;\n    }\n\n    get cellmanager() {\n        return this.instance.cellmanager;\n    }\n\n    bindEvents() {\n        this.bindCheckbox();\n    }\n\n    bindCheckbox() {\n        if (!this.options.checkboxColumn) return;\n\n        // map of checked rows\n        this.checkMap = [];\n\n        $.on(this.wrapper, 'click', '.dt-cell--col-0 [type=\"checkbox\"]', (e, $checkbox) => {\n            const $cell = $checkbox.closest('.dt-cell');\n            const {\n                rowIndex,\n                isHeader\n            } = $.data($cell);\n            const checked = $checkbox.checked;\n\n            if (isHeader) {\n                this.checkAll(checked);\n            } else {\n                this.checkRow(rowIndex, checked);\n            }\n        });\n    }\n\n    refreshRows() {\n        this.instance.renderBody();\n        this.instance.setDimensions();\n    }\n\n    refreshRow(row, rowIndex) {\n        const _row = this.datamanager.updateRow(row, rowIndex);\n\n        _row.forEach(cell => {\n            this.cellmanager.refreshCell(cell);\n        });\n    }\n\n    getCheckedRows() {\n        if (!this.checkMap) {\n            return [];\n        }\n\n        let out = [];\n        for (let rowIndex in this.checkMap) {\n            const checked = this.checkMap[rowIndex];\n            if (checked === 1) {\n                out.push(rowIndex);\n            }\n        }\n\n        return out;\n    }\n\n    highlightCheckedRows() {\n        this.getCheckedRows()\n            .map(rowIndex => this.checkRow(rowIndex, true));\n    }\n\n    checkRow(rowIndex, toggle) {\n        const value = toggle ? 1 : 0;\n        const selector = rowIndex => `.dt-cell--0-${rowIndex} [type=\"checkbox\"]`;\n        // update internal map\n        this.checkMap[rowIndex] = value;\n        // set checkbox value explicitly\n        $.each(selector(rowIndex), this.bodyScrollable)\n            .map(input => {\n                input.checked = toggle;\n            });\n        // highlight row\n        this.highlightRow(rowIndex, toggle);\n        this.showCheckStatus();\n        this.fireEvent('onCheckRow', this.datamanager.getRow(rowIndex));\n    }\n\n    checkAll(toggle) {\n        const value = toggle ? 1 : 0;\n\n        // update internal map\n        if (toggle) {\n            this.checkMap = Array.from(Array(this.getTotalRows())).map(c => value);\n        } else {\n            this.checkMap = [];\n        }\n        // set checkbox value\n        $.each('.dt-cell--col-0 [type=\"checkbox\"]', this.bodyScrollable)\n            .map(input => {\n                input.checked = toggle;\n            });\n        // highlight all\n        this.highlightAll(toggle);\n        this.showCheckStatus();\n        this.fireEvent('onCheckRow');\n    }\n\n    showCheckStatus() {\n        if (!this.options.checkedRowStatus) return;\n        const checkedRows = this.getCheckedRows();\n        const count = checkedRows.length;\n        if (count > 0) {\n            this.bodyRenderer.showToastMessage(`${count} row${count > 1 ? 's' : ''} selected`);\n        } else {\n            this.bodyRenderer.clearToastMessage();\n        }\n    }\n\n    highlightRow(rowIndex, toggle = true) {\n        const $row = this.getRow$(rowIndex);\n        if (!$row) return;\n\n        if (!toggle && this.bodyScrollable.classList.contains('dt-scrollable--highlight-all')) {\n            $row.classList.add('dt-row--unhighlight');\n            return;\n        }\n\n        if (toggle && $row.classList.contains('dt-row--unhighlight')) {\n            $row.classList.remove('dt-row--unhighlight');\n        }\n\n        this._highlightedRows = this._highlightedRows || {};\n\n        if (toggle) {\n            $row.classList.add('dt-row--highlight');\n            this._highlightedRows[rowIndex] = $row;\n        } else {\n            $row.classList.remove('dt-row--highlight');\n            delete this._highlightedRows[rowIndex];\n        }\n    }\n\n    highlightAll(toggle = true) {\n        if (toggle) {\n            this.bodyScrollable.classList.add('dt-scrollable--highlight-all');\n        } else {\n            this.bodyScrollable.classList.remove('dt-scrollable--highlight-all');\n            for (const rowIndex in this._highlightedRows) {\n                const $row = this._highlightedRows[rowIndex];\n                $row.classList.remove('dt-row--highlight');\n            }\n            this._highlightedRows = {};\n        }\n    }\n\n    showRows(rowIndices) {\n        rowIndices = ensureArray(rowIndices);\n        const rows = rowIndices.map(rowIndex => this.datamanager.getRow(rowIndex));\n        this.bodyRenderer.renderRows(rows);\n    }\n\n    showAllRows() {\n        const rowIndices = this.datamanager.getAllRowIndices();\n        this.showRows(rowIndices);\n    }\n\n    getChildrenToShowForNode(rowIndex) {\n        const row = this.datamanager.getRow(rowIndex);\n        row.meta.isTreeNodeClose = false;\n\n        return this.datamanager.getImmediateChildren(rowIndex);\n    }\n\n    openSingleNode(rowIndex) {\n        const childrenToShow = this.getChildrenToShowForNode(rowIndex);\n        const visibleRowIndices = this.bodyRenderer.visibleRowIndices;\n        const rowsToShow = uniq$1([...childrenToShow, ...visibleRowIndices]).sort(numberSortAsc);\n\n        this.showRows(rowsToShow);\n    }\n\n    getChildrenToHideForNode(rowIndex) {\n        const row = this.datamanager.getRow(rowIndex);\n        row.meta.isTreeNodeClose = true;\n\n        const rowsToHide = this.datamanager.getChildren(rowIndex);\n        rowsToHide.forEach(rowIndex => {\n            const row = this.datamanager.getRow(rowIndex);\n            if (!row.meta.isLeaf) {\n                row.meta.isTreeNodeClose = true;\n            }\n        });\n\n        return rowsToHide;\n    }\n\n    closeSingleNode(rowIndex) {\n        const rowsToHide = this.getChildrenToHideForNode(rowIndex);\n        const visibleRows = this.bodyRenderer.visibleRowIndices;\n        const rowsToShow = visibleRows\n            .filter(rowIndex => !rowsToHide.includes(rowIndex))\n            .sort(numberSortAsc);\n\n        this.showRows(rowsToShow);\n    }\n\n    expandAllNodes() {\n        let rows = this.datamanager.getRows();\n        let rootNodes = rows.filter(row => !row.meta.isLeaf);\n\n        const childrenToShow = rootNodes.map(row => this.getChildrenToShowForNode(row.meta.rowIndex)).flat();\n        const visibleRowIndices = this.bodyRenderer.visibleRowIndices;\n        const rowsToShow = uniq$1([...childrenToShow, ...visibleRowIndices]).sort(numberSortAsc);\n\n        this.showRows(rowsToShow);\n    }\n\n    collapseAllNodes() {\n        let rows = this.datamanager.getRows();\n        let rootNodes = rows.filter(row => row.meta.indent === 0);\n\n        const rowsToHide = rootNodes.map(row => this.getChildrenToHideForNode(row.meta.rowIndex)).flat();\n        const visibleRows = this.bodyRenderer.visibleRowIndices;\n        const rowsToShow = visibleRows\n            .filter(rowIndex => !rowsToHide.includes(rowIndex))\n            .sort(numberSortAsc);\n\n        this.showRows(rowsToShow);\n    }\n\n    setTreeDepth(depth) {\n        let rows = this.datamanager.getRows();\n\n        const rowsToOpen = rows.filter(row => row.meta.indent < depth);\n        const rowsToClose = rows.filter(row => row.meta.indent >= depth);\n        const rowsToHide = rowsToClose.filter(row => row.meta.indent > depth);\n\n        rowsToClose.forEach(row => {\n            if (!row.meta.isLeaf) {\n                row.meta.isTreeNodeClose = true;\n            }\n        });\n        rowsToOpen.forEach(row => {\n            if (!row.meta.isLeaf) {\n                row.meta.isTreeNodeClose = false;\n            }\n        });\n\n        const rowsToShow = rows\n            .filter(row => !rowsToHide.includes(row))\n            .map(row => row.meta.rowIndex)\n            .sort(numberSortAsc);\n        this.showRows(rowsToShow);\n    }\n\n    getRow$(rowIndex) {\n        return $(this.selector(rowIndex), this.bodyScrollable);\n    }\n\n    getTotalRows() {\n        return this.datamanager.getRowCount();\n    }\n\n    getFirstRowIndex() {\n        return 0;\n    }\n\n    getLastRowIndex() {\n        return this.datamanager.getRowCount() - 1;\n    }\n\n    scrollToRow(rowIndex) {\n        rowIndex = +rowIndex;\n        this._lastScrollTo = this._lastScrollTo || 0;\n        const $row = this.getRow$(rowIndex);\n        if ($.inViewport($row, this.bodyScrollable)) return;\n\n        const {\n            height\n        } = $row.getBoundingClientRect();\n        const {\n            top,\n            bottom\n        } = this.bodyScrollable.getBoundingClientRect();\n        const rowsInView = Math.floor((bottom - top) / height);\n\n        let offset = 0;\n        if (rowIndex > this._lastScrollTo) {\n            offset = height * ((rowIndex + 1) - rowsInView);\n        } else {\n            offset = height * ((rowIndex + 1) - 1);\n        }\n\n        this._lastScrollTo = rowIndex;\n        $.scrollTop(this.bodyScrollable, offset);\n    }\n\n    getRowHTML(row, props) {\n        const dataAttr = makeDataAttributeString(props);\n        let rowIdentifier = props.rowIndex;\n\n        if (props.isFilter) {\n            row = row.map(cell => (Object.assign({}, cell, {\n                content: this.getFilterInput({\n                    colIndex: cell.colIndex\n                }),\n                isFilter: 1,\n                isHeader: undefined,\n                editable: false\n            })));\n\n            rowIdentifier = 'filter';\n        }\n\n        if (props.isHeader) {\n            rowIdentifier = 'header';\n        }\n\n        return `\n            <div class=\"dt-row dt-row-${rowIdentifier}\" ${dataAttr}>\n                ${row.map(cell => this.cellmanager.getCellHTML(cell)).join('')}\n            </div>\n        `;\n    }\n\n    getFilterInput(props) {\n        const dataAttr = makeDataAttributeString(props);\n        return `<input class=\"dt-filter dt-input\" type=\"text\" ${dataAttr} tabindex=\"1\" />`;\n    }\n\n    selector(rowIndex) {\n        return `.dt-row-${rowIndex}`;\n    }\n}\n\nvar hyperlist = createCommonjsModule(function (module, exports) {\n(function(f){{module.exports=f();}})(function(){return (function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof commonjsRequire==\"function\"&&commonjsRequire;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error(\"Cannot find module '\"+o+\"'\");throw f.code=\"MODULE_NOT_FOUND\",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r);}return n[o].exports}var i=typeof commonjsRequire==\"function\"&&commonjsRequire;for(var o=0;o<r.length;o++)s(r[o]);return s})({1:[function(_dereq_,module,exports){\n\n// Default configuration.\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nvar defaultConfig = {\n  width: '100%',\n  height: '100%'\n};\n\n// Check for valid number.\nvar isNumber = function isNumber(input) {\n  return Number(input) === Number(input);\n};\n\n/**\n * Creates a HyperList instance that virtually scrolls very large amounts of\n * data effortlessly.\n */\n\nvar HyperList = function () {\n  _createClass(HyperList, null, [{\n    key: 'create',\n    value: function create(element, userProvidedConfig) {\n      return new HyperList(element, userProvidedConfig);\n    }\n\n    /**\n     * Merge given css style on an element\n     * @param {DOMElement} element\n     * @param {Object} style\n     */\n\n  }, {\n    key: 'mergeStyle',\n    value: function mergeStyle(element, style) {\n      for (var i in style) {\n        if (element.style[i] !== style[i]) {\n          element.style[i] = style[i];\n        }\n      }\n    }\n  }, {\n    key: 'getMaxBrowserHeight',\n    value: function getMaxBrowserHeight() {\n      // Create two elements, the wrapper is `1px` tall and is transparent and\n      // positioned at the top of the page. Inside that is an element that gets\n      // set to 1 billion pixels. Then reads the max height the browser can\n      // calculate.\n      var wrapper = document.createElement('div');\n      var fixture = document.createElement('div');\n\n      // As said above, these values get set to put the fixture elements into the\n      // right visual state.\n      HyperList.mergeStyle(wrapper, { position: 'absolute', height: '1px', opacity: 0 });\n      HyperList.mergeStyle(fixture, { height: '1e7px' });\n\n      // Add the fixture into the wrapper element.\n      wrapper.appendChild(fixture);\n\n      // Apply to the page, the values won't kick in unless this is attached.\n      document.body.appendChild(wrapper);\n\n      // Get the maximum element height in pixels.\n      var maxElementHeight = fixture.offsetHeight;\n\n      // Remove the element immediately after reading the value.\n      document.body.removeChild(wrapper);\n\n      return maxElementHeight;\n    }\n  }]);\n\n  function HyperList(element, userProvidedConfig) {\n    var _this = this;\n\n    _classCallCheck(this, HyperList);\n\n    this._config = {};\n    this._lastRepaint = null;\n    this._maxElementHeight = HyperList.getMaxBrowserHeight();\n\n    this.refresh(element, userProvidedConfig);\n\n    var config = this._config;\n\n    // Create internal render loop.\n    var render = function render() {\n      var scrollTop = _this._getScrollPosition();\n      var lastRepaint = _this._lastRepaint;\n\n      _this._renderAnimationFrame = window.requestAnimationFrame(render);\n\n      if (scrollTop === lastRepaint) {\n        return;\n      }\n\n      if (!lastRepaint || Math.abs(scrollTop - lastRepaint) > _this._averageHeight) {\n        var rendered = _this._renderChunk();\n\n        _this._lastRepaint = scrollTop;\n\n        if (rendered !== false && typeof config.afterRender === 'function') {\n          config.afterRender();\n        }\n      }\n    };\n\n    render();\n  }\n\n  _createClass(HyperList, [{\n    key: 'destroy',\n    value: function destroy() {\n      window.cancelAnimationFrame(this._renderAnimationFrame);\n    }\n  }, {\n    key: 'refresh',\n    value: function refresh(element, userProvidedConfig) {\n      var _this2 = this;\n\n      Object.assign(this._config, defaultConfig, userProvidedConfig);\n\n      if (!element || element.nodeType !== 1) {\n        throw new Error('HyperList requires a valid DOM Node container');\n      }\n\n      this._element = element;\n\n      var config = this._config;\n\n      var scroller = this._scroller || config.scroller || document.createElement(config.scrollerTagName || 'tr');\n\n      // Default configuration option `useFragment` to `true`.\n      if (typeof config.useFragment !== 'boolean') {\n        this._config.useFragment = true;\n      }\n\n      if (!config.generate) {\n        throw new Error('Missing required `generate` function');\n      }\n\n      if (!isNumber(config.total)) {\n        throw new Error('Invalid required `total` value, expected number');\n      }\n\n      if (!Array.isArray(config.itemHeight) && !isNumber(config.itemHeight)) {\n        throw new Error('\\n        Invalid required `itemHeight` value, expected number or array\\n      '.trim());\n      } else if (isNumber(config.itemHeight)) {\n        this._itemHeights = Array(config.total).fill(config.itemHeight);\n      } else {\n        this._itemHeights = config.itemHeight;\n      }\n\n      // Width and height should be coerced to string representations. Either in\n      // `%` or `px`.\n      Object.keys(defaultConfig).filter(function (prop) {\n        return prop in config;\n      }).forEach(function (prop) {\n        var value = config[prop];\n        var isValueNumber = isNumber(value);\n        var isValuePercent = isValueNumber ? false : value.slice(-1) === '%';\n\n        if (value && typeof value !== 'string' && typeof value !== 'number') {\n          var msg = 'Invalid optional `' + prop + '`, expected string or number';\n          throw new Error(msg);\n        } else if (isValueNumber) {\n          config[prop] = value + 'px';\n        }\n\n        if (prop !== 'height') {\n          return;\n        }\n\n        // Compute the containerHeight as number\n        var numberValue = isValueNumber ? value : parseInt(value.replace(/px|%/, ''), 10);\n\n        if (isValuePercent) {\n          _this2._containerHeight = window.innerHeight * numberValue / 100;\n        } else {\n          _this2._containerHeight = isNumber(value) ? value : numberValue;\n        }\n      });\n\n      // Decorate the container element with styles that will match\n      // the user supplied configuration.\n      var elementStyle = {\n        width: '' + config.width,\n        height: '' + config.height,\n        overflow: 'auto',\n        position: 'relative'\n      };\n\n      HyperList.mergeStyle(element, elementStyle);\n\n      var scrollerHeight = config.itemHeight * config.total;\n      var maxElementHeight = this._maxElementHeight;\n\n      if (scrollerHeight > maxElementHeight) {\n        console.warn(['HyperList: The maximum element height', maxElementHeight + 'px has', 'been exceeded; please reduce your item height.'].join(' '));\n      }\n\n      var scrollerStyle = {\n        opacity: '0',\n        position: 'absolute',\n        width: '1px',\n        height: scrollerHeight + 'px'\n      };\n\n      HyperList.mergeStyle(scroller, scrollerStyle);\n\n      // Only append the scroller element once.\n      if (!this._scroller) {\n        element.appendChild(scroller);\n      }\n\n      // Set the scroller instance.\n      this._scroller = scroller;\n      this._scrollHeight = this._computeScrollHeight();\n\n      // Reuse the item positions if refreshed, otherwise set to empty array.\n      this._itemPositions = this._itemPositions || Array(config.total).fill(0);\n\n      // Each index in the array should represent the position in the DOM.\n      this._computePositions(0);\n\n      // Render after refreshing. Force render if we're calling refresh manually.\n      this._renderChunk(this._lastRepaint !== null);\n\n      if (typeof config.afterRender === 'function') {\n        config.afterRender();\n      }\n    }\n  }, {\n    key: '_getRow',\n    value: function _getRow(i) {\n      var config = this._config;\n      var item = config.generate(i);\n      var height = item.height;\n\n      if (height !== undefined && isNumber(height)) {\n        item = item.element;\n\n        // The height isn't the same as predicted, compute positions again\n        if (height !== this._itemHeights) {\n          this._itemHeights[i] = height;\n          this._computePositions(i);\n          this._scrollHeight = this._computeScrollHeight(i);\n        }\n      } else {\n        height = this._itemHeights[i];\n      }\n\n      if (!item || item.nodeType !== 1) {\n        throw new Error('Generator did not return a DOM Node for index: ' + i);\n      }\n\n      var oldClass = item.getAttribute('class') || '';\n      item.setAttribute('class', oldClass + ' ' + (config.rowClassName || 'vrow'));\n\n      var top = this._itemPositions[i];\n\n      HyperList.mergeStyle(item, {\n        position: 'absolute',\n        top: top + 'px'\n      });\n\n      return item;\n    }\n  }, {\n    key: '_getScrollPosition',\n    value: function _getScrollPosition() {\n      var config = this._config;\n\n      if (typeof config.overrideScrollPosition === 'function') {\n        return config.overrideScrollPosition();\n      }\n\n      return this._element.scrollTop;\n    }\n  }, {\n    key: '_renderChunk',\n    value: function _renderChunk(force) {\n      var config = this._config;\n      var element = this._element;\n      var scrollTop = this._getScrollPosition();\n      var total = config.total;\n\n      var from = config.reverse ? this._getReverseFrom(scrollTop) : this._getFrom(scrollTop) - 1;\n\n      if (from < 0 || from - this._screenItemsLen < 0) {\n        from = 0;\n      }\n\n      if (!force && this._lastFrom === from) {\n        return false;\n      }\n\n      this._lastFrom = from;\n\n      var to = from + this._cachedItemsLen;\n\n      if (to > total || to + this._cachedItemsLen > total) {\n        to = total;\n      }\n\n      // Append all the new rows in a document fragment that we will later append\n      // to the parent node\n      var fragment = config.useFragment ? document.createDocumentFragment() : []\n      // Sometimes you'll pass fake elements to this tool and Fragments require\n      // real elements.\n\n\n      // The element that forces the container to scroll.\n      ;var scroller = this._scroller;\n\n      // Keep the scroller in the list of children.\n      fragment[config.useFragment ? 'appendChild' : 'push'](scroller);\n\n      for (var i = from; i < to; i++) {\n        var row = this._getRow(i);\n\n        fragment[config.useFragment ? 'appendChild' : 'push'](row);\n      }\n\n      if (config.applyPatch) {\n        return config.applyPatch(element, fragment);\n      }\n\n      element.innerHTML = '';\n      element.appendChild(fragment);\n    }\n  }, {\n    key: '_computePositions',\n    value: function _computePositions() {\n      var from = arguments.length <= 0 || arguments[0] === undefined ? 1 : arguments[0];\n\n      var config = this._config;\n      var total = config.total;\n      var reverse = config.reverse;\n\n      if (from < 1 && !reverse) {\n        from = 1;\n      }\n\n      for (var i = from; i < total; i++) {\n        if (reverse) {\n          if (i === 0) {\n            this._itemPositions[0] = this._scrollHeight - this._itemHeights[0];\n          } else {\n            this._itemPositions[i] = this._itemPositions[i - 1] - this._itemHeights[i];\n          }\n        } else {\n          this._itemPositions[i] = this._itemHeights[i - 1] + this._itemPositions[i - 1];\n        }\n      }\n    }\n  }, {\n    key: '_computeScrollHeight',\n    value: function _computeScrollHeight() {\n      var _this3 = this;\n\n      var config = this._config;\n      var total = config.total;\n      var scrollHeight = this._itemHeights.reduce(function (a, b) {\n        return a + b;\n      }, 0);\n\n      HyperList.mergeStyle(this._scroller, {\n        opacity: 0,\n        position: 'absolute',\n        width: '1px',\n        height: scrollHeight + 'px'\n      });\n\n      // Calculate the height median\n      var sortedItemHeights = this._itemHeights.slice(0).sort(function (a, b) {\n        return a - b;\n      });\n      var middle = Math.floor(total / 2);\n      var averageHeight = total % 2 === 0 ? (sortedItemHeights[middle] + sortedItemHeights[middle - 1]) / 2 : sortedItemHeights[middle];\n\n      var containerHeight = this._element.clientHeight ? this._element.clientHeight : this._containerHeight;\n      this._screenItemsLen = Math.ceil(containerHeight / averageHeight);\n      this._containerHeight = containerHeight;\n\n      // Cache 3 times the number of items that fit in the container viewport.\n      this._cachedItemsLen = Math.max(this._cachedItemsLen || 0, this._screenItemsLen * 3);\n      this._averageHeight = averageHeight;\n\n      if (config.reverse) {\n        window.requestAnimationFrame(function () {\n          _this3._element.scrollTop = scrollHeight;\n        });\n      }\n\n      return scrollHeight;\n    }\n  }, {\n    key: '_getFrom',\n    value: function _getFrom(scrollTop) {\n      var i = 0;\n\n      while (this._itemPositions[i] < scrollTop) {\n        i++;\n      }\n\n      return i;\n    }\n  }, {\n    key: '_getReverseFrom',\n    value: function _getReverseFrom(scrollTop) {\n      var i = this._config.total - 1;\n\n      while (i > 0 && this._itemPositions[i] < scrollTop + this._containerHeight) {\n        i--;\n      }\n\n      return i;\n    }\n  }]);\n\n  return HyperList;\n}();\n\nexports.default = HyperList;\nmodule.exports = exports['default'];\n\n},{}]},{},[1])(1)\n});\n});\n\nvar HyperList = unwrapExports(hyperlist);\n\nclass BodyRenderer {\n    constructor(instance) {\n        this.instance = instance;\n        this.options = instance.options;\n        this.datamanager = instance.datamanager;\n        this.rowmanager = instance.rowmanager;\n        this.cellmanager = instance.cellmanager;\n        this.bodyScrollable = instance.bodyScrollable;\n        this.footer = this.instance.footer;\n        this.log = instance.log;\n    }\n\n    renderRows(rows) {\n        this.visibleRows = rows;\n        this.visibleRowIndices = rows.map(row => row.meta.rowIndex);\n\n        const rowViewOrder = this.datamanager.rowViewOrder.map(index => {\n            if (this.visibleRowIndices.includes(index)) {\n                return index;\n            }\n            return null;\n        }).filter(index => index !== null);\n\n        const computedStyle = getComputedStyle(this.bodyScrollable);\n\n        let config = {\n            width: computedStyle.width,\n            height: computedStyle.height,\n            itemHeight: this.options.cellHeight,\n            total: rows.length,\n            generate: (index) => {\n                const el = document.createElement('div');\n                const rowIndex = rowViewOrder[index];\n                const row = this.datamanager.getRow(rowIndex);\n                const rowHTML = this.rowmanager.getRowHTML(row, row.meta);\n                el.innerHTML = rowHTML;\n                return el.children[0];\n            },\n            afterRender: () => {\n                this.restoreState();\n            }\n        };\n\n        if (!this.hyperlist) {\n            this.hyperlist = new HyperList(this.bodyScrollable, config);\n        } else {\n            this.hyperlist.refresh(this.bodyScrollable, config);\n        }\n\n        this.renderFooter();\n    }\n\n    render() {\n        const rows = this.datamanager.getRowsForView();\n        this.renderRows(rows);\n        // setDimensions requires atleast 1 row to exist in dom\n        this.instance.setDimensions();\n    }\n\n    renderFooter() {\n        if (!this.options.showTotalRow) return;\n\n        const totalRow = this.getTotalRow();\n        let html = this.rowmanager.getRowHTML(totalRow, { isTotalRow: 1, rowIndex: 'totalRow' });\n\n        this.footer.innerHTML = html;\n    }\n\n    getTotalRow() {\n        const columns = this.datamanager.getColumns();\n        const totalRowTemplate = columns.map(col => {\n            let content = null;\n            if (['_rowIndex', '_checkbox'].includes(col.id)) {\n                content = '';\n            }\n            return {\n                content,\n                isTotalRow: 1,\n                colIndex: col.colIndex,\n                column: col\n            };\n        });\n\n        const totalRow = totalRowTemplate.map((cell, i) => {\n            if (cell.content === '') return cell;\n\n            if (this.options.hooks.columnTotal) {\n                const columnValues = this.visibleRows.map(row => row[i].content);\n                const result = this.options.hooks.columnTotal.call(this.instance, columnValues, cell);\n                if (result != null) {\n                    cell.content = result;\n                    return cell;\n                }\n            }\n\n            cell.content = this.visibleRows.reduce((acc, prevRow) => {\n                const prevCell = prevRow[i];\n                if (typeof prevCell.content === 'number') {\n                    if (acc == null) acc = 0;\n                    return acc + prevCell.content;\n                }\n                return acc;\n            }, cell.content);\n\n            return cell;\n        });\n\n        return totalRow;\n    }\n\n    restoreState() {\n        this.rowmanager.highlightCheckedRows();\n        this.cellmanager.selectAreaOnClusterChanged();\n        this.cellmanager.focusCellOnClusterChanged();\n    }\n\n    showToastMessage(message, hideAfter) {\n        this.instance.toastMessage.innerHTML = this.getToastMessageHTML(message);\n\n        if (hideAfter) {\n            setTimeout(() => {\n                this.clearToastMessage();\n            }, hideAfter * 1000);\n        }\n    }\n\n    clearToastMessage() {\n        this.instance.toastMessage.innerHTML = '';\n    }\n\n    getNoDataHTML() {\n        return `<div class=\"dt-scrollable__no-data\">${this.options.noDataMessage}</div>`;\n    }\n\n    getToastMessageHTML(message) {\n        return `<span class=\"dt-toast__message\">${message}</span>`;\n    }\n}\n\nclass Style {\n    constructor(instance) {\n        this.instance = instance;\n\n        linkProperties(this, this.instance, [\n            'options', 'datamanager', 'columnmanager',\n            'header', 'footer', 'bodyScrollable', 'datatableWrapper',\n            'getColumn', 'bodyRenderer'\n        ]);\n\n        this.scopeClass = 'dt-instance-' + instance.constructor.instances;\n        instance.datatableWrapper.classList.add(this.scopeClass);\n\n        const styleEl = document.createElement('style');\n        instance.wrapper.insertBefore(styleEl, instance.datatableWrapper);\n        this.styleEl = styleEl;\n\n        this.bindResizeWindow();\n        this.bindScrollHeader();\n    }\n\n    get stylesheet() {\n        return this.styleEl.sheet;\n    }\n\n    bindResizeWindow() {\n        this.onWindowResize = this.onWindowResize.bind(this);\n        this.onWindowResize = throttle$1(this.onWindowResize, 300);\n\n        if (this.options.layout === 'fluid') {\n            $.on(window, 'resize', this.onWindowResize);\n        }\n    }\n\n    bindScrollHeader() {\n        this._settingHeaderPosition = false;\n\n        $.on(this.bodyScrollable, 'scroll', (e) => {\n            if (this._settingHeaderPosition) return;\n\n            this._settingHeaderPosition = true;\n\n            requestAnimationFrame(() => {\n                const { scrollLeft, scrollWidth, clientWidth } = e.target;\n\n                let left = this.options.direction === 'rtl' ? scrollWidth - clientWidth - scrollLeft : -scrollLeft;\n\n                $.style(this.header, {\n                    transform: `translateX(${left}px)`\n                });\n                $.style(this.footer, {\n                    transform: `translateX(${left}px)`\n                });\n                this._settingHeaderPosition = false;\n            });\n        });\n    }\n\n    onWindowResize() {\n        this.distributeRemainingWidth();\n        this.refreshColumnWidth();\n        this.setBodyStyle();\n    }\n\n    destroy() {\n        this.styleEl.remove();\n        $.off(window, 'resize', this.onWindowResize);\n    }\n\n    setStyle(selector, styleObject) {\n        if (selector.includes(',')) {\n            selector.split(',')\n                .map(s => s.trim())\n                .forEach(selector => {\n                    this.setStyle(selector, styleObject);\n                });\n            return;\n        }\n\n        selector = selector.trim();\n        if (!selector) return;\n\n        this._styleRulesMap = this._styleRulesMap || {};\n        const prefixedSelector = this._getPrefixedSelector(selector);\n\n        if (this._styleRulesMap[prefixedSelector]) {\n            this.removeStyle(selector);\n\n            // merge with old styleobject\n            styleObject = Object.assign({}, this._styleRulesMap[prefixedSelector], styleObject);\n        }\n\n        const styleString = this._getRuleString(styleObject);\n        const ruleString = `${prefixedSelector} { ${styleString} }`;\n\n        this._styleRulesMap[prefixedSelector] = styleObject;\n        this.stylesheet.insertRule(ruleString);\n    }\n\n    removeStyle(selector) {\n        if (selector.includes(',')) {\n            selector.split(',')\n                .map(s => s.trim())\n                .forEach(selector => {\n                    this.removeStyle(selector);\n                });\n            return;\n        }\n\n        selector = selector.trim();\n        if (!selector) return;\n\n        // find and remove\n        const prefixedSelector = this._getPrefixedSelector(selector);\n        const index = Array.from(this.stylesheet.cssRules)\n            .findIndex(rule => rule.selectorText === prefixedSelector);\n\n        if (index === -1) return;\n        this.stylesheet.deleteRule(index);\n    }\n\n    _getPrefixedSelector(selector) {\n        return `.${this.scopeClass} ${selector}`;\n    }\n\n    _getRuleString(styleObject) {\n        return Object.keys(styleObject)\n            .map(prop => {\n                let dashed = prop;\n                if (!prop.includes('-')) {\n                    dashed = camelCaseToDash(prop);\n                }\n                return `${dashed}:${styleObject[prop]};`;\n            })\n            .join('');\n    }\n\n    setDimensions() {\n        this.setupMinWidth();\n        this.setupNaturalColumnWidth();\n        this.setupColumnWidth();\n        this.distributeRemainingWidth();\n        this.setColumnStyle();\n        this.setBodyStyle();\n    }\n\n    setupMinWidth() {\n        $.each('.dt-cell--header', this.header).map(col => {\n            const { colIndex } = $.data(col);\n            const column = this.getColumn(colIndex);\n\n            if (!column.minWidth) {\n                const width = $.style($('.dt-cell__content', col), 'width');\n                // only set this once\n                column.minWidth = width;\n            }\n        });\n    }\n\n    setupNaturalColumnWidth() {\n        if (!$('.dt-row')) return;\n\n        $.each('.dt-row-header .dt-cell', this.header).map($headerCell => {\n            const { colIndex } = $.data($headerCell);\n            const column = this.datamanager.getColumn(colIndex);\n            let width = $.style($('.dt-cell__content', $headerCell), 'width');\n            if (typeof width === 'number' && width >= this.options.minimumColumnWidth) {\n                column.naturalWidth = width;\n            } else {\n                column.naturalWidth = this.options.minimumColumnWidth;\n            }\n        });\n\n        // set initial width as naturally calculated by table's first row\n        $.each('.dt-row-0 .dt-cell', this.bodyScrollable).map($cell => {\n            const {\n                colIndex\n            } = $.data($cell);\n            const column = this.datamanager.getColumn(colIndex);\n\n            let naturalWidth = $.style($('.dt-cell__content', $cell), 'width');\n\n            if (column.id === '_rowIndex') {\n                naturalWidth = this.getRowIndexColumnWidth();\n                column.width = naturalWidth;\n            }\n\n            if (typeof naturalWidth === 'number' && naturalWidth >= column.naturalWidth) {\n                column.naturalWidth = naturalWidth;\n            } else {\n                column.naturalWidth = column.naturalWidth;\n            }\n        });\n    }\n\n    setupColumnWidth() {\n        if (this.options.layout === 'ratio') {\n            let totalWidth = $.style(this.datatableWrapper, 'width');\n\n            if (this.options.serialNoColumn) {\n                const rowIndexColumn = this.datamanager.getColumnById('_rowIndex');\n                totalWidth = totalWidth - rowIndexColumn.width - 1;\n            }\n\n            if (this.options.checkboxColumn) {\n                const rowIndexColumn = this.datamanager.getColumnById('_checkbox');\n                totalWidth = totalWidth - rowIndexColumn.width - 1;\n            }\n\n            const totalParts = this.datamanager.getColumns()\n                .map(column => {\n                    if (column.id === '_rowIndex' || column.id === '_checkbox') {\n                        return 0;\n                    }\n                    if (!column.width) {\n                        column.width = 1;\n                    }\n                    column.ratioWidth = parseInt(column.width, 10);\n                    return column.ratioWidth;\n                })\n                .reduce((a, c) => a + c);\n\n            const onePart = totalWidth / totalParts;\n\n            this.datamanager.getColumns()\n                .map(column => {\n                    if (column.id === '_rowIndex' || column.id === '_checkbox') return;\n                    column.width = Math.floor(onePart * column.ratioWidth) - 1;\n                });\n        } else {\n            this.datamanager.getColumns()\n                .map(column => {\n                    if (!column.width) {\n                        column.width = column.naturalWidth;\n                    }\n                    if (column.width < this.options.minimumColumnWidth) {\n                        column.width = this.options.minimumColumnWidth;\n                    }\n                });\n        }\n    }\n\n    distributeRemainingWidth() {\n        if (this.options.layout !== 'fluid') return;\n\n        const wrapperWidth = $.style(this.instance.datatableWrapper, 'width');\n        const firstRowWidth = $.style($('.dt-row', this.bodyScrollable), 'width');\n        const resizableColumns = this.datamanager.getColumns().filter(col => col.resizable);\n        const deltaWidth = (wrapperWidth - firstRowWidth) / resizableColumns.length;\n\n        resizableColumns.map(col => {\n            const width = $.style(this.getColumnHeaderElement(col.colIndex), 'width');\n            let finalWidth = Math.floor(width + deltaWidth) - 2;\n\n            this.datamanager.updateColumn(col.colIndex, {\n                width: finalWidth\n            });\n        });\n    }\n\n    setColumnStyle() {\n        // align columns\n        this.datamanager.getColumns()\n            .map(column => {\n                // alignment\n                if (!column.align) {\n                    column.align = 'left';\n                }\n                if (!['left', 'center', 'right'].includes(column.align)) {\n                    column.align = 'left';\n                }\n                this.setStyle(`.dt-cell--col-${column.colIndex}`, {\n                    'text-align': column.align\n                });\n\n                // width\n                this.columnmanager.setColumnHeaderWidth(column.colIndex);\n                this.columnmanager.setColumnWidth(column.colIndex);\n            });\n    }\n\n    refreshColumnWidth() {\n        this.datamanager.getColumns()\n            .map(column => {\n                this.columnmanager.setColumnHeaderWidth(column.colIndex);\n                this.columnmanager.setColumnWidth(column.colIndex);\n            });\n    }\n\n    setBodyStyle() {\n        const bodyWidth = $.style(this.datatableWrapper, 'width');\n        const firstRow = $('.dt-row', this.bodyScrollable);\n        const rowWidth = $.style(firstRow, 'width');\n\n        let width = bodyWidth > rowWidth ? rowWidth : bodyWidth;\n        $.style(this.bodyScrollable, {\n            width: width + 'px'\n        });\n\n        // remove the body height, so that it resets to it's original\n        $.removeStyle(this.bodyScrollable, 'height');\n\n        // when there are less rows than the container\n        // adapt the container height\n        let bodyHeight = $.getStyle(this.bodyScrollable, 'height');\n        const scrollHeight = (this.bodyRenderer.hyperlist || {})._scrollHeight || Infinity;\n        const hasHorizontalOverflow = $.hasHorizontalOverflow(this.bodyScrollable);\n\n        let height;\n\n        if (scrollHeight < bodyHeight) {\n            height = scrollHeight;\n\n            // account for scrollbar size when\n            // there is horizontal overflow\n            if (hasHorizontalOverflow) {\n                height += $.scrollbarSize();\n            }\n\n            $.style(this.bodyScrollable, {\n                height: height + 'px'\n            });\n        }\n\n        const verticalOverflow = this.bodyScrollable.scrollHeight - this.bodyScrollable.offsetHeight;\n        if (verticalOverflow < $.scrollbarSize()) {\n            // if verticalOverflow is less than scrollbar size\n            // then most likely scrollbar is causing the scroll\n            // which is not needed\n            $.style(this.bodyScrollable, {\n                overflowY: 'hidden'\n            });\n        }\n\n        if (this.options.layout === 'fluid') {\n            $.style(this.bodyScrollable, {\n                overflowX: 'hidden'\n            });\n        }\n    }\n\n    getColumnHeaderElement(colIndex) {\n        colIndex = +colIndex;\n        if (colIndex < 0) return null;\n        return $(`.dt-cell--col-${colIndex}`, this.header);\n    }\n\n    getRowIndexColumnWidth() {\n        const rowCount = this.datamanager.getRowCount();\n        const padding = 22;\n        return $.measureTextWidth(rowCount + '') + padding;\n    }\n}\n\nconst KEYCODES = {\n    13: 'enter',\n    91: 'meta',\n    16: 'shift',\n    17: 'ctrl',\n    18: 'alt',\n    37: 'left',\n    38: 'up',\n    39: 'right',\n    40: 'down',\n    9: 'tab',\n    27: 'esc',\n    67: 'c',\n    70: 'f',\n    86: 'v'\n};\n\nclass Keyboard {\n    constructor(element) {\n        this.listeners = {};\n        $.on(element, 'keydown', this.handler.bind(this));\n    }\n\n    handler(e) {\n        let key = KEYCODES[e.keyCode];\n\n        if (e.shiftKey && key !== 'shift') {\n            key = 'shift+' + key;\n        }\n\n        if ((e.ctrlKey && key !== 'ctrl') || (e.metaKey && key !== 'meta')) {\n            key = 'ctrl+' + key;\n        }\n\n        const listeners = this.listeners[key];\n\n        if (listeners && listeners.length > 0) {\n            for (let listener of listeners) {\n                const preventBubbling = listener(e);\n                if (preventBubbling === undefined || preventBubbling === true) {\n                    e.preventDefault();\n                }\n            }\n        }\n    }\n\n    on(key, listener) {\n        const keys = key.split(',').map(k => k.trim());\n\n        keys.map(key => {\n            this.listeners[key] = this.listeners[key] || [];\n            this.listeners[key].push(listener);\n        });\n    }\n}\n\nfunction filterRows(rows, filters) {\n    let filteredRowIndices = [];\n\n    if (Object.keys(filters).length === 0) {\n        return rows.map(row => row.meta.rowIndex);\n    }\n\n    for (let colIndex in filters) {\n        const keyword = filters[colIndex];\n\n        const filteredRows = filteredRowIndices.length ?\n            filteredRowIndices.map(i => rows[i]) :\n            rows;\n\n        const cells = filteredRows.map(row => row[colIndex]);\n\n        let filter = guessFilter(keyword);\n        let filterMethod = getFilterMethod(filter);\n\n        if (filterMethod) {\n            filteredRowIndices = filterMethod(filter.text, cells);\n        } else {\n            filteredRowIndices = cells.map(cell => cell.rowIndex);\n        }\n    }\n\n    return filteredRowIndices;\n}\nfunction getFilterMethod(filter) {\n    const stringCompareValue = cell =>\n        String(stripHTML(cell.html || '') || cell.content || '').toLowerCase();\n\n    const numberCompareValue = cell => parseFloat(cell.content);\n\n    const getCompareValues = (cell, keyword) => {\n        if (cell.column.compareValue) {\n            const compareValues = cell.column.compareValue(cell, keyword);\n            if (compareValues && Array.isArray(compareValues)) return compareValues;\n        }\n\n        // check if it can be converted to number\n        const float = numberCompareValue(cell);\n        if (!isNaN(float)) {\n            return [float, keyword];\n        }\n\n        return [stringCompareValue(cell), keyword];\n    };\n\n    let filterMethodMap = {\n        contains(keyword, cells) {\n            return cells\n                .filter(cell => {\n                    const hay = stringCompareValue(cell);\n                    const needle = (keyword || '').toLowerCase();\n                    return !needle || hay.includes(needle);\n                })\n                .map(cell => cell.rowIndex);\n        },\n\n        greaterThan(keyword, cells) {\n            return cells\n                .filter(cell => {\n                    const [compareValue, keywordValue] = getCompareValues(cell, keyword);\n                    return compareValue > keywordValue;\n                })\n                .map(cell => cell.rowIndex);\n        },\n\n        lessThan(keyword, cells) {\n            return cells\n                .filter(cell => {\n                    const [compareValue, keywordValue] = getCompareValues(cell, keyword);\n                    return compareValue < keywordValue;\n                })\n                .map(cell => cell.rowIndex);\n        },\n\n        equals(keyword, cells) {\n            return cells\n                .filter(cell => {\n                    const value = parseFloat(cell.content);\n                    return value === keyword;\n                })\n                .map(cell => cell.rowIndex);\n        },\n\n        notEquals(keyword, cells) {\n            return cells\n                .filter(cell => {\n                    const value = parseFloat(cell.content);\n                    return value !== keyword;\n                })\n                .map(cell => cell.rowIndex);\n        },\n\n        range(rangeValues, cells) {\n            return cells\n                .filter(cell => {\n                    const values1 = getCompareValues(cell, rangeValues[0]);\n                    const values2 = getCompareValues(cell, rangeValues[1]);\n                    const value = values1[0];\n                    return value >= values1[1] && value <= values2[1];\n                })\n                .map(cell => cell.rowIndex);\n        },\n\n        containsNumber(keyword, cells) {\n            return cells\n                .filter(cell => {\n                    const hay = numberCompareValue(cell);\n                    const needle = keyword;\n                    return !needle || hay.toString().includes(needle);\n                })\n                .map(cell => cell.rowIndex);\n        }\n    };\n\n    return filterMethodMap[filter.type];\n}\n\nfunction guessFilter(keyword = '') {\n    if (keyword.length === 0) return {};\n\n    let compareString = keyword;\n\n    if (['>', '<', '='].includes(compareString[0])) {\n        compareString = keyword.slice(1);\n    } else if (compareString.startsWith('!=')) {\n        compareString = keyword.slice(2);\n    }\n\n    if (keyword.startsWith('>')) {\n        if (compareString) {\n            return {\n                type: 'greaterThan',\n                text: compareString.trim()\n            };\n        }\n    }\n\n    if (keyword.startsWith('<')) {\n        if (compareString) {\n            return {\n                type: 'lessThan',\n                text: compareString.trim()\n            };\n        }\n    }\n\n    if (keyword.startsWith('=')) {\n        if (isNumber(compareString)) {\n            return {\n                type: 'equals',\n                text: Number(keyword.slice(1).trim())\n            };\n        }\n    }\n\n    if (isNumber(compareString)) {\n        return {\n            type: 'containsNumber',\n            text: parseFloat(keyword, 10)\n        };\n    }\n\n    if (keyword.startsWith('!=')) {\n        if (isNumber(compareString)) {\n            return {\n                type: 'notEquals',\n                text: Number(keyword.slice(2).trim())\n            };\n        }\n    }\n\n    if (keyword.split(':').length === 2) {\n        compareString = keyword.split(':');\n        return {\n            type: 'range',\n            text: compareString.map(v => v.trim())\n        };\n    }\n\n    return {\n        type: 'contains',\n        text: compareString.toLowerCase()\n    };\n}\n\nvar DEFAULT_OPTIONS = {\n    columns: [],\n    data: [],\n    dropdownButton: icons.chevronDown,\n    headerDropdown: [\n        {\n            label: 'Sort Ascending',\n            action: function (column) {\n                this.sortColumn(column.colIndex, 'asc');\n            }\n        },\n        {\n            label: 'Sort Descending',\n            action: function (column) {\n                this.sortColumn(column.colIndex, 'desc');\n            }\n        },\n        {\n            label: 'Reset sorting',\n            action: function (column) {\n                this.sortColumn(column.colIndex, 'none');\n            }\n        },\n        {\n            label: 'Remove column',\n            action: function (column) {\n                this.removeColumn(column.colIndex);\n            }\n        }\n    ],\n    events: {\n        onRemoveColumn(column) {},\n        onSwitchColumn(column1, column2) {},\n        onSortColumn(column) {},\n        onCheckRow(row) {},\n        onDestroy() {}\n    },\n    hooks: {\n        columnTotal: null\n    },\n    sortIndicator: {\n        asc: '↑',\n        desc: '↓',\n        none: ''\n    },\n    filterRows: filterRows,\n    freezeMessage: '',\n    getEditor: null,\n    serialNoColumn: true,\n    checkboxColumn: false,\n    clusterize: true,\n    logs: false,\n    layout: 'fixed', // fixed, fluid, ratio\n    noDataMessage: 'No Data',\n    cellHeight: 40,\n    minimumColumnWidth: 30,\n    inlineFilters: false,\n    treeView: false,\n    checkedRowStatus: true,\n    dynamicRowHeight: false,\n    pasteFromClipboard: false,\n    showTotalRow: false,\n    direction: 'ltr'\n};\n\nclass DataTable {\n    constructor(wrapper, options) {\n        DataTable.instances++;\n\n        if (typeof wrapper === 'string') {\n            // css selector\n            wrapper = document.querySelector(wrapper);\n        }\n        this.wrapper = wrapper;\n        if (!(this.wrapper instanceof HTMLElement)) {\n            throw new Error('Invalid argument given for `wrapper`');\n        }\n\n        this.buildOptions(options);\n        this.prepare();\n\n        this.style = new Style(this);\n        this.keyboard = new Keyboard(this.wrapper);\n        this.datamanager = new DataManager(this.options);\n        this.rowmanager = new RowManager(this);\n        this.columnmanager = new ColumnManager(this);\n        this.cellmanager = new CellManager(this);\n        this.bodyRenderer = new BodyRenderer(this);\n\n        if (this.options.data) {\n            this.refresh();\n            this.columnmanager.applyDefaultSortOrder();\n        }\n    }\n\n    buildOptions(options) {\n        this.options = this.options || {};\n\n        this.options = Object.assign(\n            {}, DEFAULT_OPTIONS,\n            this.options || {}, options\n        );\n\n        options.headerDropdown = options.headerDropdown || [];\n        this.options.headerDropdown = [\n            ...DEFAULT_OPTIONS.headerDropdown,\n            ...options.headerDropdown\n        ];\n\n        // custom user events\n        this.events = Object.assign(\n            {}, DEFAULT_OPTIONS.events,\n            this.options.events || {},\n            options.events || {}\n        );\n        this.fireEvent = this.fireEvent.bind(this);\n    }\n\n    prepare() {\n        this.prepareDom();\n        this.unfreeze();\n    }\n\n    prepareDom() {\n        this.wrapper.innerHTML = `\n            <div class=\"datatable\" dir=\"${this.options.direction}\">\n                <div class=\"dt-header\"></div>\n                <div class=\"dt-scrollable\"></div>\n                <div class=\"dt-footer\"></div>\n                <div class=\"dt-freeze\">\n                    <span class=\"dt-freeze__message\">\n                        ${this.options.freezeMessage}\n                    </span>\n                </div>\n                <div class=\"dt-toast\"></div>\n                <div class=\"dt-dropdown-container\"></div>\n                <textarea class=\"dt-paste-target\"></textarea>\n            </div>\n        `;\n\n        this.datatableWrapper = $('.datatable', this.wrapper);\n        this.header = $('.dt-header', this.wrapper);\n        this.footer = $('.dt-footer', this.wrapper);\n        this.bodyScrollable = $('.dt-scrollable', this.wrapper);\n        this.freezeContainer = $('.dt-freeze', this.wrapper);\n        this.toastMessage = $('.dt-toast', this.wrapper);\n        this.pasteTarget = $('.dt-paste-target', this.wrapper);\n        this.dropdownContainer = $('.dt-dropdown-container', this.wrapper);\n    }\n\n    refresh(data, columns) {\n        this.datamanager.init(data, columns);\n        this.render();\n        this.setDimensions();\n    }\n\n    destroy() {\n        this.wrapper.innerHTML = '';\n        this.style.destroy();\n        this.fireEvent('onDestroy');\n    }\n\n    appendRows(rows) {\n        this.datamanager.appendRows(rows);\n        this.rowmanager.refreshRows();\n    }\n\n    refreshRow(row, rowIndex) {\n        this.rowmanager.refreshRow(row, rowIndex);\n    }\n\n    render() {\n        this.renderHeader();\n        this.renderBody();\n    }\n\n    renderHeader() {\n        this.columnmanager.renderHeader();\n    }\n\n    renderBody() {\n        this.bodyRenderer.render();\n    }\n\n    setDimensions() {\n        this.style.setDimensions();\n    }\n\n    showToastMessage(message, hideAfter) {\n        this.bodyRenderer.showToastMessage(message, hideAfter);\n    }\n\n    clearToastMessage() {\n        this.bodyRenderer.clearToastMessage();\n    }\n\n    getColumn(colIndex) {\n        return this.datamanager.getColumn(colIndex);\n    }\n\n    getColumns() {\n        return this.datamanager.getColumns();\n    }\n\n    getRows() {\n        return this.datamanager.getRows();\n    }\n\n    getCell(colIndex, rowIndex) {\n        return this.datamanager.getCell(colIndex, rowIndex);\n    }\n\n    getColumnHeaderElement(colIndex) {\n        return this.columnmanager.getColumnHeaderElement(colIndex);\n    }\n\n    getViewportHeight() {\n        if (!this.viewportHeight) {\n            this.viewportHeight = $.style(this.bodyScrollable, 'height');\n        }\n\n        return this.viewportHeight;\n    }\n\n    sortColumn(colIndex, sortOrder) {\n        this.columnmanager.sortColumn(colIndex, sortOrder);\n    }\n\n    removeColumn(colIndex) {\n        this.columnmanager.removeColumn(colIndex);\n    }\n\n    scrollToLastColumn() {\n        this.datatableWrapper.scrollLeft = 9999;\n    }\n\n    freeze() {\n        $.style(this.freezeContainer, {\n            display: ''\n        });\n    }\n\n    unfreeze() {\n        $.style(this.freezeContainer, {\n            display: 'none'\n        });\n    }\n\n    updateOptions(options) {\n        this.buildOptions(options);\n    }\n\n    fireEvent(eventName, ...args) {\n        // fire internalEventHandlers if any\n        // and then user events\n        const handlers = [\n            ...(this._internalEventHandlers[eventName] || []),\n            this.events[eventName]\n        ].filter(Boolean);\n\n        for (let handler of handlers) {\n            handler.apply(this, args);\n        }\n    }\n\n    on(event, handler) {\n        this._internalEventHandlers = this._internalEventHandlers || {};\n        this._internalEventHandlers[event] = this._internalEventHandlers[event] || [];\n        this._internalEventHandlers[event].push(handler);\n    }\n\n    log() {\n        if (this.options.logs) {\n            console.log.apply(console, arguments);\n        }\n    }\n}\n\nDataTable.instances = 0;\n\nvar name = \"frappe-datatable\";\nvar version = \"0.0.0-development\";\nvar description = \"A modern datatable library for the web\";\nvar main = \"dist/frappe-datatable.cjs.js\";\nvar unpkg = \"dist/frappe-datatable.min.js\";\nvar jsdelivr = \"dist/frappe-datatable.min.js\";\nvar scripts = {\"start\":\"yarn run dev\",\"build\":\"rollup -c && NODE_ENV=production rollup -c\",\"dev\":\"rollup -c -w\",\"cy:server\":\"http-server -p 8989\",\"cy:open\":\"cypress open\",\"cy:run\":\"cypress run\",\"test\":\"start-server-and-test cy:server http://localhost:8989 cy:run\",\"test-local\":\"start-server-and-test cy:server http://localhost:8989 cy:open\",\"travis-deploy-once\":\"travis-deploy-once\",\"semantic-release\":\"semantic-release\",\"lint\":\"eslint src\",\"commit\":\"npx git-cz\"};\nvar files = [\"dist\",\"src\"];\nvar devDependencies = {\"autoprefixer\":\"^9.0.0\",\"chai\":\"3.5.0\",\"cypress\":\"3.0.1\",\"cz-conventional-changelog\":\"^2.1.0\",\"deepmerge\":\"^2.0.1\",\"eslint\":\"^5.0.1\",\"eslint-config-airbnb\":\"^16.1.0\",\"eslint-config-airbnb-base\":\"^12.1.0\",\"eslint-plugin-import\":\"^2.11.0\",\"http-server\":\"^0.11.1\",\"mocha\":\"3.3.0\",\"postcss-custom-properties\":\"^7.0.0\",\"postcss-nested\":\"^3.0.0\",\"rollup\":\"^0.59.4\",\"rollup-plugin-commonjs\":\"^8.3.0\",\"rollup-plugin-eslint\":\"^4.0.0\",\"rollup-plugin-json\":\"^2.3.0\",\"rollup-plugin-node-resolve\":\"^3.0.3\",\"rollup-plugin-postcss\":\"^1.2.8\",\"rollup-plugin-uglify-es\":\"^0.0.1\",\"semantic-release\":\"^15.6.3\",\"start-server-and-test\":\"^1.4.1\",\"travis-deploy-once\":\"^5.0.1\"};\nvar repository = {\"type\":\"git\",\"url\":\"https://github.com/frappe/datatable.git\"};\nvar keywords = [\"datatable\",\"data\",\"grid\",\"table\"];\nvar author = \"Faris Ansari\";\nvar license = \"MIT\";\nvar bugs = {\"url\":\"https://github.com/frappe/datatable/issues\"};\nvar homepage = \"https://frappe.github.io/datatable\";\nvar dependencies = {\"hyperlist\":\"^1.0.0-beta\",\"lodash\":\"^4.17.5\",\"sortablejs\":\"^1.7.0\"};\nvar config = {\"commitizen\":{\"path\":\"cz-conventional-changelog\"}};\nvar packageJson = {\n\tname: name,\n\tversion: version,\n\tdescription: description,\n\tmain: main,\n\tunpkg: unpkg,\n\tjsdelivr: jsdelivr,\n\tscripts: scripts,\n\tfiles: files,\n\tdevDependencies: devDependencies,\n\trepository: repository,\n\tkeywords: keywords,\n\tauthor: author,\n\tlicense: license,\n\tbugs: bugs,\n\thomepage: homepage,\n\tdependencies: dependencies,\n\tconfig: config\n};\n\nDataTable.__version__ = packageJson.version;\n\nmodule.exports = DataTable;\n","/**\n * frappe.views.ReportView\n */\nimport DataTable from 'frappe-datatable';\n\nfrappe.provide('frappe.views');\n\nfrappe.views.ReportView = class ReportView extends frappe.views.ListView {\n\tget view_name() {\n\t\treturn 'Report';\n\t}\n\n\tsetup_defaults() {\n\t\tsuper.setup_defaults();\n\t\tthis.page_title = __('Report:') + ' ' + this.page_title;\n\t\tthis.menu_items = this.report_menu_items();\n\n\t\tconst route = frappe.get_route();\n\t\tif (route.length === 4) {\n\t\t\tthis.report_name = route[3];\n\t\t}\n\n\t\tthis.add_totals_row = this.view_user_settings.add_totals_row || 0;\n\n\t\tif (this.report_name) {\n\t\t\treturn this.get_report_doc()\n\t\t\t\t.then(doc => {\n\t\t\t\t\tthis.report_doc = doc;\n\t\t\t\t\tthis.report_doc.json = JSON.parse(this.report_doc.json);\n\n\t\t\t\t\tthis.filters = this.report_doc.json.filters;\n\t\t\t\t\tthis.order_by = this.report_doc.json.order_by;\n\t\t\t\t\tthis.add_totals_row = this.report_doc.json.add_totals_row;\n\t\t\t\t\tthis.page_title = this.report_name;\n\t\t\t\t\tthis.page_length = this.report_doc.json.page_length || 20;\n\t\t\t\t\tthis.order_by = this.report_doc.json.order_by || 'modified desc';\n\t\t\t\t});\n\t\t}\n\t}\n\n\tsetup_view() {\n\t\tthis.setup_columns();\n\t\tthis.bind_charts_button();\n\t\tsuper.setup_new_doc_event();\n\t}\n\n\tsetup_result_area() {\n\t\tsuper.setup_result_area();\n\t\tthis.$datatable_wrapper = $('<div class=\"datatable-wrapper\">');\n\t\tthis.$charts_wrapper = $('<div class=\"charts-wrapper\">');\n\t\tthis.$result.append(this.$charts_wrapper);\n\t\tthis.$result.append(this.$datatable_wrapper);\n\t}\n\n\tsetup_paging_area() {\n\t\tsuper.setup_paging_area();\n\t\tconst message = __('For comparison, use >5, <10 or =324. For ranges, use 5:10 (for values between 5 & 10).');\n\t\tthis.$paging_area.find('.level-left').append(\n\t\t\t`<p class=\"text-muted text-medium margin-left\">${message}</p>`\n\t\t)\n\t}\n\n\tsetup_sort_selector() {\n\t\tthis.sort_selector = new frappe.ui.SortSelector({\n\t\t\tparent: this.filter_area.$filter_list_wrapper,\n\t\t\tdoctype: this.doctype,\n\t\t\targs: this.order_by,\n\t\t\tonchange: this.on_sort_change.bind(this)\n\t\t});\n\t}\n\n\tbefore_refresh() {\n\t\tif (this.report_doc) {\n\t\t\t// don't parse frappe.route_options if this is a Custom Report\n\t\t\treturn Promise.resolve();\n\t\t}\n\t\treturn super.before_refresh();\n\t}\n\n\tafter_render() {\n\t\tif (this.report_doc) {\n\t\t\tthis.set_dirty_state_for_custom_report();\n\t\t} else {\n\t\t\tthis.save_report_settings();\n\t\t}\n\t}\n\n\tset_dirty_state_for_custom_report() {\n\t\tlet current_settings = {\n\t\t\tfilters: this.filter_area.get(),\n\t\t\tfields: this.fields,\n\t\t\torder_by: this.sort_selector.get_sql_string(),\n\t\t\tadd_totals_row: this.add_totals_row,\n\t\t\tpage_length: this.page_length,\n\t\t\tcolumn_widths: this.get_column_widths()\n\t\t}\n\n\t\tlet report_settings = {\n\t\t\tfilters: this.report_doc.json.filters,\n\t\t\tfields: this.report_doc.json.fields,\n\t\t\torder_by: this.report_doc.json.order_by,\n\t\t\tadd_totals_row: this.report_doc.json.add_totals_row,\n\t\t\tpage_length: this.report_doc.json.page_length,\n\t\t\tcolumn_widths: this.report_doc.json.column_widths\n\t\t}\n\n\t\tif (!frappe.utils.deep_equal(current_settings, report_settings)) {\n\t\t\tthis.page.set_indicator(__('Not Saved'), 'orange');\n\t\t} else {\n\t\t\tthis.page.clear_indicator();\n\t\t}\n\t}\n\n\tsave_report_settings() {\n\t\tfrappe.model.user_settings.save(this.doctype, 'last_view', this.view_name);\n\n\t\tif (!this.report_name) {\n\t\t\tthis.save_view_user_settings({\n\t\t\t\tfields: this.fields,\n\t\t\t\tfilters: this.filter_area.get(),\n\t\t\t\torder_by: this.sort_selector.get_sql_string(),\n\t\t\t\tadd_totals_row: this.add_totals_row\n\t\t\t});\n\t\t}\n\t}\n\n\tprepare_data(r) {\n\t\tlet data = r.message || {};\n\t\tdata = frappe.utils.dict(data.keys, data.values);\n\n\t\tif (this.start === 0) {\n\t\t\tthis.data = data;\n\t\t} else {\n\t\t\tthis.data = this.data.concat(data);\n\t\t}\n\t}\n\n\trender(force) {\n\t\tif (this.data.length === 0) return;\n\t\tthis.render_count();\n\t\tthis.setup_columns();\n\n\t\tif (this.chart) {\n\t\t\tthis.refresh_charts();\n\t\t}\n\t\tif (this.datatable && !force) {\n\t\t\tthis.datatable.refresh(this.get_data(this.data), this.columns);\n\t\t\treturn;\n\t\t}\n\t\tthis.setup_datatable(this.data);\n\t}\n\n\trender_count() {\n\t\tlet $list_count = this.$paging_area.find('.list-count');\n\t\tif (!$list_count.length) {\n\t\t\tthis.$paging_area.find('.btn-more').addClass('margin-left');\n\t\t\t$list_count = $('<span>')\n\t\t\t\t.addClass('text-muted text-medium list-count')\n\t\t\t\t.prependTo(this.$paging_area.find('.level-right'));\n\t\t}\n\t\tthis.get_count_str()\n\t\t\t.then(str => {\n\t\t\t\t$list_count.text(str);\n\t\t\t});\n\t}\n\n\ton_update(data) {\n\t\tif (this.doctype === data.doctype && data.name) {\n\t\t\t// flash row when doc is updated by some other user\n\t\t\tconst flash_row = data.user !== frappe.session.user;\n\t\t\tif (this.data.find(d => d.name === data.name)) {\n\t\t\t\t// update existing\n\t\t\t\tfrappe.db.get_doc(data.doctype, data.name)\n\t\t\t\t\t.then(doc => this.update_row(doc, flash_row));\n\t\t\t} else {\n\t\t\t\t// refresh\n\t\t\t\tthis.refresh();\n\t\t\t}\n\t\t}\n\t}\n\n\tupdate_row(doc, flash_row) {\n\t\tconst to_refresh = [];\n\n\t\tthis.data = this.data.map((d, i) => {\n\t\t\tif (d.name === doc.name) {\n\t\t\t\tfor (let fieldname in d) {\n\t\t\t\t\tif (fieldname.includes(':')) {\n\t\t\t\t\t\t// child table field\n\t\t\t\t\t\tconst [cdt, _field] = fieldname.split(':');\n\t\t\t\t\t\tconst cdt_row = Object.keys(doc)\n\t\t\t\t\t\t\t.filter(key => Array.isArray(doc[key]) && doc[key][0].doctype === cdt)\n\t\t\t\t\t\t\t.map(key => doc[key])\n\t\t\t\t\t\t\t.map(a => a[0])\n\t\t\t\t\t\t\t.filter(cdoc => cdoc.name === d[cdt + ':name'])[0];\n\t\t\t\t\t\tif (cdt_row) {\n\t\t\t\t\t\t\td[fieldname] = cdt_row[_field];\n\t\t\t\t\t\t}\n\t\t\t\t\t} else {\n\t\t\t\t\t\td[fieldname] = doc[fieldname];\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tto_refresh.push([d, i]);\n\t\t\t}\n\t\t\treturn d;\n\t\t});\n\n\t\t// indicate row update\n\t\tconst _flash_row = (rowIndex) => {\n\t\t\tif (!flash_row) return;\n\t\t\tconst $row = this.$result.find(`.dt-row[data-row-index=\"${rowIndex}\"]`);\n\t\t\t$row.addClass('row-update');\n\t\t\tsetTimeout(() => $row.removeClass('row-update'), 500);\n\t\t};\n\n\t\tto_refresh.forEach(([data, rowIndex]) => {\n\t\t\tconst new_row = this.build_row(data);\n\t\t\tthis.datatable.refreshRow(new_row, rowIndex);\n\t\t\t_flash_row(rowIndex);\n\t\t});\n\t}\n\n\tsetup_datatable(values) {\n\t\tthis.$datatable_wrapper.empty();\n\t\tthis.datatable = new DataTable(this.$datatable_wrapper[0], {\n\t\t\tcolumns: this.columns,\n\t\t\tdata: this.get_data(values),\n\t\t\tgetEditor: this.get_editing_object.bind(this),\n\t\t\tcheckboxColumn: true,\n\t\t\tinlineFilters: true,\n\t\t\tcellHeight: 35,\n\t\t\tdirection: frappe.utils.is_rtl() ? 'rtl' : 'ltr',\n\t\t\tevents: {\n\t\t\t\tonRemoveColumn: (column) => {\n\t\t\t\t\tthis.remove_column_from_datatable(column);\n\t\t\t\t},\n\t\t\t\tonSwitchColumn: (column1, column2) => {\n\t\t\t\t\tthis.switch_column(column1, column2);\n\t\t\t\t},\n\t\t\t\tonCheckRow: () => {\n\t\t\t\t\tconst checked_items = this.get_checked_items();\n\t\t\t\t\tthis.toggle_actions_menu_button(checked_items.length > 0);\n\t\t\t\t}\n\t\t\t},\n\t\t\thooks: {\n\t\t\t\tcolumnTotal: frappe.utils.report_column_total\n\t\t\t},\n\t\t\theaderDropdown: [{\n\t\t\t\tlabel: __('Add Column'),\n\t\t\t\taction: (datatabe_col) => {\n\t\t\t\t\tlet columns_in_picker = [];\n\t\t\t\t\tconst columns = this.get_columns_for_picker();\n\n\t\t\t\t\tcolumns_in_picker = columns[this.doctype]\n\t\t\t\t\t\t.filter(df => !this.is_column_added(df))\n\t\t\t\t\t\t.map(df => ({\n\t\t\t\t\t\t\tlabel: __(df.label),\n\t\t\t\t\t\t\tvalue: df.fieldname\n\t\t\t\t\t\t}));\n\n\t\t\t\t\tdelete columns[this.doctype];\n\n\t\t\t\t\tfor (let cdt in columns) {\n\t\t\t\t\t\tcolumns[cdt]\n\t\t\t\t\t\t\t.filter(df => !this.is_column_added(df))\n\t\t\t\t\t\t\t.map(df => ({\n\t\t\t\t\t\t\t\tlabel: __(df.label) + ` (${cdt})`,\n\t\t\t\t\t\t\t\tvalue: df.fieldname + ',' + cdt\n\t\t\t\t\t\t\t}))\n\t\t\t\t\t\t\t.forEach(df => columns_in_picker.push(df));\n\t\t\t\t\t}\n\n\t\t\t\t\tconst d = new frappe.ui.Dialog({\n\t\t\t\t\t\ttitle: __('Add Column'),\n\t\t\t\t\t\tfields: [\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tlabel: __('Select Column'),\n\t\t\t\t\t\t\t\tfieldname: 'column',\n\t\t\t\t\t\t\t\tfieldtype: 'Autocomplete',\n\t\t\t\t\t\t\t\toptions: columns_in_picker\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tlabel: __('Insert Column Before {0}', [datatabe_col.docfield.label.bold()]),\n\t\t\t\t\t\t\t\tfieldname: 'insert_before',\n\t\t\t\t\t\t\t\tfieldtype: 'Check'\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t],\n\t\t\t\t\t\tprimary_action: ({ column, insert_before }) => {\n\t\t\t\t\t\t\tif (!columns_in_picker.map(col => col.value).includes(column)) {\n\t\t\t\t\t\t\t\tfrappe.show_alert(__('Invalid column'));\n\t\t\t\t\t\t\t\td.hide();\n\t\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\tlet doctype = this.doctype;\n\t\t\t\t\t\t\tif (column.includes(',')) {\n\t\t\t\t\t\t\t\t[column, doctype] = column.split(',');\n\t\t\t\t\t\t\t}\n\n\n\t\t\t\t\t\t\tlet index = datatabe_col.colIndex;\n\t\t\t\t\t\t\tif (insert_before) {\n\t\t\t\t\t\t\t\tindex = index - 1;\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\tthis.add_column_to_datatable(column, doctype, index);\n\t\t\t\t\t\t\td.hide();\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\n\t\t\t\t\td.show();\n\t\t\t\t}\n\t\t\t}]\n\t\t});\n\t}\n\n\tbind_charts_button() {\n\t\tthis.list_sidebar.sidebar.find('.charts-menu').removeClass('hide');\n\t\tthis.list_sidebar.sidebar.on('click', '.toggle-charts', (e) => {\n\t\t\te.preventDefault();\n\t\t\tthis.toggle_charts();\n\t\t});\n\t\tthis.list_sidebar.sidebar.on('click', '.configure-charts', (e) => {\n\t\t\te.preventDefault();\n\t\t\tthis.get_chart_data().then(() => this.refresh_charts());\n\t\t});\n\t\tthis.refresh_charts_sidebar_button();\n\t}\n\n\trefresh_charts_sidebar_button() {\n\t\t// show configure charts button if charts is shown\n\t\tconst $configure_btn = this.list_sidebar.sidebar.find('.configure-charts');\n\t\tconst charts_visible = this.chart && !this.$charts_wrapper.hasClass('hidden');\n\n\t\tif (charts_visible) {\n\t\t\t$configure_btn.removeClass('hidden');\n\t\t} else {\n\t\t\t$configure_btn.addClass('hidden');\n\t\t}\n\t}\n\n\ttoggle_charts() {\n\t\tif (!this.chart) {\n\t\t\tthis.setup_charts();\n\t\t\treturn;\n\t\t}\n\t\tthis.$charts_wrapper.toggleClass('hidden');\n\n\t\tif (!this.$charts_wrapper.hasClass('hidden')) {\n\t\t\tthis.chart.refresh();\n\t\t}\n\n\t\tthis.refresh_charts_sidebar_button();\n\t}\n\n\tsetup_charts() {\n\t\tthis.get_chart_data()\n\t\t\t.then(args => {\n\t\t\t\tlet data = {\n\t\t\t\t\tlabels: args.labels,\n\t\t\t\t\tdatasets: args.datasets\n\t\t\t\t};\n\n\t\t\t\tthis.last_chart_type = args.chart_type;\n\n\t\t\t\tconst get_df = (field) => frappe.meta.get_docfield(this.doctype, field);\n\t\t\t\tconst get_doc = (value, field) => this.data.find(d => d[field] === value);\n\n\t\t\t\tthis.chart = new Chart(this.$charts_wrapper[0], {\n\t\t\t\t\ttitle: __(\"{0} Chart\", [this.doctype]),\n\t\t\t\t\tdata: data,\n\t\t\t\t\ttype: args.chart_type,\n\t\t\t\t\theight: 150,\n\t\t\t\t\tcolors: ['violet', 'light-blue', 'orange', 'red'],\n\n\t\t\t\t\tformat_tooltip_x: value => value.doc.name,\n\t\t\t\t\tformat_tooltip_y:\n\t\t\t\t\t\tvalue => frappe.format(value, get_df(value.field), { always_show_decimals: true, inline: true }, get_doc(value.doc))\n\t\t\t\t});\n\n\t\t\t\tthis.refresh_charts_sidebar_button();\n\t\t\t});\n\t}\n\n\trefresh_charts() {\n\t\tif (!this.chart) return;\n\t\tconst { x_field, y_fields, chart_type } = this.chart_args;\n\t\tconst args = this.get_chart_args(x_field, y_fields, chart_type);\n\t\tthis.chart.update_values(args.datasets, args.labels);\n\t\tthis.chart.refresh();\n\n\t\tif (args.chart_type !== this.last_chart_type) {\n\t\t\tthis.chart.get_different_chart(args.chart_type);\n\t\t}\n\t}\n\n\tget_chart_data() {\n\t\treturn new Promise(resolve => {\n\t\t\tconst cur_list_fields = this.fields.map(f => f[0]);\n\t\t\tconst x_fields = this.meta.fields.filter(df =>\n\t\t\t\t!df.hidden && cur_list_fields.includes(df.fieldname)\n\t\t\t).map(df => df.fieldname);\n\t\t\tconst y_fields = this.meta.fields.filter(df =>\n\t\t\t\t!df.hidden && frappe.model.is_numeric_field(df)\n\t\t\t\t&& cur_list_fields.includes(df.fieldname)\n\t\t\t).map(df => df.fieldname);\n\n\t\t\tconst defaults = this.chart_args || {};\n\n\t\t\tconst dialog = new frappe.ui.Dialog({\n\t\t\t\ttitle: __('Configure Chart'),\n\t\t\t\tfields: [\n\t\t\t\t\t{\n\t\t\t\t\t\tlabel: __('X Axis Field'),\n\t\t\t\t\t\tfieldtype: 'Autocomplete',\n\t\t\t\t\t\tfieldname: 'x_axis',\n\t\t\t\t\t\toptions: x_fields,\n\t\t\t\t\t\tdefault: defaults.x_field\n\t\t\t\t\t},\n\t\t\t\t\t{\n\t\t\t\t\t\tlabel: __('Y Axis Fields'),\n\t\t\t\t\t\tfieldtype: 'MultiSelect',\n\t\t\t\t\t\tfieldname: 'y_axes',\n\t\t\t\t\t\toptions: y_fields,\n\t\t\t\t\t\tdescription: __('Showing only Numeric fields from Report'),\n\t\t\t\t\t\tdefault: defaults.y_fields\n\t\t\t\t\t},\n\t\t\t\t\t{\n\t\t\t\t\t\tlabel: __('Chart Type'),\n\t\t\t\t\t\tfieldtype: 'Select',\n\t\t\t\t\t\toptions: ['Bar', 'Line', 'Pie', 'Percentage'],\n\t\t\t\t\t\tfieldname: 'chart_type',\n\t\t\t\t\t\tdefault: toTitle(defaults.chart_type || 'Bar')\n\t\t\t\t\t}\n\t\t\t\t],\n\t\t\t\tprimary_action: ({ x_axis, y_axes, chart_type }) => {\n\t\t\t\t\ty_axes = y_axes.split(',').map(d => d.trim()).filter(Boolean);\n\n\t\t\t\t\tif (!(\n\t\t\t\t\t\ty_axes.every(d => y_fields.includes(d))\n\t\t\t\t\t\t&& x_fields.includes(x_axis)\n\t\t\t\t\t)) return;\n\n\t\t\t\t\tconst args = this.get_chart_args(x_axis, y_axes, chart_type);\n\t\t\t\t\tthis.chart_args = args;\n\t\t\t\t\tresolve(args);\n\t\t\t\t\tdialog.hide();\n\t\t\t\t}\n\t\t\t});\n\n\t\t\tdialog.show();\n\t\t});\n\t}\n\n\tget_chart_args(x_axis, y_axes, chart_type) {\n\t\tconst labels = this.data.map(d => {\n\t\t\t// HACK: labels need strings,\n\t\t\t// so we return objects that\n\t\t\t// look like strings and also\n\t\t\t// monkey patch the doc\n\t\t\t// javascript is awesome\n\n\t\t\t// O.o\n\n\t\t\treturn {\n\t\t\t\tdoc: d,\n\t\t\t\ttoString() {\n\t\t\t\t\treturn d[x_axis];\n\t\t\t\t},\n\t\t\t\tslice: String.prototype.slice\n\t\t\t};\n\t\t});\n\n\t\treturn {\n\t\t\tchart_type: chart_type.toLowerCase(),\n\t\t\tx_field: x_axis,\n\t\t\ty_fields: y_axes,\n\t\t\tlabels: labels,\n\t\t\tdatasets: y_axes.map(y_axis => ({\n\t\t\t\tname: frappe.meta.get_docfield(this.doctype, y_axis).label,\n\t\t\t\tvalues: this.data.map(d => ({\n\t\t\t\t\tdoc: d,\n\t\t\t\t\tfield: y_axis,\n\t\t\t\t\ttoString() {\n\t\t\t\t\t\treturn d[y_axis];\n\t\t\t\t\t},\n\t\t\t\t\tslice: String.prototype.slice\n\t\t\t\t}))\n\t\t\t}))\n\t\t};\n\t}\n\n\tget_editing_object(colIndex, rowIndex, value, parent) {\n\t\tconst control = this.render_editing_input(colIndex, value, parent);\n\t\tif (!control) return false;\n\n\t\tcontrol.df.change = () => control.set_focus();\n\n\t\treturn {\n\t\t\tinitValue: (value) => {\n\t\t\t\treturn control.set_value(value);\n\t\t\t},\n\t\t\tsetValue: (value) => {\n\t\t\t\tconst cell = this.datatable.getCell(colIndex, rowIndex);\n\t\t\t\tlet fieldname = this.datatable.getColumn(colIndex).docfield.fieldname;\n\t\t\t\tlet docname = cell.name;\n\t\t\t\tlet doctype = cell.doctype;\n\n\t\t\t\tcontrol.set_value(value);\n\t\t\t\treturn this.set_control_value(doctype, docname, fieldname, value)\n\t\t\t\t\t.then((updated_doc) => {\n\t\t\t\t\t\tconst _data = this.data.find(d => d.name === updated_doc.name);\n\t\t\t\t\t\tfor (let field in _data) {\n\t\t\t\t\t\t\tif (field.includes(':')) {\n\t\t\t\t\t\t\t\t// child table field\n\t\t\t\t\t\t\t\tconst [cdt, _field] = field.split(':');\n\t\t\t\t\t\t\t\tconst cdt_row = Object.keys(updated_doc)\n\t\t\t\t\t\t\t\t\t.filter(key => Array.isArray(updated_doc[key]) && updated_doc[key][0].doctype === cdt)\n\t\t\t\t\t\t\t\t\t.map(key => updated_doc[key])\n\t\t\t\t\t\t\t\t\t.map(a => a[0])\n\t\t\t\t\t\t\t\t\t.filter(cdoc => cdoc.name === _data[cdt + ':name'])[0];\n\t\t\t\t\t\t\t\tif (cdt_row) {\n\t\t\t\t\t\t\t\t\t_data[field] = cdt_row[_field];\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t_data[field] = updated_doc[field];\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t})\n\t\t\t\t\t.then(() => this.refresh_charts());\n\t\t\t},\n\t\t\tgetValue: () => {\n\t\t\t\treturn control.get_value();\n\t\t\t}\n\t\t};\n\t}\n\n\tset_control_value(doctype, docname, fieldname, value) {\n\t\tthis.last_updated_doc = docname;\n\t\treturn new Promise((resolve, reject) => {\n\t\t\tfrappe.db.set_value(doctype, docname, {[fieldname]: value})\n\t\t\t\t.then(r => {\n\t\t\t\t\tif (r.message) {\n\t\t\t\t\t\tresolve(r.message);\n\t\t\t\t\t} else {\n\t\t\t\t\t\treject();\n\t\t\t\t\t}\n\t\t\t\t})\n\t\t\t\t.fail(reject);\n\t\t});\n\t}\n\n\trender_editing_input(colIndex, value, parent) {\n\t\tconst col = this.datatable.getColumn(colIndex);\n\t\tlet control = null;\n\n\t\tif (col.docfield.fieldtype === 'Text Editor') {\n\t\t\tconst d = new frappe.ui.Dialog({\n\t\t\t\ttitle: __('Edit {0}', [col.docfield.label]),\n\t\t\t\tfields: [col.docfield],\n\t\t\t\tprimary_action: () => {\n\t\t\t\t\tthis.datatable.cellmanager.submitEditing();\n\t\t\t\t\tthis.datatable.cellmanager.deactivateEditing();\n\t\t\t\t\td.hide();\n\t\t\t\t}\n\t\t\t});\n\t\t\td.show();\n\t\t\tcontrol = d.fields_dict[col.docfield.fieldname];\n\t\t} else {\n\t\t\t// make control\n\t\t\tcontrol = frappe.ui.form.make_control({\n\t\t\t\tdf: col.docfield,\n\t\t\t\tparent: parent,\n\t\t\t\trender_input: true\n\t\t\t});\n\t\t\tcontrol.set_value(value);\n\t\t\tcontrol.toggle_label(false);\n\t\t\tcontrol.toggle_description(false);\n\t\t}\n\n\t\treturn control;\n\t}\n\n\tis_editable(df, data) {\n\t\tif (!df || data.docstatus !== 0) return false;\n\t\tconst is_standard_field = frappe.model.std_fields_list.includes(df.fieldname);\n\t\tconst can_edit = !(\n\t\t\tis_standard_field\n\t\t\t|| df.read_only\n\t\t\t|| df.hidden\n\t\t\t|| !frappe.model.can_write(this.doctype)\n\t\t);\n\t\treturn can_edit;\n\t}\n\n\tget_data(values) {\n\t\treturn this.build_rows(values);\n\t}\n\n\tset_fields() {\n\t\tif (this.report_name && this.report_doc.json.fields) {\n\t\t\tthis.fields = this.report_doc.json.fields.slice();\n\t\t\treturn;\n\t\t} else if (this.view_user_settings.fields) {\n\t\t\t// get from user_settings\n\t\t\tthis.fields = this.view_user_settings.fields;\n\t\t\treturn;\n\t\t}\n\n\t\t// get fields from meta\n\t\tthis.fields = [];\n\t\tconst add_field = f => this._add_field(f);\n\n\t\t// default fields\n\t\t[\n\t\t\t'name', 'docstatus',\n\t\t\tthis.meta.title_field,\n\t\t\tthis.meta.image_field\n\t\t].map(add_field);\n\n\t\t// fields in_list_view or in_standard_filter\n\t\tconst fields = this.meta.fields.filter(df => {\n\t\t\treturn (df.in_list_view || df.in_standard_filter)\n\t\t\t\t&& frappe.perm.has_perm(this.doctype, df.permlevel, 'read')\n\t\t\t\t&& frappe.model.is_value_type(df.fieldtype)\n\t\t\t\t&& !df.report_hide;\n\t\t});\n\n\t\tfields.map(add_field);\n\n\t\t// currency fields\n\t\tfields.filter(\n\t\t\tdf => df.fieldtype === 'Currency' && df.options\n\t\t).map(df => {\n\t\t\tif (df.options.includes(':')) {\n\t\t\t\tadd_field(df.options.split(':')[1]);\n\t\t\t} else {\n\t\t\t\tadd_field(df.options);\n\t\t\t}\n\t\t});\n\n\t\t// fields in listview_settings\n\t\t(this.settings.add_fields || []).map(add_field);\n\t}\n\n\tbuild_fields() {\n\t\tthis.fields.push(['docstatus', this.doctype]);\n\t\tsuper.build_fields();\n\t}\n\n\tget_fields() {\n\t\tlet fields = this.fields.map(f => {\n\t\t\tlet column_name = frappe.model.get_full_column_name(f[0], f[1]);\n\t\t\tif (f[1] !== this.doctype) {\n\t\t\t\t// child table field\n\t\t\t\tcolumn_name = column_name + ' as ' + `'${f[1]}:${f[0]}'`;\n\t\t\t}\n\t\t\treturn column_name;\n\t\t});\n\t\tconst cdt_name_fields =\n\t\t\tthis.get_unique_cdt_in_view()\n\t\t\t\t.map(cdt => frappe.model.get_full_column_name('name', cdt) + ' as ' + `'${cdt}:name'`);\n\t\tfields = fields.concat(cdt_name_fields);\n\n\t\treturn fields;\n\t}\n\n\tget_unique_cdt_in_view() {\n\t\treturn this.fields\n\t\t\t.filter(f => f[1] !== this.doctype)\n\t\t\t.map(f => f[1])\n\t\t\t.uniqBy(d => d);\n\t}\n\n\tadd_column_to_datatable(fieldname, doctype, col_index) {\n\t\tconst field = [fieldname, doctype];\n\t\tthis.fields.splice(col_index, 0, field);\n\n\t\tthis.add_currency_column(fieldname, doctype, col_index);\n\n\t\tthis.build_fields();\n\t\tthis.setup_columns();\n\n\t\tthis.datatable.destroy();\n\t\tthis.datatable = null;\n\t\tthis.refresh();\n\t}\n\n\tadd_currency_column(fieldname, doctype, col_index) {\n\t\t// Adds dependent currency field if required\n\t\tconst df = frappe.meta.get_docfield(doctype, fieldname);\n\t\tif (df && df.fieldtype === 'Currency' && df.options &&\n\t\t\t!df.options.includes(':') && frappe.meta.has_field(doctype, df.options)\n\t\t) {\n\t\t\tconst field = [df.options, doctype];\n\t\t\tif (col_index === undefined) {\n\t\t\t\tthis.fields.push(field);\n\t\t\t} else {\n\t\t\t\tthis.fields.splice(col_index, 0, field);\n\t\t\t}\n\t\t\tfrappe.show_alert(__('Also adding the dependent currency field {0}', [field[0].bold()]));\n\t\t}\n\t}\n\n\tremove_column_from_datatable(column) {\n\t\tconst index = this.fields.findIndex(f => column.field === f[0]);\n\t\tif (index === -1) return;\n\t\tconst field = this.fields[index];\n\t\tif (field[0] === 'name') {\n\t\t\tthis.refresh();\n\t\t\tfrappe.throw(__('Cannot remove ID field'));\n\t\t}\n\t\tthis.fields.splice(index, 1);\n\t\tthis.build_fields();\n\t\tthis.setup_columns();\n\t\tthis.refresh();\n\t}\n\n\tswitch_column(col1, col2) {\n\t\tconst index1 = this.fields.findIndex(f => col1.field === f[0]);\n\t\tconst index2 = this.fields.findIndex(f => col2.field === f[0]);\n\t\tconst _fields = this.fields.slice();\n\n\t\tlet temp = _fields[index1];\n\t\t_fields[index1] = _fields[index2];\n\t\t_fields[index2] = temp;\n\n\t\tthis.fields = _fields;\n\t\tthis.build_fields();\n\t\tthis.setup_columns();\n\t\tthis.refresh();\n\t}\n\n\tget_columns_for_picker() {\n\t\tlet out = {};\n\n\t\tconst standard_fields_filter = df =>\n\t\t\t!in_list(frappe.model.no_value_type, df.fieldtype) && !df.report_hide;\n\n\t\tlet doctype_fields = frappe.meta.get_docfields(this.doctype).filter(standard_fields_filter);\n\n\t\tdoctype_fields = [{\n\t\t\tlabel: __('ID'),\n\t\t\tfieldname: 'name',\n\t\t\tfieldtype: 'Data'\n\t\t}].concat(doctype_fields, frappe.model.std_fields);\n\n\t\tout[this.doctype] = doctype_fields;\n\n\t\tconst table_fields = frappe.meta.get_table_fields(this.doctype)\n\t\t\t.filter(df => !df.hidden);\n\n\t\ttable_fields.forEach(df => {\n\t\t\tconst cdt = df.options;\n\t\t\tconst child_table_fields = frappe.meta.get_docfields(cdt).filter(standard_fields_filter);\n\n\t\t\tout[cdt] = child_table_fields;\n\t\t});\n\n\t\treturn out;\n\t}\n\n\tget_dialog_fields() {\n\t\tconst dialog_fields = [];\n\t\tconst columns = this.get_columns_for_picker();\n\n\t\tdialog_fields.push({\n\t\t\tlabel: __(this.doctype),\n\t\t\tfieldname: this.doctype,\n\t\t\tfieldtype: 'MultiCheck',\n\t\t\tcolumns: 2,\n\t\t\toptions: columns[this.doctype]\n\t\t\t\t.map(df => ({\n\t\t\t\t\tlabel: __(df.label),\n\t\t\t\t\tvalue: df.fieldname,\n\t\t\t\t\tchecked: this.fields.find(f => f[0] === df.fieldname)\n\t\t\t\t}))\n\t\t});\n\n\t\tdelete columns[this.doctype];\n\n\t\tconst table_fields = frappe.meta.get_table_fields(this.doctype)\n\t\t\t.filter(df => !df.hidden);\n\n\t\ttable_fields.forEach(df => {\n\t\t\tconst cdt = df.options;\n\n\t\t\tdialog_fields.push({\n\t\t\t\tlabel: __(df.label) + ` (${__(cdt)})`,\n\t\t\t\tfieldname: df.options,\n\t\t\t\tfieldtype: 'MultiCheck',\n\t\t\t\tcolumns: 2,\n\t\t\t\toptions: columns[cdt]\n\t\t\t\t\t.map(df => ({\n\t\t\t\t\t\tlabel: __(df.label),\n\t\t\t\t\t\tvalue: df.fieldname,\n\t\t\t\t\t\tchecked: this.fields.find(f => f[0] === df.fieldname && f[1] === cdt)\n\t\t\t\t\t}))\n\t\t\t});\n\t\t});\n\n\t\treturn dialog_fields;\n\t}\n\n\tis_column_added(df) {\n\t\treturn Boolean(\n\t\t\tthis.fields.find(f => f[0] === df.fieldname && df.parent === f[1])\n\t\t);\n\t}\n\n\tsetup_columns() {\n\t\tconst hide_columns = ['docstatus'];\n\t\tconst fields = this.fields.filter(f => !hide_columns.includes(f[0]));\n\n\t\t// apply previous column width\n\t\tlet column_widths = null;\n\t\tif (this.columns) {\n\t\t\tcolumn_widths = this.get_column_widths();\n\t\t}\n\t\tthis.columns = fields.map(f => this.build_column(f)).filter(Boolean);\n\n\t\tif (column_widths) {\n\t\t\tthis.columns = this.columns.map(column => {\n\t\t\t\tcolumn.width = column_widths[column.id] || column.width;\n\t\t\t\treturn column;\n\t\t\t});\n\t\t}\n\t}\n\n\tbuild_column(c) {\n\t\tlet [fieldname, doctype] = c;\n\t\tlet docfield = frappe.meta.docfield_map[doctype || this.doctype][fieldname];\n\n\t\tif (!docfield) {\n\t\t\tdocfield = frappe.model.get_std_field(fieldname);\n\n\t\t\tif (docfield) {\n\t\t\t\tdocfield.parent = this.doctype;\n\t\t\t\tif (fieldname == \"name\") {\n\t\t\t\t\tdocfield.options = this.doctype;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tif (!docfield) return;\n\n\t\tlet title = __(docfield ? docfield.label : toTitle(fieldname));\n\t\tif (doctype !== this.doctype) {\n\t\t\ttitle += ` (${__(doctype)})`;\n\t\t}\n\n\t\tconst editable = frappe.model.is_non_std_field(fieldname) && !docfield.read_only;\n\n\t\tconst align = (() => {\n\t\t\tconst is_numeric = frappe.model.is_numeric_field(docfield);\n\t\t\tif (is_numeric) {\n\t\t\t\treturn 'right';\n\t\t\t}\n\t\t\treturn docfield.fieldtype === 'Date' ? 'right' : 'left';\n\t\t})();\n\n\t\t// child table column\n\t\tconst id = doctype !== this.doctype ? `${doctype}:${fieldname}` : fieldname;\n\n\t\tlet width = (docfield ? cint(docfield.width) : null) || null;\n\t\tif (this.report_doc) {\n\t\t\t// load the user saved column width\n\t\t\tlet saved_column_widths = this.report_doc.json.column_widths || {};\n\t\t\twidth = saved_column_widths[id] || width;\n\t\t}\n\n\t\tlet compareFn = null;\n\t\tif (docfield.fieldtype === 'Date') {\n\t\t\tcompareFn = (cell, keyword) => {\n\t\t\t\tif (!cell.content) return null;\n\t\t\t\tif (keyword.length !== 'YYYY-MM-DD'.length) return null;\n\n\t\t\t\tconst keywordValue = frappe.datetime.user_to_obj(keyword);\n\t\t\t\tconst cellValue = frappe.datetime.str_to_obj(cell.content);\n\t\t\t\treturn [+cellValue, +keywordValue];\n\t\t\t}\n\t\t}\n\n\n\t\treturn {\n\t\t\tid: id,\n\t\t\tfield: fieldname,\n\t\t\tname: title,\n\t\t\tcontent: title,\n\t\t\tdocfield,\n\t\t\twidth,\n\t\t\teditable,\n\t\t\talign,\n\t\t\tcompareValue: compareFn,\n\t\t\tformat: (value, row, column, data) => {\n\t\t\t\tlet doc = null;\n\t\t\t\tif (Array.isArray(row)) {\n\t\t\t\t\tdoc = row.reduce((acc, curr) => {\n\t\t\t\t\t\tif (!curr.column.docfield) return acc;\n\t\t\t\t\t\tacc[curr.column.docfield.fieldname] = curr.content;\n\t\t\t\t\t\treturn acc;\n\t\t\t\t\t}, {});\n\t\t\t\t} else {\n\t\t\t\t\tdoc = row;\n\t\t\t\t}\n\n\t\t\t\treturn frappe.format(value, column.docfield, { always_show_decimals: true }, doc);\n\t\t\t}\n\t\t};\n\t}\n\n\tbuild_rows(data) {\n\t\tconst out = data.map(d => this.build_row(d));\n\n\t\tif (this.add_totals_row) {\n\t\t\tconst totals = this.get_columns_totals(data);\n\t\t\tconst totals_row = this.columns.map((col, i) => {\n\t\t\t\treturn {\n\t\t\t\t\tname: __('Totals Row'),\n\t\t\t\t\tcontent: totals[col.id],\n\t\t\t\t\tformat: value => {\n\t\t\t\t\t\treturn frappe.format(value, col.docfield, { always_show_decimals: true });\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t})\n\n\t\t\ttotals_row[0].content = __('Totals').bold();\n\t\t\tout.push(totals_row);\n\t\t}\n\n\t\treturn out;\n\t}\n\n\tbuild_row(d) {\n\t\treturn this.columns.map(col => {\n\t\t\tif (col.docfield.parent !== this.doctype) {\n\t\t\t\t// child table field\n\t\t\t\tconst cdt_field = f => `${col.docfield.parent}:${f}`;\n\t\t\t\tconst name = d[cdt_field('name')];\n\n\t\t\t\treturn {\n\t\t\t\t\tname: name,\n\t\t\t\t\tdoctype: col.docfield.parent,\n\t\t\t\t\tcontent: d[cdt_field(col.field)],\n\t\t\t\t\teditable: Boolean(name && this.is_editable(col.docfield, d)),\n\t\t\t\t\tformat: value => {\n\t\t\t\t\t\treturn frappe.format(value, col.docfield, { always_show_decimals: true });\n\t\t\t\t\t}\n\t\t\t\t};\n\t\t\t}\n\n\t\t\tif (col.field in d) {\n\t\t\t\tconst value = d[col.field];\n\t\t\t\treturn {\n\t\t\t\t\tname: d.name,\n\t\t\t\t\tdoctype: col.docfield.parent,\n\t\t\t\t\tcontent: value,\n\t\t\t\t\teditable: this.is_editable(col.docfield, d)\n\t\t\t\t};\n\t\t\t}\n\t\t\treturn {\n\t\t\t\tcontent: ''\n\t\t\t};\n\t\t});\n\t}\n\n\tget_checked_items(only_docnames) {\n\t\tconst indexes = this.datatable.rowmanager.getCheckedRows();\n\t\tconst items = indexes.filter(i => i != undefined)\n\t\t\t.map(i => this.data[i]);\n\n\t\tif (only_docnames) {\n\t\t\treturn items.map(d => d.name);\n\t\t}\n\n\t\treturn items;\n\t}\n\n\tsave_report(save_type) {\n\t\tconst _save_report = (name) => {\n\t\t\t// callback\n\t\t\tconst report_settings = {\n\t\t\t\tfilters: this.filter_area.get(),\n\t\t\t\tfields: this.fields,\n\t\t\t\torder_by: this.sort_selector.get_sql_string(),\n\t\t\t\tadd_totals_row: this.add_totals_row,\n\t\t\t\tpage_length: this.page_length,\n\t\t\t\tcolumn_widths: this.get_column_widths()\n\t\t\t}\n\n\t\t\treturn frappe.call({\n\t\t\t\tmethod: 'frappe.desk.reportview.save_report',\n\t\t\t\targs: {\n\t\t\t\t\tname: name,\n\t\t\t\t\tdoctype: this.doctype,\n\t\t\t\t\tjson: JSON.stringify(report_settings)\n\t\t\t\t},\n\t\t\t\tcallback:(r) => {\n\t\t\t\t\tif(r.exc) {\n\t\t\t\t\t\tfrappe.msgprint(__(\"Report was not saved (there were errors)\"));\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t\tif(r.message != this.report_name) {\n\t\t\t\t\t\t// Rerender the reports dropdown,\n\t\t\t\t\t\t// so that this report is included in the dropdown as well.\n\t\t\t\t\t\tfrappe.boot.user.all_reports[r.message] = {\n\t\t\t\t\t\t\tref_doctype: \"Item\",\n\t\t\t\t\t\t\treport_type: \"Report Builder\",\n\t\t\t\t\t\t\ttitle: r.message,\n\t\t\t\t\t\t};\n\t\t\t\t\t\tthis.list_sidebar.setup_reports();\n\t\t\t\t\t\tfrappe.set_route('List', this.doctype, 'Report', r.message);\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\n\t\t\t\t\t// update state\n\t\t\t\t\tthis.report_doc.json = report_settings;\n\t\t\t\t\tthis.set_dirty_state_for_custom_report();\n\t\t\t\t}\n\t\t\t});\n\n\t\t};\n\n\t\tif(this.report_name && save_type == \"save\") {\n\t\t\t_save_report(this.report_name);\n\t\t} else {\n\t\t\tfrappe.prompt({fieldname: 'name', label: __('New Report name'), reqd: 1, fieldtype: 'Data'}, (data) => {\n\t\t\t\t_save_report(data.name);\n\t\t\t}, __('Save As'));\n\t\t}\n\t}\n\n\tget_column_widths() {\n\t\tif (this.datatable) {\n\t\t\treturn this.datatable\n\t\t\t\t.datamanager\n\t\t\t\t.getColumns(true)\n\t\t\t\t.reduce((acc, curr) => {\n\t\t\t\t\tacc[curr.id] = parseInt(curr.width);\n\t\t\t\t\treturn acc;\n\t\t\t\t}, {});\n\t\t}\n\n\t\treturn {};\n\t}\n\n\tget_report_doc() {\n\t\treturn new Promise(resolve => {\n\t\t\tfrappe.model.with_doc('Report', this.report_name, () => {\n\t\t\t\tresolve(frappe.get_doc('Report', this.report_name));\n\t\t\t});\n\t\t});\n\t}\n\n\tget_filters_html_for_print() {\n\t\tconst filters = this.filter_area.get();\n\n\t\treturn filters.map(f => {\n\t\t\tconst [doctype, fieldname, condition, value] = f;\n\t\t\tif (condition !== '=') return '';\n\n\t\t\tconst label = frappe.meta.get_label(doctype, fieldname);\n\t\t\treturn `<h6>${__(label)}: ${value}</h6>`;\n\t\t}).join('');\n\t}\n\n\tget_columns_totals(data) {\n\t\tif (!this.add_totals_row) {\n\t\t\treturn [];\n\t\t}\n\n\t\tconst row_totals = {};\n\n\t\tthis.columns.forEach((col, i) => {\n\t\t\tconst totals = data.reduce((totals, d) => {\n\t\t\t\tif (col.id in d && frappe.model.is_numeric_field(col.docfield)) {\n\t\t\t\t\ttotals += flt(d[col.id]);\n\t\t\t\t\treturn totals;\n\t\t\t\t}\n\t\t\t}, 0);\n\n\t\t\trow_totals[col.id] = totals;\n\t\t});\n\n\t\treturn row_totals;\n\t}\n\n\treport_menu_items() {\n\t\tlet items = [\n\t\t\t{\n\t\t\t\tlabel: __('Show Totals'),\n\t\t\t\taction: () => {\n\t\t\t\t\tthis.add_totals_row = !this.add_totals_row;\n\t\t\t\t\tthis.save_view_user_settings({ add_totals_row: this.add_totals_row });\n\t\t\t\t\tthis.datatable.refresh(this.get_data(this.data));\n\t\t\t\t}\n\t\t\t},\n\t\t\t{\n\t\t\t\tlabel: __('Print'),\n\t\t\t\taction: () => {\n\t\t\t\t\t// prepare rows in their current state, sorted and filtered\n\t\t\t\t\tconst rows_in_order = this.datatable.datamanager.rowViewOrder.map(index => {\n\t\t\t\t\t\tif (this.datatable.bodyRenderer.visibleRowIndices.includes(index)) {\n\t\t\t\t\t\t\treturn this.data[index];\n\t\t\t\t\t\t}\n\t\t\t\t\t}).filter(Boolean);\n\n\t\t\t\t\tif (this.add_totals_row) {\n\t\t\t\t\t\tconst total_data = this.get_columns_totals(this.data);\n\n\t\t\t\t\t\ttotal_data['name'] = __('Totals').bold();\n\t\t\t\t\t\trows_in_order.push(total_data);\n\t\t\t\t\t}\n\n\t\t\t\t\tfrappe.ui.get_print_settings(false, (print_settings) => {\n\t\t\t\t\t\tvar title =  __(this.doctype);\n\t\t\t\t\t\tfrappe.render_grid({\n\t\t\t\t\t\t\ttitle: title,\n\t\t\t\t\t\t\tsubtitle: this.get_filters_html_for_print(),\n\t\t\t\t\t\t\tprint_settings: print_settings,\n\t\t\t\t\t\t\tcolumns: this.columns,\n\t\t\t\t\t\t\tdata: rows_in_order\n\t\t\t\t\t\t});\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t},\n\t\t\t{\n\t\t\t\tlabel: __('Toggle Chart'),\n\t\t\t\taction: () => this.toggle_charts()\n\t\t\t},\n\t\t\t{\n\t\t\t\tlabel: __('Toggle Sidebar'),\n\t\t\t\taction: () => this.toggle_side_bar()\n\t\t\t},\n\t\t\t{\n\t\t\t\tlabel: __('Pick Columns'),\n\t\t\t\taction: () => {\n\t\t\t\t\tconst d = new frappe.ui.Dialog({\n\t\t\t\t\t\ttitle: __('Pick Columns'),\n\t\t\t\t\t\tfields: this.get_dialog_fields(),\n\t\t\t\t\t\tprimary_action: (values) => {\n\t\t\t\t\t\t\t// doctype fields\n\t\t\t\t\t\t\tlet fields = values[this.doctype].map(f => [f, this.doctype]);\n\t\t\t\t\t\t\tdelete values[this.doctype];\n\n\t\t\t\t\t\t\t// child table fields\n\t\t\t\t\t\t\tfor (let cdt in values) {\n\t\t\t\t\t\t\t\tfields = fields.concat(values[cdt].map(f => [f, cdt]));\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t// always keep name (ID) column\n\t\t\t\t\t\t\tthis.fields = [[\"name\", this.doctype], ...fields];\n\n\t\t\t\t\t\t\tthis.fields.map(f => this.add_currency_column(f[0], f[1]));\n\n\t\t\t\t\t\t\tthis.build_fields();\n\t\t\t\t\t\t\tthis.setup_columns();\n\n\t\t\t\t\t\t\tthis.datatable.destroy();\n\t\t\t\t\t\t\tthis.datatable = null;\n\t\t\t\t\t\t\tthis.refresh();\n\n\t\t\t\t\t\t\td.hide();\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\n\t\t\t\t\td.show();\n\t\t\t\t}\n\t\t\t}\n\t\t];\n\n\t\tif (frappe.model.can_export(this.doctype)) {\n\t\t\titems.push({\n\t\t\t\tlabel: __('Export'),\n\t\t\t\taction: () => {\n\t\t\t\t\tconst args = this.get_args();\n\t\t\t\t\tconst selected_items = this.get_checked_items(true);\n\n\t\t\t\t\tconst d = new frappe.ui.Dialog({\n\t\t\t\t\t\ttitle: __(\"Export Report: {0}\",[__(this.doctype)]),\n\t\t\t\t\t\tfields: [\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tfieldtype: 'Select',\n\t\t\t\t\t\t\t\tlabel: __('Select File Type'),\n\t\t\t\t\t\t\t\tfieldname:'file_format_type',\n\t\t\t\t\t\t\t\toptions: ['Excel', 'CSV'],\n\t\t\t\t\t\t\t\tdefault: 'Excel'\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tfieldtype: 'Check',\n\t\t\t\t\t\t\t\tfieldname: 'export_all_rows',\n\t\t\t\t\t\t\t\tlabel: __('Export All {0} rows?', [(this.total_count + \"\").bold()])\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t],\n\t\t\t\t\t\tprimary_action_label: __('Download'),\n\t\t\t\t\t\tprimary_action: (data) => {\n\t\t\t\t\t\t\targs.cmd = 'frappe.desk.reportview.export_query';\n\t\t\t\t\t\t\targs.file_format_type = data.file_format_type;\n\n\t\t\t\t\t\t\tif(this.add_totals_row) {\n\t\t\t\t\t\t\t\targs.add_totals_row = 1;\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\tif(selected_items.length > 0) {\n\t\t\t\t\t\t\t\targs.selected_items = selected_items;\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\tif (!data.export_all_rows) {\n\t\t\t\t\t\t\t\targs.start = 0;\n\t\t\t\t\t\t\t\targs.page_length = this.data.length;\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\tdelete args.start;\n\t\t\t\t\t\t\t\tdelete args.page_length;\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\topen_url_post(frappe.request.url, args);\n\n\t\t\t\t\t\t\td.hide();\n\t\t\t\t\t\t},\n\t\t\t\t\t});\n\n\t\t\t\t\td.show();\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\n\t\titems.push({\n\t\t\tlabel: __(\"Setup Auto Email\"),\n\t\t\taction: () => {\n\t\t\t\tif(this.report_name) {\n\t\t\t\t\tfrappe.set_route('List', 'Auto Email Report', {'report' : this.report_name});\n\t\t\t\t} else {\n\t\t\t\t\tfrappe.msgprint(__('Please save the report first'));\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\n\t\t// save buttons\n\t\tif(frappe.user.is_report_manager()) {\n\t\t\titems = items.concat([\n\t\t\t\t{ label: __('Save'), action: () => this.save_report('save') },\n\t\t\t\t{ label: __('Save As'), action: () => this.save_report('save_as') }\n\t\t\t]);\n\t\t}\n\n\t\t// user permissions\n\t\tif(this.report_name && frappe.model.can_set_user_permissions(\"Report\")) {\n\t\t\titems.push({\n\t\t\t\tlabel: __(\"User Permissions\"),\n\t\t\t\taction: () => {\n\t\t\t\t\tconst args = {\n\t\t\t\t\t\tdoctype: \"Report\",\n\t\t\t\t\t\tname: this.report_name\n\t\t\t\t\t};\n\t\t\t\t\tfrappe.set_route('List', 'User Permission', args);\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\n\t\t// add to desktop\n\t\titems.push({\n\t\t\tlabel: __('Add to Desktop'),\n\t\t\taction: () => {\n\t\t\t\tfrappe.add_to_desktop(\n\t\t\t\t\tthis.report_name || __('{0} Report', [this.doctype]),\n\t\t\t\t\tthis.doctype, this.report_name\n\t\t\t\t);\n\t\t\t}\n\t\t});\n\n\t\treturn items.map(i => Object.assign(i, { standard: true }));\n\t}\n\n};\n","// Copyright (c) 2018, Frappe Technologies Pvt. Ltd. and Contributors\n// MIT License. See license.txt\nimport DataTable from 'frappe-datatable';\n\nfrappe.provide('frappe.views');\nfrappe.provide('frappe.query_reports');\n\nfrappe.standard_pages['query-report'] = function() {\n\tvar wrapper = frappe.container.add_page('query-report');\n\n\tfrappe.ui.make_app_page({\n\t\tparent: wrapper,\n\t\ttitle: __('Query Report'),\n\t\tsingle_column: true,\n\t});\n\n\tfrappe.query_report = new frappe.views.QueryReport({\n\t\tparent: wrapper,\n\t});\n\n\t$(wrapper).bind('show', function() {\n\t\tfrappe.query_report.show();\n\t});\n};\n\nfrappe.views.QueryReport = class QueryReport extends frappe.views.BaseList {\n\tshow() {\n\t\tthis.init().then(() => this.load());\n\t}\n\n\tinit() {\n\t\tif (this.init_promise) {\n\t\t\treturn this.init_promise;\n\t\t}\n\n\t\tlet tasks = [\n\t\t\tthis.setup_defaults,\n\t\t\tthis.setup_page,\n\t\t\tthis.setup_report_wrapper,\n\t\t\tthis.setup_events\n\t\t].map(fn => fn.bind(this));\n\t\tthis.init_promise = frappe.run_serially(tasks);\n\t\treturn this.init_promise;\n\t}\n\n\tsetup_defaults() {\n\t\tthis.route = frappe.get_route();\n\t\tthis.page_name = frappe.get_route_str();\n\n\t\t// Setup buttons\n\t\tthis.primary_action = null;\n\t\tthis.secondary_action = {\n\t\t\tlabel: __('Refresh'),\n\t\t\taction: () => {\n\t\t\t\tthis.setup_progress_bar();\n\t\t\t\tthis.refresh();\n\t\t\t}\n\t\t};\n\n\t\t// throttle refresh for 300ms\n\t\tthis.refresh = frappe.utils.throttle(this.refresh, 300);\n\n\t\tthis.menu_items = [];\n\t}\n\n\tsetup_events() {\n\t\tfrappe.realtime.on(\"report_generated\", (data) => {\n\t\t\tif(data.report_name) {\n\t\t\t\tthis.prepared_report_action = \"Rebuild\";\n\t\t\t\t// If generated report and currently active Prepared Report has same fiters\n\t\t\t\t// then refresh the Prepared Report\n\t\t\t\t// Otherwise show alert with the link to the Prepared Report\n\t\t\t\tif(data.name == this.prepared_report_doc_name) {\n\t\t\t\t\tthis.refresh();\n\t\t\t\t} else {\n\t\t\t\t\tlet alert_message = `Report ${this.report_name} generated.\n\t\t\t\t\t\t<a href=\"#query-report/${this.report_name}/?prepared_report_name=${data.name}\">View</a>`;\n\t\t\t\t\tfrappe.show_alert({message: alert_message, indicator: 'orange'});\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\t\tthis.page.wrapper.on('click', '[data-action]', (e) => {\n\t\t\tlet action_name = $(e.currentTarget).data('action');\n\t\t\tlet action = this[action_name];\n\t\t\tif (action.call) {\n\t\t\t\taction.call(this, e);\n\t\t\t}\n\t\t});\n\t}\n\n\tload() {\n\t\tif (frappe.get_route().length < 2) {\n\t\t\tthis.toggle_nothing_to_show(true);\n\t\t\treturn;\n\t\t}\n\n\t\tif (this.report_name !== frappe.get_route()[1]) {\n\t\t\t// this.toggle_loading(true);\n\t\t\t// different report\n\t\t\tthis.load_report();\n\t\t}\n\t\telse if (frappe.route_options){\n\t\t\t// filters passed through routes\n\t\t\t// so refresh report again\n\t\t\tthis.refresh_report();\n\t\t} else {\n\t\t\t// same report\n\t\t\t// don't do anything to preserve state\n\t\t\t// like filters and datatable column widths\n\t\t}\n\t}\n\n\tload_report() {\n\t\tthis.page.clear_inner_toolbar();\n\t\tthis.route = frappe.get_route();\n\t\tthis.page_name = frappe.get_route_str();\n\t\tthis.report_name = this.route[1];\n\t\tthis.page_title = __(this.report_name);\n\t\tthis.show_save = false;\n\t\tthis.menu_items = this.get_menu_items();\n\t\tthis.datatable = null;\n\t\tthis.prepared_report_action = \"New\";\n\n\n\t\tfrappe.run_serially([\n\t\t\t() => this.get_report_doc(),\n\t\t\t() => this.get_report_settings(),\n\t\t\t() => this.setup_progress_bar(),\n\t\t\t() => this.setup_page_head(),\n\t\t\t() => this.refresh_report(),\n\t\t\t() => this.add_make_chart_button()\n\t\t]);\n\t}\n\n\tadd_make_chart_button(){\n\t\tthis.page.add_inner_button(__(\"Set Chart\"), () => {\n\t\t\tthis.get_possible_chart_options();\n\t\t});\n\t}\n\n\trefresh_report() {\n\t\tthis.toggle_message(true);\n\n\t\treturn frappe.run_serially([\n\t\t\t() => this.setup_filters(),\n\t\t\t() => this.set_route_filters(),\n\t\t\t() => this.report_settings.onload && this.report_settings.onload(this),\n\t\t\t() => this.get_user_settings(),\n\t\t\t() => this.refresh()\n\t\t]);\n\t}\n\n\tget_report_doc() {\n\t\treturn frappe.model.with_doc('Report', this.report_name)\n\t\t\t.then(doc => {\n\t\t\t\tthis.report_doc = doc;\n\t\t\t})\n\t\t\t.then(() => frappe.model.with_doctype(this.report_doc.ref_doctype));\n\t}\n\n\tget_report_settings() {\n\t\tif (frappe.query_reports[this.report_name]) {\n\t\t\tthis.report_settings = this.get_local_report_settings();\n\t\t\treturn this._load_script;\n\t\t}\n\n\t\tthis._load_script = (new Promise(resolve => frappe.call({\n\t\t\tmethod: 'frappe.desk.query_report.get_script',\n\t\t\targs: { report_name: this.report_name },\n\t\t\tcallback: resolve\n\t\t}))).then(r => {\n\t\t\tfrappe.dom.eval(r.message.script || '');\n\t\t\treturn r;\n\t\t}).then(r => {\n\t\t\treturn frappe.after_ajax(() => {\n\t\t\t\tthis.report_settings = this.get_local_report_settings();\n\t\t\t\tthis.report_settings.html_format = r.message.html_format;\n\t\t\t\tthis.report_settings.execution_time = r.message.execution_time || 0;\n\t\t\t});\n\t\t});\n\n\t\treturn this._load_script;\n\t}\n\n\tget_local_report_settings() {\n\t\tlet report_script_name = this.report_doc.report_type === 'Custom Report'\n\t\t\t? this.report_doc.reference_report\n\t\t\t: this.report_name;\n\t\treturn frappe.query_reports[report_script_name];\n\t}\n\n\tsetup_progress_bar() {\n\t\tlet seconds_elapsed = 0;\n\t\tconst execution_time = this.report_settings.execution_time || 0;\n\n\t\tif (execution_time < 5) return;\n\n\t\tthis.interval = setInterval(function()  {\n\t\t\tseconds_elapsed += 1;\n\t\t\tfrappe.show_progress(__('Preparing Report'), seconds_elapsed, execution_time);\n\t\t}, 1000);\n\t}\n\n\tsetup_filters() {\n\t\tthis.clear_filters();\n\t\tconst { filters = [] } = this.report_settings;\n\n\t\tthis.filters = filters.map(df => {\n\t\t\tif (df.fieldtype === 'Break') return;\n\n\t\t\tlet f = this.page.add_field(df);\n\n\t\t\tif (df.default) {\n\t\t\t\tf.set_input(df.default);\n\t\t\t}\n\n\t\t\tif (df.get_query) f.get_query = df.get_query;\n\t\t\tif (df.on_change) f.on_change = df.on_change;\n\n\t\t\tdf.onchange = () => {\n\t\t\t\tif (this.previous_filters\n\t\t\t\t\t&& (JSON.stringify(this.previous_filters) == JSON.stringify(this.get_filter_values()))) {\n\t\t\t\t\t// filter values have not changed\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\tthis.previous_filters = this.get_filter_values();\n\n\t\t\t\t// clear previous_filters after 3 seconds, to allow refresh for new data\n\t\t\t\tsetTimeout(() => this.previous_filters = null, 10000);\n\n\t\t\t\tif (f.on_change) {\n\t\t\t\t\tf.on_change(this);\n\t\t\t\t} else {\n\t\t\t\t\tif (this.prepared_report) {\n\t\t\t\t\t\tthis.reset_report_view();\n\t\t\t\t\t}\n\t\t\t\t\telse if (!this._no_refresh) {\n\t\t\t\t\t\tthis.refresh();\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t};\n\n\t\t\tf = Object.assign(f, df);\n\n\t\t\treturn f;\n\n\t\t}).filter(Boolean);\n\n\t\tif (this.filters.length === 0) {\n\t\t\t// hide page form if no filters\n\t\t\tthis.page.hide_form();\n\t\t} else {\n\t\t\tthis.page.show_form();\n\t\t}\n\t}\n\n\tset_filters(filters) {\n\t\tthis.filters.map(f => {\n\t\t\tf.set_input(filters[f.fieldname]);\n\t\t});\n\t}\n\n\tset_route_filters() {\n\t\tif(frappe.route_options) {\n\t\t\tconst fields = Object.keys(frappe.route_options);\n\n\t\t\tconst filters_to_set = this.filters.filter(f => fields.includes(f.df.fieldname));\n\n\t\t\tconst promises = filters_to_set.map(f => {\n\t\t\t\treturn () => {\n\t\t\t\t\tconst value = frappe.route_options[f.df.fieldname];\n\t\t\t\t\treturn f.set_value(value);\n\t\t\t\t};\n\t\t\t});\n\t\t\tpromises.push(() => {\n\t\t\t\tfrappe.route_options = null;\n\t\t\t});\n\n\t\t\treturn frappe.run_serially(promises);\n\t\t}\n\t}\n\n\tclear_filters() {\n\t\tthis.page.clear_fields();\n\t}\n\n\trefresh() {\n\t\tthis.toggle_message(true);\n\t\tlet filters = this.get_filter_values(true);\n\t\tlet query = frappe.utils.get_query_string(frappe.get_route_str());\n\n\t\tif(query) {\n\t\t\tlet obj = frappe.utils.get_query_params(query);\n\t\t\tfilters = Object.assign(filters || {}, obj);\n\t\t}\n\n\t\t// only one refresh at a time\n\t\tif (this.last_ajax) {\n\t\t\tthis.last_ajax.abort();\n\t\t}\n\n\t\treturn new Promise(resolve => {\n\t\t\tthis.last_ajax = frappe.call({\n\t\t\t\tmethod: 'frappe.desk.query_report.run',\n\t\t\t\ttype: 'GET',\n\t\t\t\targs: {\n\t\t\t\t\treport_name: this.report_name,\n\t\t\t\t\tfilters: filters,\n\t\t\t\t},\n\t\t\t\tcallback: resolve,\n\t\t\t\talways: () => this.page.btn_secondary.prop('disabled', false)\n\t\t\t})\n\t\t}).then(r => {\n\t\t\tlet data = r.message;\n\t\t\tthis.hide_status();\n\t\t\tclearInterval(this.interval);\n\n\t\t\tthis.execution_time = data.execution_time || 0.1;\n\n\t\t\tif (data.prepared_report) {\n\t\t\t\tthis.prepared_report = true;\n\t\t\t\tconst query_string = frappe.utils.get_query_string(frappe.get_route_str());\n\t\t\t\tconst query_params = frappe.utils.get_query_params(query_string);\n\t\t\t\t// If query_string contains prepared_report_name then set filters\n\t\t\t\t// to match the mentioned prepared report doc and disable editing\n\t\t\t\tif(query_params.prepared_report_name) {\n\t\t\t\t\tthis.prepared_report_action = \"Edit\";\n\t\t\t\t\tconst filters_from_report = JSON.parse(data.doc.filters);\n\t\t\t\t\tObject.values(this.filters).forEach(function(field) {\n\t\t\t\t\t\tif (filters_from_report[field.fieldname]) {\n\t\t\t\t\t\t\tfield.set_input(filters_from_report[field.fieldname]);\n\t\t\t\t\t\t}\n\t\t\t\t\t\tfield.input.disabled = true;\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t\tthis.add_prepared_report_buttons(data.doc);\n\t\t\t}\n\t\t\tthis.toggle_message(false);\n\t\t\tif (data.result && data.result.length) {\n\t\t\t\tthis.prepare_report_data(data);\n\n\t\t\t\tconst chart_options = this.get_chart_options(data);\n\t\t\t\tthis.$chart.empty();\n\t\t\t\tif(chart_options) {\n\t\t\t\t\tthis.render_chart(chart_options);\n\t\t\t\t}\n\n\t\t\t\tthis.render_datatable();\n\t\t\t} else {\n\t\t\t\tthis.data = [];\n\t\t\t\tthis.toggle_nothing_to_show(true);\n\t\t\t}\n\n\t\t\tthis.show_footer_message();\n\t\t\tfrappe.hide_progress();\n\t\t});\n\t}\n\n\tadd_prepared_report_buttons(doc) {\n\t\tif(doc){\n\t\t\tthis.page.add_inner_button(__(\"Download Report\"), function (){\n\t\t\t\twindow.open(\n\t\t\t\t\tfrappe.urllib.get_full_url(\n\t\t\t\t\t\t\"/api/method/frappe.core.doctype.prepared_report.prepared_report.download_attachment?\"\n\t\t\t\t\t\t+\"dn=\"+encodeURIComponent(doc.name)));\n\t\t\t});\n\n\t\t\tconst part1 = __('This report was generated {0}.', [frappe.datetime.comment_when(doc.report_end_time)]);\n\t\t\tconst part2 = __('To get the updated report, click on {0}.', [__('Rebuild')]);\n\t\t\tconst part3 = __('See all past reports.');\n\n\t\t\tthis.show_status(`\n\t\t\t\t<span class=\"indicator orange\">\n\t\t\t\t\t${part1}\n\t\t\t\t\t${part2}\n\t\t\t\t\t<a href=\"#List/Prepared%20Report?report_name=${this.report_name}\">${part3}</a>\n\t\t\t\t</span>\n\t\t\t`);\n\t\t};\n\n\t\t// Three cases\n\t\t// 1. First time with given filters, no data.\n\t\t// 2. Showing data from specific report\n\t\t// 3. Showing data from an old report without specific report name\n\t\tif(this.prepared_report_action == \"New\") {\n\t\t\tthis.page.set_primary_action(\n\t\t\t\t__(\"Generate New Report\"),\n\t\t\t\t() => {\n\t\t\t\t\tthis.generate_background_report();\n\t\t\t\t}\n\t\t\t);\n\t\t} else if(this.prepared_report_action == \"Edit\") {\n\t\t\tthis.page.set_primary_action(\n\t\t\t\t__(\"Edit\"),\n\t\t\t\t() => {\n\t\t\t\t\tfrappe.set_route(frappe.get_route());\n\t\t\t\t}\n\t\t\t);\n\t\t} else if(this.prepared_report_action == \"Rebuild\"){\n\t\t\tthis.page.set_primary_action(\n\t\t\t\t__(\"Rebuild\"),\n\t\t\t\tthis.generate_background_report.bind(this)\n\t\t\t);\n\t\t}\n\t}\n\n\tgenerate_background_report() {\n\t\tlet mandatory = this.filters.filter(f => f.df.reqd);\n\t\tlet missing_mandatory = mandatory.filter(f => !f.get_value());\n\t\tif (!missing_mandatory.length){\n\t\t\tlet filters = this.get_filter_values(true);\n\t\t\treturn new Promise(resolve => frappe.call({\n\t\t\t\tmethod: 'frappe.desk.query_report.background_enqueue_run',\n\t\t\t\ttype: 'GET',\n\t\t\t\targs: {\n\t\t\t\t\treport_name: this.report_name,\n\t\t\t\t\tfilters: filters\n\t\t\t\t},\n\t\t\t\tcallback: resolve\n\t\t\t})).then(r => {\n\t\t\t\tconst data = r.message;\n\t\t\t\t// Rememeber the name of Prepared Report doc\n\t\t\t\tthis.prepared_report_doc_name = data.name;\n\t\t\t\tlet alert_message = `Report initiated. You can track its status\n\t\t\t\t\t<a class='text-info' href='#Form/Prepared Report/${data.name}'>here</a>`;\n\t\t\t\tfrappe.show_alert({message: alert_message, indicator: 'orange'});\n\t\t\t\tthis.toggle_nothing_to_show(true);\n\t\t\t});\n\t\t}\n\t}\n\n\tprepare_report_data(data) {\n\t\tthis.raw_data = data;\n\t\tthis.columns = this.prepare_columns(data.columns);\n\t\tthis.data = this.prepare_data(data.result);\n\t\tthis.linked_doctypes = this.get_linked_doctypes();\n\t\tthis.tree_report = this.data.some(d => 'indent' in d);\n\t}\n\n\trender_datatable() {\n\t\tlet data = this.data;\n\n\t\tif (this.raw_data.add_total_row) {\n\t\t\tdata = data.slice();\n\t\t\tdata.splice(-1, 1);\n\t\t}\n\n\t\tif (this.datatable) {\n\t\t\tthis.datatable.options.treeView = this.tree_report;\n\t\t\tthis.datatable.refresh(data, this.columns);\n\t\t} else {\n\t\t\tlet datatable_options = {\n\t\t\t\tcolumns: this.columns,\n\t\t\t\tdata: data,\n\t\t\t\tinlineFilters: true,\n\t\t\t\ttreeView: this.tree_report,\n\t\t\t\tlayout: 'fixed',\n\t\t\t\tcellHeight: 33,\n\t\t\t\tshowTotalRow: this.raw_data.add_total_row,\n\t\t\t\tdirection: frappe.utils.is_rtl() ? 'rtl' : 'ltr',\n\t\t\t\thooks: {\n\t\t\t\t\tcolumnTotal: frappe.utils.report_column_total\n\t\t\t\t}\n\t\t\t};\n\n\t\t\tif (this.report_settings.get_datatable_options) {\n\t\t\t\tdatatable_options = this.report_settings.get_datatable_options(datatable_options);\n\t\t\t}\n\t\t\tthis.datatable = new DataTable(this.$report[0], datatable_options);\n\t\t}\n\n\t\tif (typeof this.report_settings.initial_depth == \"number\") {\n\t\t\tthis.datatable.rowmanager.setTreeDepth(this.report_settings.initial_depth);\n\t\t}\n\t\tif (this.report_settings.after_datatable_render) {\n\t\t\tthis.report_settings.after_datatable_render(this.datatable);\n\t\t}\n\t}\n\n\tget_chart_options(data) {\n\t\tlet options = this.report_settings.get_chart_data\n\t\t\t? this.report_settings.get_chart_data(data.columns, data.result)\n\t\t\t: data.chart\n\t\t\t\t? data.chart\n\t\t\t\t: undefined;\n\n\t\tif (!(options && options.data && options.data.labels && options.data.labels.length > 0)) return;\n\n\t\treturn options;\n\t}\n\n\trender_chart(options, height=200) {\n\t\tObject.assign(options, {\n\t\t\theight: height\n\t\t});\n\n\t\tthis.$chart.empty();\n\t\tthis.chart = new Chart(this.$chart[0], options);\n\t\tthis.$chart.show();\n\t}\n\n\tget_possible_chart_options() {\n\t\tconst columns = this.raw_data.columns;\n\t\tconst rows =  this.raw_data.result.filter(value => Object.keys(value).length);\n\t\tconst first_row = Array.isArray(rows[0]) ? rows[0] : Object.values(rows[0]);\n\t\tconst has_total_row = this.raw_data.add_total_row;\n\n\t\tconst indices = first_row.reduce((accumulator, current_value, current_index) => {\n\t\t\tif(!isNaN(Number(current_value))) {\n\t\t\t\taccumulator.push(current_index);\n\t\t\t}\n\t\t\treturn accumulator;\n\t\t}, []);\n\n\t\tfunction get_column_values(column_name) {\n\t\t\treturn rows.map(row => row[column_name]);\n\t\t}\n\n\t\tfunction make_chart_options({ y_field, x_field, chart_type, color }) {\n\t\t\tconst type = chart_type.toLowerCase();\n\t\t\tconst colors = color ? [color] : undefined;\n\n\t\t\tlet labels = get_column_values(x_field);\n\n\t\t\tlet dataset_values = get_column_values(y_field).map(d => Number(d));\n\n\t\t\tif(has_total_row) {\n\t\t\t\tlabels = labels.slice(0, -1);\n\t\t\t\tdataset_values = dataset_values.slice(0, -1);\n\t\t\t}\n\n\t\t\treturn {\n\t\t\t\tdata: {\n\t\t\t\t\tlabels: labels,\n\t\t\t\t\tdatasets: [\n\t\t\t\t\t\t{ values: dataset_values }\n\t\t\t\t\t]\n\t\t\t\t},\n\t\t\t\ttype: type,\n\t\t\t\tcolors: colors\n\t\t\t};\n\t\t}\n\n\t\tfunction preview_chart() {\n\t\t\tconst wrapper = $(dialog.fields_dict[\"chart_preview\"].wrapper);\n\t\t\tconst values = dialog.get_values(true);\n\t\t\tlet options = make_chart_options(values);\n\n\t\t\tObject.assign(options, {\n\t\t\t\theight: 150\n\t\t\t});\n\n\t\t\twrapper.empty();\n\t\t\tnew Chart(wrapper[0], options);\n\t\t\twrapper.find('.chart-container .title, .chart-container .sub-title').hide();\n\t\t\twrapper.show();\n\t\t}\n\n\t\tfunction get_options(fields) {\n\t\t\treturn fields.map((field) => {\n\t\t\t\treturn {label: field.label, value: field.fieldname};\n\t\t\t});\n        }\n\n\t\tconst numeric_fields = columns.filter((col, i) => indices.includes(i));\n\t\tconst non_numeric_fields = columns.filter((col, i) => !indices.includes(i))\n\n\t\tconst dialog = new frappe.ui.Dialog({\n\t\t\ttitle: __('Make Chart'),\n\t\t\tfields: [\n\t\t\t\t{\n\t\t\t\t\tfieldname: 'y_field',\n\t\t\t\t\tlabel: 'Y Field',\n\t\t\t\t\tfieldtype: 'Select',\n\t\t\t\t\toptions: get_options(numeric_fields),\n\t\t\t\t\tonchange: preview_chart\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tfieldname: 'x_field',\n\t\t\t\t\tlabel: 'X Field',\n\t\t\t\t\tfieldtype: 'Select',\n\t\t\t\t\toptions: get_options(non_numeric_fields),\n\t\t\t\t\tonchange: preview_chart\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tfieldname: 'cb_1',\n\t\t\t\t\tfieldtype: 'Column Break'\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tfieldname: 'chart_type',\n\t\t\t\t\tlabel: 'Type of Chart',\n\t\t\t\t\tfieldtype: 'Select',\n\t\t\t\t\toptions: ['Bar', 'Line', 'Percentage', 'Pie'],\n\t\t\t\t\tdefault: 'Bar',\n\t\t\t\t\tonchange: preview_chart\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tfieldname: 'color',\n\t\t\t\t\tlabel: 'Color',\n\t\t\t\t\tfieldtype: 'Color',\n\t\t\t\t\tdepends_on: doc => ['Bar', 'Line'].includes(doc.chart_type),\n\t\t\t\t\tonchange: preview_chart,\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tfieldname: 'sb_1',\n\t\t\t\t\tfieldtype: 'Section Break',\n\t\t\t\t\tlabel: 'Chart Preview'\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tfieldname: 'chart_preview',\n\t\t\t\t\tlabel: 'Chart Preview',\n\t\t\t\t\tfieldtype: 'HTML',\n\t\t\t\t}\n\t\t\t],\n\t\t\tprimary_action_label: __('Make'),\n\t\t\tprimary_action: (values) => {\n\t\t\t\tlet options = make_chart_options(values);\n\n\t\t\t\toptions.title = __(`${this.report_name}: ${numeric_fields.filter((field) => field.fieldname == values.y_field)[0].label} vs ${non_numeric_fields.filter((field) => field.fieldname == values.x_field)[0].label}`);\n\n\t\t\t\tthis.render_chart(options);\n\n\t\t\t\tdialog.hide();\n\t\t\t}\n\t\t});\n\n\t\tdialog.show();\n\n\t\t// load preview after dialog animation\n\t\tsetTimeout(preview_chart, 500);\n\t}\n\n\tget_user_settings() {\n\t\treturn frappe.model.user_settings.get(this.report_name)\n\t\t\t.then(user_settings => {\n\t\t\t\tthis.user_settings = user_settings;\n\t\t\t});\n\t}\n\n\tprepare_columns(columns) {\n\t\treturn columns.map(column => {\n\t\t\tif (typeof column === 'string') {\n\t\t\t\tif (column.includes(':')) {\n\t\t\t\t\tlet [label, fieldtype, width] = column.split(':');\n\t\t\t\t\tlet options;\n\n\t\t\t\t\tif (fieldtype.includes('/')) {\n\t\t\t\t\t\t[fieldtype, options] = fieldtype.split('/');\n\t\t\t\t\t}\n\n\t\t\t\t\tcolumn = {\n\t\t\t\t\t\tlabel,\n\t\t\t\t\t\tfieldname: label,\n\t\t\t\t\t\tfieldtype,\n\t\t\t\t\t\twidth,\n\t\t\t\t\t\toptions\n\t\t\t\t\t};\n\t\t\t\t} else {\n\t\t\t\t\tcolumn = {\n\t\t\t\t\t\tlabel: column,\n\t\t\t\t\t\tfieldname: column,\n\t\t\t\t\t\tfieldtype: 'Data'\n\t\t\t\t\t};\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tconst format_cell = (value, row, column, data) => {\n\t\t\t\treturn frappe.format(value, column,\n\t\t\t\t\t{for_print: false, always_show_decimals: true}, data);\n\t\t\t};\n\n\t\t\tlet compareFn = null;\n\t\t\tif (column.fieldtype === 'Date') {\n\t\t\t\tcompareFn = (cell, keyword) => {\n\t\t\t\t\tif (!cell.content) return null;\n\t\t\t\t\tif (keyword.length !== 'YYYY-MM-DD'.length) return null;\n\n\t\t\t\t\tconst keywordValue = frappe.datetime.user_to_obj(keyword);\n\t\t\t\t\tconst cellValue = frappe.datetime.str_to_obj(cell.content);\n\t\t\t\t\treturn [+cellValue, +keywordValue];\n\t\t\t\t};\n\t\t\t}\n\n\t\t\treturn Object.assign(column, {\n\t\t\t\tid: column.fieldname,\n\t\t\t\tname: column.label,\n\t\t\t\twidth: parseInt(column.width) || null,\n\t\t\t\teditable: false,\n\t\t\t\tcompareValue: compareFn,\n\t\t\t\tformat: (value, row, column, data) => {\n\t\t\t\t\tif (this.report_settings.formatter) {\n\t\t\t\t\t\treturn this.report_settings.formatter(value, row, column, data, format_cell);\n\t\t\t\t\t}\n\t\t\t\t\treturn format_cell(value, row, column, data);\n\t\t\t\t}\n\t\t\t});\n\t\t});\n\t}\n\n\tprepare_data(data) {\n\t\treturn data.map(row => {\n\t\t\tlet row_obj = {};\n\t\t\tif (Array.isArray(row)) {\n\t\t\t\tthis.columns.forEach((column, i) => {\n\t\t\t\t\trow_obj[column.id] = row[i];\n\t\t\t\t});\n\n\t\t\t\treturn row_obj;\n\t\t\t}\n\t\t\treturn row;\n\t\t});\n\t}\n\n\tget_visible_columns() {\n\t\tconst visible_column_ids = this.datatable.datamanager.getColumns(true).map(col => col.id);\n\n\t\treturn visible_column_ids\n\t\t\t.map(id => this.columns.find(col => col.id === id))\n\t\t\t.filter(Boolean);\n\t}\n\n\tget_filter_values(raise) {\n\t\tconst mandatory = this.filters.filter(f => f.df.reqd);\n\t\tconst missing_mandatory = mandatory.filter(f => !f.get_value());\n\t\tif (raise && missing_mandatory.length > 0) {\n\t\t\tlet message = __('Please set filters');\n\t\t\tthis.toggle_message(raise, message);\n\t\t\tthrow \"Filter missing\";\n\t\t}\n\n\t\tconst filters = this.filters\n\t\t\t.filter(f => f.get_value())\n\t\t\t.map(f => {\n\t\t\t\tvar v = f.get_value();\n\t\t\t\t// hidden fields dont have $input\n\t\t\t\tif(f.df.hidden) v = f.value;\n\t\t\t\tif(v === '%') v = null;\n\t\t\t\treturn {\n\t\t\t\t\t[f.df.fieldname]: v\n\t\t\t\t};\n\t\t\t})\n\t\t\t.reduce((acc, f) => {\n\t\t\t\tObject.assign(acc, f);\n\t\t\t\treturn acc;\n\t\t\t}, {});\n\t\treturn filters;\n\t}\n\n\tget_filter(fieldname) {\n\t\tconst field = (this.filters || []).find(f => f.df.fieldname === fieldname);\n\t\tif (!field) {\n\t\t\tconsole.warn(`[Query Report] Invalid filter: ${fieldname}`);\n\t\t}\n\t\treturn field;\n\t}\n\n\tget_filter_value(fieldname) {\n\t\tconst field = this.get_filter(fieldname);\n\t\treturn field ? field.get_value() : null;\n\t}\n\n\tset_filter_value(fieldname, value) {\n\t\tlet field_value_map = {};\n\t\tif (typeof fieldname === 'string') {\n\t\t\tfield_value_map[fieldname] = value;\n\t\t} else {\n\t\t\tfield_value_map = fieldname;\n\t\t}\n\n\t\tthis._no_refresh = true;\n\t\tObject.keys(field_value_map)\n\t\t\t.forEach((fieldname, i, arr) => {\n\t\t\t\tconst value = field_value_map[fieldname];\n\n\t\t\t\tif (i === arr.length - 1) {\n\t\t\t\t\tthis._no_refresh = false;\n\t\t\t\t}\n\n\t\t\t\tthis.get_filter(fieldname).set_value(value);\n\t\t\t});\n\t}\n\n\tset_breadcrumbs() {\n\t\tif (!this.report_doc || !this.report_doc.ref_doctype) return;\n\t\tconst ref_doctype = frappe.get_meta(this.report_doc.ref_doctype);\n\t\tfrappe.breadcrumbs.add(ref_doctype.module);\n\t}\n\n\tprint_report(print_settings) {\n\t\tconst custom_format = this.report_settings.html_format || null;\n\t\tconst filters_html = this.get_filters_html_for_print();\n\t\tconst landscape = print_settings.orientation == 'Landscape';\n\n\t\tfrappe.render_grid({\n\t\t\ttemplate: custom_format,\n\t\t\ttitle: __(this.report_name),\n\t\t\tsubtitle: filters_html,\n\t\t\tprint_settings: print_settings,\n\t\t\tlandscape: landscape,\n\t\t\tfilters: this.get_filter_values(),\n\t\t\tdata: this.get_data_for_print(),\n\t\t\tcolumns: custom_format ? this.columns : this.get_columns_for_print(),\n\t\t\toriginal_data: this.data,\n\t\t\treport: this\n\t\t});\n\t}\n\n\tpdf_report(print_settings) {\n\t\tconst base_url = frappe.urllib.get_base_url();\n\t\tconst print_css = frappe.boot.print_css;\n\t\tconst landscape = print_settings.orientation == 'Landscape';\n\n\t\tconst custom_format = this.report_settings.html_format || null;\n\t\tconst columns = custom_format ? this.columns : this.get_columns_for_print();\n\t\tconst data = this.get_data_for_print();\n\t\tconst applied_filters = this.get_filter_values();\n\n\t\tconst filters_html = this.get_filters_html_for_print();\n\t\tconst content = frappe.render_template(custom_format || 'print_grid', {\n\t\t\ttitle: __(this.report_name),\n\t\t\tsubtitle: filters_html,\n\t\t\tfilters: applied_filters,\n\t\t\tdata: data,\n\t\t\toriginal_data: this.data,\n\t\t\tcolumns: columns,\n\t\t\treport: this\n\t\t});\n\n\t\t// Render Report in HTML\n\t\tconst html = frappe.render_template('print_template', {\n\t\t\ttitle: __(this.report_name),\n\t\t\tcontent: content,\n\t\t\tbase_url: base_url,\n\t\t\tprint_css: print_css,\n\t\t\tprint_settings: print_settings,\n\t\t\tlandscape: landscape,\n\t\t\tcolumns: columns\n\t\t});\n\n\t\tfrappe.render_pdf(html, print_settings);\n\t}\n\n\tget_filters_html_for_print() {\n\t\tconst applied_filters = this.get_filter_values();\n\t\treturn Object.keys(applied_filters)\n\t\t\t.map(fieldname => {\n\t\t\t\tconst label = frappe.query_report.get_filter(fieldname).df.label;\n\t\t\t\tconst value = applied_filters[fieldname];\n\t\t\t\treturn `<h6>${__(label)}: ${value}</h6>`;\n\t\t\t})\n\t\t\t.join('');\n\t}\n\n\texport_report() {\n\t\tif (this.export_dialog) {\n\t\t\tthis.export_dialog.clear();\n\t\t\tthis.export_dialog.show();\n\t\t\treturn;\n\t\t}\n\n\t\tthis.export_dialog = frappe.prompt([\n\t\t\t{\n\t\t\t\tlabel: __('Select File Format'),\n\t\t\t\tfieldname: 'file_format',\n\t\t\t\tfieldtype: 'Select',\n\t\t\t\toptions: ['Excel', 'CSV'],\n\t\t\t\tdefault: 'Excel',\n\t\t\t\treqd: 1,\n\t\t\t\tonchange: () => {\n\t\t\t\t\tthis.export_dialog.set_df_property('with_indentation',\n\t\t\t\t\t\t'hidden', this.export_dialog.get_value('file_format') !== 'CSV');\n\t\t\t\t}\n\t\t\t},\n\t\t\t{\n\t\t\t\tlabel: __('With Group Indentation'),\n\t\t\t\tfieldname: 'with_indentation',\n\t\t\t\tfieldtype: 'Check',\n\t\t\t\thidden: 1\n\t\t\t}\n\t\t], ({ file_format, with_indentation }) => {\n\t\t\tif (file_format === 'CSV') {\n\t\t\t\tconst column_row = this.columns.map(col => col.label);\n\t\t\t\tconst data = this.get_data_for_csv(with_indentation);\n\t\t\t\tconst out = [column_row].concat(data);\n\n\t\t\t\tfrappe.tools.downloadify(out, null, this.report_name);\n\t\t\t} else {\n\t\t\t\tlet filters = this.get_filter_values(true);\n\t\t\t\tif (frappe.urllib.get_dict(\"prepared_report_name\")) {\n\t\t\t\t\tfilters = Object.assign(frappe.urllib.get_dict(\"prepared_report_name\"), filters);\n\t\t\t\t}\n\n\t\t\t\tconst visible_idx = this.datatable.datamanager.getFilteredRowIndices();\n\t\t\t\tif (visible_idx.length + 1 === this.data.length) {\n\t\t\t\t\tvisible_idx.push(visible_idx.length);\n\t\t\t\t}\n\n\t\t\t\tconst args = {\n\t\t\t\t\tcmd: 'frappe.desk.query_report.export_query',\n\t\t\t\t\treport_name: this.report_name,\n\t\t\t\t\tfile_format_type: file_format,\n\t\t\t\t\tfilters: filters,\n\t\t\t\t\tvisible_idx: visible_idx,\n\t\t\t\t};\n\n\t\t\t\topen_url_post(frappe.request.url, args);\n\t\t\t}\n\t\t}, __('Export Report: '+ this.report_name), __('Download'));\n\t}\n\n\tget_data_for_csv(with_indentation = false) {\n\n\t\tconst indices = this.datatable.datamanager.getFilteredRowIndices();\n\t\tconst rows = indices.map(i => this.datatable.datamanager.getRow(i));\n\t\treturn rows.map(row => {\n\t\t\tconst standard_column_count = this.datatable.datamanager.getStandardColumnCount();\n\t\t\treturn row\n\t\t\t\t.slice(standard_column_count)\n\t\t\t\t.map((cell, i) => {\n\t\t\t\tif (with_indentation && i === 0) {\n\t\t\t\t\treturn '   '.repeat(row.meta.indent) + cell.content;\n\t\t\t\t}\n\t\t\t\treturn cell.content;\n\t\t\t});\n\t\t});\n\t}\n\n\tget_data_for_print() {\n\n\t\tif (!this.data.length) {\n\t\t\treturn [];\n\t\t}\n\n\t\tconst rows = this.datatable.datamanager.rowViewOrder.map(index => {\n\t\t\tif (this.datatable.bodyRenderer.visibleRowIndices.includes(index)) {\n\t\t\t\treturn this.data[index];\n\t\t\t}\n\t\t}).filter(Boolean);\n\t\tlet totalRow = this.datatable.bodyRenderer.getTotalRow().reduce((row, cell) => {\n\t\t\trow[cell.column.id] = cell.content;\n\t\t\treturn row;\n\t\t}, {});\n\t\trows.push(totalRow);\n\t\treturn rows;\n\t}\n\n\tget_columns_for_print() {\n\t\treturn this.get_visible_columns();\n\t}\n\n\tget_menu_items() {\n\t\treturn [\n\t\t\t{\n\t\t\t\tlabel: __('Refresh'),\n\t\t\t\taction: () => this.refresh(),\n\t\t\t\tclass: 'visible-xs'\n\t\t\t},\n\t\t\t{\n\t\t\t\tlabel: __('Edit'),\n\t\t\t\taction: () => frappe.set_route('Form', 'Report', this.report_name),\n\t\t\t\tcondition: () => frappe.user.is_report_manager(),\n\t\t\t\tstandard: true\n\t\t\t},\n\t\t\t{\n\t\t\t\tlabel: __('Print'),\n\t\t\t\taction: () => {\n\t\t\t\t\tfrappe.ui.get_print_settings(\n\t\t\t\t\t\tfalse,\n\t\t\t\t\t\tprint_settings => this.print_report(print_settings),\n\t\t\t\t\t\tthis.report_doc.letter_head\n\t\t\t\t\t);\n\t\t\t\t},\n\t\t\t\tcondition: () => frappe.model.can_print(this.report_doc.ref_doctype),\n\t\t\t\tstandard: true\n\t\t\t},\n\t\t\t{\n\t\t\t\tlabel: __('PDF'),\n\t\t\t\taction: () => {\n\t\t\t\t\tfrappe.ui.get_print_settings(\n\t\t\t\t\t\tfalse,\n\t\t\t\t\t\tprint_settings => this.pdf_report(print_settings),\n\t\t\t\t\t\tthis.report_doc.letter_head\n\t\t\t\t\t);\n\t\t\t\t},\n\t\t\t\tcondition: () => frappe.model.can_print(this.report_doc.ref_doctype),\n\t\t\t\tstandard: true\n\t\t\t},\n\t\t\t{\n\t\t\t\tlabel: __('Export'),\n\t\t\t\taction: () => this.export_report(),\n\t\t\t\tcondition: () => frappe.model.can_export(this.report_doc.ref_doctype),\n\t\t\t\tstandard: true\n\t\t\t},\n\t\t\t{\n\t\t\t\tlabel: __('Setup Auto Email'),\n\t\t\t\taction: () => frappe.set_route('List', 'Auto Email Report', {'report' : this.report_name}),\n\t\t\t\tstandard: true\n\t\t\t},\n\t\t\t{\n\t\t\t\tlabel: __('Add Column'),\n\t\t\t\taction: () => {\n\t\t\t\t\tlet d = new frappe.ui.Dialog({\n\t\t\t\t\t\ttitle: __('Add Column'),\n\t\t\t\t\t\tfields: [\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tfieldtype: 'Select',\n\t\t\t\t\t\t\t\tfieldname: 'doctype',\n\t\t\t\t\t\t\t\tlabel: __('From Document Type'),\n\t\t\t\t\t\t\t\toptions: this.linked_doctypes.map(df => ({ label: df.doctype, value: df.doctype })),\n\t\t\t\t\t\t\t\tchange: () => {\n\t\t\t\t\t\t\t\t\tlet doctype = d.get_value('doctype');\n\t\t\t\t\t\t\t\t\tfrappe.model.with_doctype(doctype, () => {\n\t\t\t\t\t\t\t\t\t\tlet options = frappe.meta.get_docfields(doctype)\n\t\t\t\t\t\t\t\t\t\t\t.filter(frappe.model.is_value_type)\n\t\t\t\t\t\t\t\t\t\t\t.map(df => ({ label: df.label, value: df.fieldname }));\n\n\t\t\t\t\t\t\t\t\t\td.set_df_property('field', 'options', options);\n\n\t\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tfieldtype: 'Select',\n\t\t\t\t\t\t\t\tlabel: __('Field'),\n\t\t\t\t\t\t\t\tfieldname: 'field',\n\t\t\t\t\t\t\t\toptions: []\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tfieldtype: 'Select',\n\t\t\t\t\t\t\t\tlabel: __('Insert After'),\n\t\t\t\t\t\t\t\tfieldname: 'insert_after',\n\t\t\t\t\t\t\t\toptions: this.columns.map(df => df.label)\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t],\n\t\t\t\t\t\tprimary_action: (values) => {\n\t\t\t\t\t\t\tconst custom_columns = [];\n\t\t\t\t\t\t\tlet df = frappe.meta.get_docfield(values.doctype, values.field);\n\t\t\t\t\t\t\tcustom_columns.push({\n\t\t\t\t\t\t\t\tfieldname: df.fieldname,\n\t\t\t\t\t\t\t\tfieldtype: df.fieldtype,\n\t\t\t\t\t\t\t\tlabel: df.label,\n\t\t\t\t\t\t\t\tlink_field: this.doctype_field_map[values.doctype],\n\t\t\t\t\t\t\t\tdoctype: values.doctype,\n\t\t\t\t\t\t\t\toptions: df.fieldtype === \"Link\" ? frappe.model.unscrub(df.fieldname) : undefined,\n\t\t\t\t\t\t\t\twidth: 100\n\t\t\t\t\t\t\t});\n\n\t\t\t\t\t\t\tfrappe.call({\n\t\t\t\t\t\t\t\tmethod: 'frappe.desk.query_report.get_data_for_custom_field',\n\t\t\t\t\t\t\t\targs: {\n\t\t\t\t\t\t\t\t\tfield: values.field,\n\t\t\t\t\t\t\t\t\tdoctype: values.doctype\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\tcallback: (r) => {\n\t\t\t\t\t\t\t\t\tconst custom_data = r.message;\n\t\t\t\t\t\t\t\t\tconst link_field = this.doctype_field_map[values.doctype];\n\t\t\t\t\t\t\t\t\tthis.add_custom_column(custom_columns, custom_data, link_field, values.field, values.insert_after);\n\t\t\t\t\t\t\t\t\td.hide();\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\tthis.show_save = true;\n\t\t\t\t\t\t\tthis.set_menu_items();\n\t\t\t\t\t\t}\n\t\t\t\t\t})\n\n\t\t\t\t\td.show();\n\t\t\t\t},\n\t\t\t\tstandard: true\n\t\t\t},\n\t\t\t{\n\t\t\t\tlabel: __('Save'),\n\t\t\t\taction: () => {\n\t\t\t\t\tlet d = new frappe.ui.Dialog({\n\t\t\t\t\t\ttitle: __('Save Report'),\n\t\t\t\t\t\tfields: [\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tfieldtype: 'Data',\n\t\t\t\t\t\t\t\tfieldname: 'report_name',\n\t\t\t\t\t\t\t\tlabel: __(\"Report Name\"),\n\t\t\t\t\t\t\t\tdefault: this.report_doc.is_standard == 'No' ? this.report_name : \"\",\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t],\n\t\t\t\t\t\tprimary_action: (values) => {\n\t\t\t\t\t\t\tfrappe.call({\n\t\t\t\t\t\t\t\tmethod: \"frappe.desk.query_report.save_report\",\n\t\t\t\t\t\t\t\targs: {\n\t\t\t\t\t\t\t\t\treference_report: this.report_name,\n\t\t\t\t\t\t\t\t\treport_name: values.report_name,\n\t\t\t\t\t\t\t\t\tcolumns: this.columns\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\tcallback: function(r) {\n\t\t\t\t\t\t\t\t\tthis.show_save = false;\n\t\t\t\t\t\t\t\t\td.hide();\n\t\t\t\t\t\t\t\t\tfrappe.set_route('query-report', r.message);\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t\td.show();\n\t\t\t\t},\n\t\t\t\tcondition: () => this.show_save,\n\t\t\t\tstandard: true\n\t\t\t},\n\t\t\t{\n\t\t\t\tlabel: __('User Permissions'),\n\t\t\t\taction: () => frappe.set_route('List', 'User Permission', {\n\t\t\t\t\tdoctype: 'Report',\n\t\t\t\t\tname: this.report_name\n\t\t\t\t}),\n\t\t\t\tcondition: () => frappe.model.can_set_user_permissions('Report'),\n\t\t\t\tstandard: true\n\t\t\t},\n\t\t\t{\n\t\t\t\tlabel: __('Add to Desktop'),\n\t\t\t\taction: () => frappe.add_to_desktop(this.report_name, null, this.report_name),\n\t\t\t\tstandard: true\n\t\t\t},\n\t\t];\n\t}\n\n\tadd_custom_column(custom_column, custom_data, link_field, column_field, insert_after) {\n\t\tconst column = this.prepare_columns(custom_column);\n\n\t\tconst insert_after_index = this.columns\n\t\t\t.findIndex(column => column.label === insert_after);\n\t\tthis.columns.splice(insert_after_index + 1, 0, column[0]);\n\n\t\tthis.data.forEach(row => {\n\t\t\trow[column_field] = custom_data[row[link_field]];\n\t\t});\n\n\t\tthis.render_datatable();\n\t}\n\n\tget_linked_doctypes() {\n\t\tlet doctypes = [];\n\t\tlet dynamic_links = [];\n\t\tlet dynamic_doctypes = new Set();\n\t\tthis.doctype_field_map = {};\n\n\t\tthis.columns.forEach(df => {\n\t\t\tif (df.fieldtype == \"Link\" && df.options && df.options != \"Currency\") {\n\t\t\t\tdoctypes.push({\n\t\t\t\t\tdoctype: df.options,\n\t\t\t\t\tfieldname: df.fieldname\n\t\t\t\t});\n\t\t\t}\n\t\t\telse if (df.fieldtype == \"Dynamic Link\" && df.options) {\n\t\t\t\tdynamic_links.push({\n\t\t\t\t\tlink_name: df.options,\n\t\t\t\t\tfieldname: df.fieldname\n\t\t\t\t});\n\t\t\t}\n\t\t});\n\n\t\tthis.data.forEach(row => {\n\t\t\tdynamic_links.forEach(field => {\n\t\t\t\tif (row[field.link_name]){\n\t\t\t\t\tdynamic_doctypes.add(row[field.link_name] + \":\" + field.fieldname);\n\t\t\t\t}\n\t\t\t});\n\t\t});\n\n\t\tdoctypes = doctypes.concat(Array.from(dynamic_doctypes).map(d => {\n\t\t\tconst doc_field_pair = d.split(\":\");\n\t\t\treturn {\n\t\t\t\tdoctype: doc_field_pair[0],\n\t\t\t\tfieldname: doc_field_pair[1]\n\t\t\t};\n\t\t}));\n\n\t\tdoctypes.forEach(doc => {\n\t\t\tthis.doctype_field_map[doc.doctype] = doc.fieldname;\n\t\t});\n\n\t\treturn doctypes;\n\t}\n\n\tsetup_report_wrapper() {\n\t\tif (this.$report) return;\n\n\t\tlet page_form = this.page.main.find('.page-form');\n\t\tthis.$status = $(`<div class=\"form-message text-muted small\"></div>`)\n\t\t\t.hide().insertAfter(page_form);\n\n\t\tthis.$chart = $('<div class=\"chart-wrapper\">').hide().appendTo(this.page.main);\n\t\tthis.$report = $('<div class=\"report-wrapper\">').appendTo(this.page.main);\n\t\tthis.$message = $(this.message_div('')).hide().appendTo(this.page.main);\n\t}\n\n\tshow_status(status_message) {\n\t\tthis.$status.html(status_message).show();\n\t}\n\n\thide_status() {\n\t\tthis.$status.hide();\n\t}\n\n\tshow_footer_message() {\n\t\tconst message = __('For comparison, use >5, <10 or =324. For ranges, use 5:10 (for values between 5 & 10).');\n\t\tconst execution_time_msg = __('Execution Time: {0} sec', [this.execution_time || 0.1]);\n\n\t\tthis.page.footer.removeClass('hide').addClass('text-muted col-md-12').html(`\n\t\t\t<span class=\"text-left col-md-6\">${message}</span><span class=\"text-right col-md-6\">${execution_time_msg}</span>\n\t\t`);\n\n\t\tthis.page.wrapper.find('.tree-footer').remove();\n\t\tif (this.tree_report) {\n\t\t\tthis.$tree_footer = this.page.footer.clone().addClass('tree-footer');\n\t\t\tthis.$tree_footer.html(`<div class=\"col-md-12\">\n\t\t\t\t<button class=\"btn btn-xs btn-default\" data-action=\"expand_all_rows\">\n\t\t\t\t\t${__('Expand All')}</button>\n\t\t\t\t<button class=\"btn btn-xs btn-default\" data-action=\"collapse_all_rows\">\n\t\t\t\t\t${__('Collapse All')}</button>\n\t\t\t</div>`);\n\t\t\tthis.page.footer.before(this.$tree_footer);\n\t\t\tthis.$tree_footer.find('[data-action=collapse_all_rows]').show();\n\t\t\tthis.$tree_footer.find('[data-action=expand_all_rows]').hide();\n\t\t}\n\t}\n\n\texpand_all_rows() {\n\t\tthis.$tree_footer.find('[data-action=expand_all_rows]').hide();\n\t\tthis.datatable.rowmanager.expandAllNodes();\n\t\tthis.$tree_footer.find('[data-action=collapse_all_rows]').show();\n\t}\n\n\tcollapse_all_rows() {\n\t\tthis.$tree_footer.find('[data-action=collapse_all_rows]').hide();\n\t\tthis.datatable.rowmanager.collapseAllNodes();\n\t\tthis.$tree_footer.find('[data-action=expand_all_rows]').show();\n\t}\n\n\tmessage_div(message) {\n\t\treturn `<div class='flex justify-center align-center text-muted' style='height: 50vh;'>\n\t\t\t<div>${message}</div>\n\t\t</div>`;\n\t}\n\n\treset_report_view() {\n\t\tthis.hide_status();\n\t\tthis.toggle_nothing_to_show(true);\n\t\tthis.refresh();\n\t}\n\n\ttoggle_loading(flag) {\n\t\tthis.toggle_message(flag, __('Loading') + '...');\n\t}\n\n\n\ttoggle_nothing_to_show(flag) {\n\t\tlet message = this.prepared_report\n\t\t\t? __('This is a background report. Please set the appropriate filters and then generate a new one.')\n\t\t\t: __('Nothing to show')\n\n\t\tthis.toggle_message(flag, message);\n\n\t\tif (flag && this.prepared_report) {\n\t\t\tthis.prepared_report_action = \"New\";\n\t\t\tthis.add_prepared_report_buttons();\n\t\t}\n\t}\n\n\ttoggle_message(flag, message) {\n\t\tif (flag) {\n\t\t\tthis.$message.find('div').html(message);\n\t\t\tthis.$message.show();\n\t\t} else {\n\t\t\tthis.$message.hide();\n\t\t}\n\t\tthis.$report.toggle(!flag);\n\t\tthis.$chart.toggle(!flag);\n\t}\n\t// backward compatibility\n\tget get_values() {\n\t\treturn this.get_filter_values;\n\t}\n};\n\nObject.defineProperty(frappe, 'query_report_filters_by_name', {\n\tget() {\n\t\tconsole.warn('[Query Report] frappe.query_report_filters_by_name is deprecated. Please use the new api: frappe.query_report.get_filter_value(fieldname) and frappe.query_report.set_filter_value(fieldname, value)');\n\t\treturn null;\n\t}\n});\n","// Copyright (c) 2015, Frappe Technologies Pvt. Ltd. and Contributors\n// MIT License. See license.txt\n\nimport DataTable from 'frappe-datatable';\nfrappe.provide(\"frappe.report_dump\");\n\n$.extend(frappe.report_dump, {\n\tdata: {},\n\tlast_modified: {},\n\twith_data: function(doctypes, callback) {\n\t\tvar pre_loaded = Object.keys(frappe.report_dump.last_modified);\n\t\treturn frappe.call({\n\t\t\tmethod: \"frappe.desk.report_dump.get_data\",\n\t\t\ttype: \"GET\",\n\t\t\targs: {\n\t\t\t\tdoctypes: doctypes,\n\t\t\t\tlast_modified: frappe.report_dump.last_modified\n\t\t\t},\n\t\t\tfreeze: true,\n\t\t\tcallback: function(r) {\n\t\t\t\t// creating map of data from a list\n\t\t\t\t$.each(r.message, function(doctype, doctype_data) {\n\t\t\t\t\tfrappe.report_dump.set_data(doctype, doctype_data);\n\t\t\t\t});\n\n\t\t\t\t// reverse map names\n\t\t\t\t$.each(r.message, function(doctype, doctype_data) {\n\t\t\t\t\t// only if not pre-loaded\n\t\t\t\t\tif(!in_list(pre_loaded, doctype)) {\n\t\t\t\t\t\tif(doctype_data.links) {\n\t\t\t\t\t\t\t$.each(frappe.report_dump.data[doctype], function(row_idx, row) {\n\t\t\t\t\t\t\t\t$.each(doctype_data.links, function(link_key, link) {\n\t\t\t\t\t\t\t\t\tif(frappe.report_dump.data[link[0]][row[link_key]]) {\n\t\t\t\t\t\t\t\t\t\trow[link_key] = frappe.report_dump.data[link[0]][row[link_key]][link[1]];\n\t\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\t\trow[link_key] = null;\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t});\n\n\t\t\t\tcallback();\n\t\t\t}\n\t\t});\n\t},\n\tset_data: function(doctype, doctype_data) {\n\t\tvar data = [];\n\t\tvar replace_dict = {};\n\t\tvar make_row = function(d) {\n\t\t\tvar row = {};\n\t\t\t$.each(doctype_data.columns, function(idx, col) {\n\t\t\t\trow[col] = d[idx];\n\t\t\t});\n\t\t\trow.id = row.name;\n\t\t\trow.doctype = doctype;\n\t\t\treturn row;\n\t\t};\n\t\tif(frappe.report_dump.last_modified[doctype]) {\n\t\t\t// partial loading, make a name dict\n\t\t\t$.each(doctype_data.data, function(i, d) {\n\t\t\t\tvar row = make_row(d);\n\t\t\t\treplace_dict[row.name] = row;\n\t\t\t});\n\n\t\t\t// replace old data\n\t\t\t$.each(frappe.report_dump.data[doctype], function(i, d) {\n\t\t\t\tif(replace_dict[d.name]) {\n\t\t\t\t\tdata.push(replace_dict[d.name]);\n\t\t\t\t\tdelete replace_dict[d.name];\n\t\t\t\t} else if(doctype_data.modified_names.indexOf(d.name)!==-1) {\n\t\t\t\t\t// if modified but not in replace_dict, then assume it as cancelled\n\t\t\t\t\t// don't push in data\n\t\t\t\t} else {\n\t\t\t\t\tdata.push(d);\n\t\t\t\t}\n\t\t\t});\n\n\t\t\t// add new records\n\t\t\t$.each(replace_dict, function(name, d) {\n\t\t\t\tdata.push(d);\n\t\t\t});\n\t\t} else {\n\n\t\t\t// first loading\n\t\t\t$.each(doctype_data.data, function(i, d) {\n\t\t\t\tdata.push(make_row(d));\n\t\t\t});\n\t\t}\n\t\tfrappe.report_dump.last_modified[doctype] = doctype_data.last_modified;\n\t\tfrappe.report_dump.data[doctype] = data;\n\t}\n});\n\nfrappe.provide(\"frappe.views\");\nfrappe.views.GridReport = Class.extend({\n\tinit: function(opts) {\n\t\tthis.filter_inputs = {};\n\t\tthis.preset_checks = [];\n\t\tthis.tree_grid = {show: false};\n\t\t$.extend(this, opts);\n\n\t\tthis.wrapper = $('<div class=\"grid-report\"></div>').appendTo(this.page.main);\n\t\tthis.page.main.find(\".page\").css({\"padding-top\": \"0px\"});\n\n\t\tif(this.filters) {\n\t\t\tthis.make_filters();\n\t\t}\n\t\tthis.make_waiting();\n\n\t\tthis.get_data_and_refresh();\n\t},\n\tbind_show: function() {\n\t\t// bind show event to reset cur_report_grid\n\t\t// and refresh filters from url\n\t\t// this must be called after init\n\t\t// because \"frappe.container.page\" will only be set\n\t\t// once \"load\" event is over.\n\n\t\tvar me = this;\n\t\t$(this.page).bind('show', function() {\n\t\t\t// reapply filters on show\n\t\t\tfrappe.cur_grid_report = me;\n\t\t\tme.get_data_and_refresh();\n\t\t});\n\n\t},\n\tget_data_and_refresh: function() {\n\t\tvar me = this;\n\t\tthis.get_data(function() {\n\t\t\tme.apply_filters_from_route();\n\t\t\tme.refresh();\n\t\t});\n\t},\n\tget_data: function(callback) {\n\t\tvar me = this;\n\n\t\tfrappe.report_dump.with_data(this.doctypes, function() {\n\t\t\tif(!me.setup_filters_done) {\n\t\t\t\tme.setup_filters();\n\t\t\t\tme.setup_filters_done = true;\n\t\t\t}\n\t\t\tcallback();\n\t\t});\n\t},\n\tsetup_filters: function() {\n\t\tvar me = this;\n\n\t\t$.each(me.filter_inputs, function(i, v) {\n\t\t\tvar opts = v.get(0).opts;\n\t\t\tif(opts.fieldtype == \"Select\" && in_list(me.doctypes, opts.link)) {\n\t\t\t\t$(v).add_options(frappe.report_dump.data[opts.link].map(d => d.name));\n\t\t\t} else if(opts.fieldtype == \"Link\" && in_list(me.doctypes, opts.link)) {\n\t\t\t\topts.list = frappe.report_dump.data[opts.link].map(d => d.name);\n\t\t\t\tme.set_autocomplete(v, opts.list);\n\t\t\t}\n\t\t});\n\n\t\t// refresh\n\t\tthis.page.set_primary_action(__(\"Refresh\"), function() {\n\t\t\tme.get_data(function() {\n\t\t\t\tme.refresh();\n\t\t\t});\n\t\t});\n\n\t\t// reset filters button\n\t\tif (this.filter_inputs) {\n\t\t\tthis.page.add_menu_item(__(\"Reset Filters\"), function() {\n\t\t\t\tme.init_filter_values();\n\t\t\t\tme.refresh();\n\t\t\t}, true);\n\t\t}\n\n\t\tthis.page.add_menu_item(__(\"Print\"), function() {\n\t\t\tfrappe.ui.get_print_settings(false, function(print_settings) {\n\t\t\t\tfrappe.render_grid({grid: me.grid, title: me.page.title, print_settings: print_settings, report: me});\n\t\t\t});\n\n\t\t}, true);\n\n\t\t// range\n\t\tthis.filter_inputs.range && this.filter_inputs.range.on(\"change\", function() {\n\t\t\tme.refresh();\n\t\t});\n\t},\n\tset_filter: function(key, value) {\n\t\tvar filters = this.filter_inputs[key];\n\t\tif(filters) {\n\t\t\tvar opts = filters.get(0).opts;\n\t\t\tif(opts.fieldtype === \"Check\") {\n\t\t\t\tfilters.prop(\"checked\", cint(value) ? true : false);\n\t\t\t} if(opts.fieldtype==\"Date\") {\n\t\t\t\tfilters.val(frappe.datetime.str_to_user(value));\n\t\t\t} else {\n\t\t\t\tfilters.val(value);\n\t\t\t}\n\t\t} else {\n\t\t\tfrappe.msgprint(__(\"Invalid Filter: {0}\", [key]));\n\t\t}\n\t},\n\tset_autocomplete: function($filter, list) {\n\t\tvar me = this;\n\t\tnew Awesomplete($filter.get(0), {\n\t\t\tlist: list\n\t\t});\n\t\t$filter.on(\"awesomplete-select\", function(e) {\n\t\t\tvar value = e.originalEvent.text.value;\n\t\t\t$filter.val(value);\n\t\t\tme.refresh();\n\t\t});\n\t},\n\tinit_filter_values: function() {\n\t\t$.each(this.filter_inputs, function(key, filter) {\n\t\t\tvar opts = filter.get(0).opts;\n\t\t\tif(frappe.sys_defaults[key]) {\n\t\t\t\tfilter.val(frappe.sys_defaults[key]);\n\t\t\t} else if(opts.fieldtype=='Select') {\n\t\t\t\tfilter.get(0).selectedIndex = 0;\n\t\t\t} else if(opts.fieldtype=='Data') {\n\t\t\t\tfilter.val(\"\");\n\t\t\t} else if(opts.fieldtype==\"Link\") {\n\t\t\t\tfilter.val(\"\");\n\t\t\t}\n\t\t});\n\n\t\tthis.set_default_values();\n\t},\n\n\tset_default_values: function() {\n\t\tvar values = {\n\t\t\tfrom_date: frappe.datetime.str_to_user(frappe.sys_defaults.year_start_date),\n\t\t\tto_date: frappe.datetime.str_to_user(frappe.sys_defaults.year_end_date)\n\t\t};\n\n\t\tvar me = this;\n\t\t$.each(values, function(i, v) {\n\t\t\tif(me.filter_inputs[i] && !me.filter_inputs[i].val())\n\t\t\t\tme.filter_inputs[i].val(v);\n\t\t});\n\t},\n\n\tmake_filters: function() {\n\t\tvar me = this;\n\t\t$.each(this.filters, function(i, v) {\n\t\t\tv.fieldname = v.fieldname || v.label.replace(/ /g, '_').toLowerCase();\n\t\t\tvar input = null;\n\t\t\tif(v.fieldtype=='Select') {\n\t\t\t\tinput = me.page.add_select(v.label, v.options || [v.default_value]);\n\t\t\t} else if(v.fieldtype==\"Link\") {\n\t\t\t\tinput = me.page.add_data(v.label);\n\t\t\t\tnew Awesomplete(input.get(0), {\n\t\t\t\t\tlist: v.list || []\n\t\t\t\t});\n\t\t\t} else if(v.fieldtype==='Button' && v.label===__(\"Refresh\")) {\n\t\t\t\tinput = me.page.set_primary_action(v.label, null, v.icon);\n\t\t\t} else if(v.fieldtype==='Button') {\n\t\t\t\tinput = me.page.add_menu_item(v.label, null, true);\n\t\t\t} else if(v.fieldtype==='Date') {\n\t\t\t\tinput = me.page.add_date(v.label);\n\t\t\t} else if(v.fieldtype==='Label') {\n\t\t\t\tinput = me.page.add_label(v.label);\n\t\t\t} else if(v.fieldtype==='Data') {\n\t\t\t\tinput = me.page.add_data(v.label);\n\t\t\t} else if(v.fieldtype==='Check') {\n\t\t\t\tinput = me.page.add_check(v.label);\n\t\t\t}\n\n\t\t\tif(input) {\n\t\t\t\tinput && (input.get(0).opts = v);\n\t\t\t\tif(v.cssClass) {\n\t\t\t\t\tinput.addClass(v.cssClass);\n\t\t\t\t}\n\t\t\t\tinput.keypress(function(e) {\n\t\t\t\t\tif(e.which==13) {\n\t\t\t\t\t\tme.refresh();\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t}\n\t\t\tme.filter_inputs[v.fieldname] = input;\n\t\t});\n\t},\n\tmake_waiting: function() {\n\t\tthis.waiting = frappe.messages.waiting(this.wrapper, __(\"Loading Report\")+\"...\");\n\t},\n\tload_filter_values: function() {\n\t\tvar me = this;\n\t\t$.each(this.filter_inputs, function(i, f) {\n\t\t\tvar opts = f.get(0).opts;\n\t\t\tif(opts.fieldtype=='Check') {\n\t\t\t\tme[opts.fieldname] = f.prop('checked') ? 1 : 0;\n\t\t\t} else if(opts.fieldtype!='Button') {\n\t\t\t\tme[opts.fieldname] = f.val();\n\t\t\t\tif(opts.fieldtype==\"Date\") {\n\t\t\t\t\tme[opts.fieldname] = frappe.datetime.user_to_str(me[opts.fieldname]);\n\t\t\t\t} else if (opts.fieldtype == \"Select\") {\n\t\t\t\t\tme[opts.fieldname+'_default'] = opts.default_value;\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\n\t\tif(this.filter_inputs.from_date && this.filter_inputs.to_date && (this.to_date < this.from_date)) {\n\t\t\tfrappe.msgprint(__(\"From Date must be before To Date\"));\n\t\t\treturn;\n\t\t}\n\n\t},\n\n\tmake_name_map: function(data, key) {\n\t\tvar map = {};\n\t\tkey = key || \"name\";\n\t\t$.each(data, function(i, v) {\n\t\t\tmap[v[key]] = v;\n\t\t});\n\t\treturn map;\n\t},\n\n\treset_item_values: function(item) {\n\t\tvar me = this;\n\t\t$.each(this.columns, function(i, col) {\n\t\t\tif (col.formatter==me.currency_formatter) {\n\t\t\t\titem[col.id] = 0.0;\n\t\t\t}\n\t\t});\n\t},\n\n\tround_item_values: function(item) {\n\t\tvar me = this;\n\t\t$.each(this.columns, function(i, col) {\n\t\t\tif (col.formatter==me.currency_formatter) {\n\t\t\t\titem[col.id] = flt(item[col.id], frappe.defaults.get_default(\"float_precision\") || 3);\n\t\t\t}\n\t\t});\n\t},\n\n\tround_off_data: function() {\n\t\tvar me = this;\n\t\t$.each(this.data, function(i, d) {\n\t\t\tme.round_item_values(d);\n\t\t});\n\t},\n\n\trefresh: function() {\n\t\tthis.waiting.toggle(false);\n\t\tif(!this.grid_wrapper)\n\t\t\tthis.make();\n\t\t// this.show_zero = $('.show-zero input:checked').length;\n\t\tthis.load_filter_values();\n\t\tthis.setup_columns();\n\t\tthis.setup_dataview_columns();\n\t\tthis.apply_link_formatters();\n\t\tthis.prepare_data();\n\t\tthis.round_off_data();\n\t\tthis.prepare_data_view();\n\t\t// chart might need prepared data\n\t\tfrappe.show_alert(\"Updated\", 2);\n\t\tthis.render();\n\t\tthis.setup_chart && this.setup_chart();\n\t},\n\tsetup_dataview_columns: function() {\n\t\tthis.columns = this.columns.filter(col => !col.hidden);\n\t\tthis.datatable_columns = this.columns.map(column => {\n\t\t\treturn Object.assign(column, {\n\t\t\t\tformat: (value, row, column, data) => {\n\t\t\t\t\treturn column.formatter ?\n\t\t\t\t\t\tcolumn.formatter(row, {}, value, column, data) :\n\t\t\t\t\t\tvalue || '';\n\t\t\t\t}\n\t\t\t});\n\t\t});\n\t},\n\tmake: function() {\n\t\t// chart wrapper\n\t\tthis.chart_area = $('<div class=\"chart\" style=\"padding-bottom: 1px\"></div>').appendTo(this.wrapper);\n\n\t\tthis.page.add_menu_item(__(\"Export\"), () =>  this.export(), true);\n\n\t\t// grid wrapper\n\t\tthis.grid_wrapper = $(\"<div style='height: 500px;'>\")\n\t\t\t.appendTo(this.wrapper);\n\t\tthis.id = frappe.dom.set_unique_id(this.grid_wrapper.get(0));\n\n\t\tthis.bind_show();\n\n\t\tfrappe.cur_grid_report = this;\n\t\t$(this.wrapper).trigger('make');\n\n\t},\n\tapply_filters_from_route: function() {\n\t\tvar me = this;\n\t\tif(frappe.route_options) {\n\t\t\t$.each(frappe.route_options, function(key, value) {\n\t\t\t\tme.set_filter(key, value);\n\t\t\t});\n\t\t\tfrappe.route_options = null;\n\t\t} else {\n\t\t\tthis.init_filter_values();\n\t\t}\n\t\tthis.set_default_values();\n\n\t\t$(this.wrapper).trigger('apply_filters_from_route');\n\t},\n\toptions: {\n\t\teditable: false,\n\t\tenableColumnReorder: false\n\t},\n\trender: function() {\n\t\tthis.datatable = new DataTable('#' + this.id, {\n\t\t\tcolumns: this.datatable_columns,\n\t\t\tdata: this.data,\n\t\t\tlayout: 'fixed',\n\t\t\tinlineFilters: true,\n\t\t\ttreeView: true,\n\t\t\tcheckboxColumn: true,\n\t\t\tcheckedRowStatus: false,\n\t\t\tevents: {\n\t\t\t\tonCheckRow: (row) => {\n\t\t\t\t\tconst rowIndex = row.meta.rowIndex;\n\t\t\t\t\tconst checked = this.datatable.rowmanager.checkMap[rowIndex];\n\t\t\t\t\tconst data = this.datatable.datamanager.getData(rowIndex);\n\t\t\t\t\tdata.checked = Boolean(checked);\n\n\t\t\t\t\tthis.setup_chart && this.setup_chart();\n\t\t\t\t}\n\t\t\t},\n\t\t\thooks: {\n\t\t\t\tcolumnTotal: frappe.utils.report_column_total\n\t\t\t}\n\t\t});\n\n\t\tthis.data.forEach((d, i) => {\n\t\t\tif (d.checked) {\n\t\t\t\tthis.datatable.rowmanager.checkRow(i, true);\n\t\t\t}\n\t\t});\n\t},\n\tprepare_data_view: function() {\n\t},\n\texport: function() {\n\t\tfrappe.tools.downloadify(frappe.slickgrid_tools.get_view_data(this.columns, this.dataView),\n\t\t\t[\"Report Manager\", \"System Manager\"], this.title);\n\t\treturn false;\n\t},\n\tapply_filters: function(item) {\n\t\t// generic filter: apply filter functiions\n\t\t// from all filter_inputs\n\t\tvar filters = this.filter_inputs;\n\t\tif(item._show) return true;\n\n\t\tfor (var i in filters) {\n\t\t\tif(!this.apply_filter(item, i)) {\n\t\t\t\treturn false;\n\t\t\t}\n\t\t}\n\n\t\treturn true;\n\t},\n\tapply_filter: function(item, fieldname) {\n\t\tvar filter = this.filter_inputs[fieldname].get(0);\n\t\tif(filter.opts.filter) {\n\t\t\tif(!filter.opts.filter(this[filter.opts.fieldname], item, filter.opts, this)) {\n\t\t\t\treturn false;\n\t\t\t}\n\t\t}\n\t\treturn true;\n\t},\n\tapply_zero_filter: function(val, item, opts, me) {\n\t\t// show only non-zero values\n\t\tif(!me.show_zero) {\n\t\t\tfor(var i=0, j=me.columns.length; i<j; i++) {\n\t\t\t\tvar col = me.columns[i];\n\t\t\t\tif(col.formatter==me.currency_formatter && !col.hidden) {\n\t\t\t\t\tif(flt(item[col.field]) > 0.001 ||  flt(item[col.field]) < -0.001) {\n\t\t\t\t\t\treturn true;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn false;\n\t\t}\n\t\treturn true;\n\t},\n\tshow_zero_check: function() {\n\t\tvar me = this;\n\t\tthis.wrapper.bind('make', function() {\n\t\t\tme.wrapper.find('.show-zero').toggle(true).find('input').click(function(){\n\t\t\t\tme.refresh();\n\t\t\t});\n\t\t});\n\t},\n\tis_default: function(fieldname) {\n\t\treturn this[fieldname]==this[fieldname + \"_default\"];\n\t},\n\tdate_formatter: function(row, cell, value) {\n\t\treturn frappe.datetime.str_to_user(value);\n\t},\n\tcurrency_formatter: function(row, cell, value, columnDef, dataContext) {\n\t\tif (isNaN(value)) value = '';\n\t\treturn repl('<div style=\"text-align: right; %(_style)s\">%(value)s</div>', {\n\t\t\t_style: dataContext._style || \"\",\n\t\t\tvalue: ((value==null || value===\"\") ? \"\" : format_number(value))\n\t\t});\n\t},\n\ttext_formatter: function(row, cell, value, columnDef, dataContext) {\n\t\treturn repl('<span style=\"%(_style)s\" title=\"%(esc_value)s\">%(value)s</span>', {\n\t\t\t_style: dataContext._style || \"\",\n\t\t\tesc_value: cstr(value).replace(/\"/g, '\\\\\"'),\n\t\t\tvalue: cstr(value)\n\t\t});\n\t},\n\tcheck_formatter: function(row, cell, value, columnDef, dataContext) {\n\t\treturn repl('<input type=\"checkbox\" data-id=\"%(id)s\" \\\n\t\t\tclass=\"chart-check\" %(checked)s>', {\n\t\t\t\t\"id\": dataContext.id,\n\t\t\t\t\"checked\": dataContext.checked ? 'checked=\"checked\"' : \"\"\n\t\t\t});\n\t},\n\tapply_link_formatters: function() {\n\t\t$.each(this.columns, function(i, col) {\n\t\t\tif(col.link_formatter) {\n\t\t\t\tcol.formatter = function(row, cell, value, columnDef, dataContext, for_print) {\n\t\t\t\t\t// added link and open button to links\n\t\t\t\t\t// link_formatter must have\n\t\t\t\t\t// filter_input, open_btn (true / false), doctype (will be eval'd)\n\t\t\t\t\tif(!value) return \"\";\n\n\t\t\t\t\tif(for_print) {\n\t\t\t\t\t\treturn value;\n\t\t\t\t\t}\n\n\t\t\t\t\tvar me = frappe.cur_grid_report;\n\n\t\t\t\t\tif(dataContext._show) {\n\t\t\t\t\t\treturn repl('<span style=\"%(_style)s\">%(value)s</span>', {\n\t\t\t\t\t\t\t_style: dataContext._style || \"\",\n\t\t\t\t\t\t\tvalue: value\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\n\t\t\t\t\t// make link to add a filter\n\t\t\t\t\tvar html;\n\t\t\t\t\tvar link_formatter = me.dataview_columns[cell].link_formatter;\n\t\t\t\t\tif (link_formatter.filter_input) {\n\t\t\t\t\t\thtml = repl('<a href=\"#\" \\\n\t\t\t\t\t\t\tonclick=\"frappe.cur_grid_report.set_filter(\\'%(col_name)s\\', \\'%(value)s\\'); \\\n\t\t\t\t\t\t\t\tfrappe.cur_grid_report.refresh(); return false;\">\\\n\t\t\t\t\t\t\t%(value)s</a>', {\n\t\t\t\t\t\t\t\tvalue: value,\n\t\t\t\t\t\t\t\tcol_name: link_formatter.filter_input,\n\t\t\t\t\t\t\t\tpage_name: frappe.container.page.page_name\n\t\t\t\t\t\t\t});\n\t\t\t\t\t} else {\n\t\t\t\t\t\thtml = value;\n\t\t\t\t\t}\n\n\t\t\t\t\t// make icon to open form\n\t\t\t\t\tif(link_formatter.open_btn) {\n\t\t\t\t\t\tvar doctype = link_formatter.doctype\n\t\t\t\t\t\t\t? eval(link_formatter.doctype)\n\t\t\t\t\t\t\t: dataContext.doctype;\n\t\t\t\t\t\thtml += me.get_link_open_icon(doctype, value);\n\t\t\t\t\t}\n\t\t\t\t\treturn html;\n\t\t\t\t};\n\t\t\t}\n\t\t});\n\t},\n\tget_link_open_icon: function(doctype, name) {\n\t\treturn repl(' <a href=\"#Form/%(doctype)s/%(name)s\">\\\n\t\t\t<i class=\"fa fa-share\" style=\"cursor: pointer;\"></i></a>', {\n\t\t\t\tdoctype: doctype,\n\t\t\t\tname: encodeURIComponent(name)\n\t\t\t});\n\t},\n\tmake_date_range_columns: function() {\n\t\tthis.columns = [];\n\n\t\tvar me = this;\n\t\tvar range = this.filter_inputs.range.val();\n\t\tthis.from_date = frappe.datetime.user_to_str(this.filter_inputs.from_date.val());\n\t\tthis.to_date = frappe.datetime.user_to_str(this.filter_inputs.to_date.val());\n\t\tvar date_diff = frappe.datetime.get_diff(this.to_date, this.from_date);\n\n\t\tme.column_map = {};\n\t\tme.last_date = null;\n\n\t\tvar add_column = function(date) {\n\t\t\tme.columns.push({\n\t\t\t\tid: date,\n\t\t\t\tname: frappe.datetime.str_to_user(date),\n\t\t\t\tfield: date,\n\t\t\t\tformatter: me.currency_formatter,\n\t\t\t\twidth: 100\n\t\t\t});\n\t\t};\n\n\t\tvar build_columns = function(condition) {\n\t\t\t// add column for each date range\n\t\t\tfor(var i=0; i <= date_diff; i++) {\n\t\t\t\tvar date = frappe.datetime.add_days(me.from_date, i);\n\t\t\t\tif(!condition) condition = () => true;\n\n\t\t\t\tif(condition(date)) add_column(date);\n\t\t\t\tme.last_date = date;\n\n\t\t\t\tif(me.columns.length) {\n\t\t\t\t\tme.column_map[date] = me.columns[me.columns.length-1];\n\t\t\t\t}\n\t\t\t}\n\t\t};\n\n\t\t// make columns for all date ranges\n\t\tif(range=='Daily') {\n\t\t\tbuild_columns();\n\t\t} else if(range=='Weekly') {\n\t\t\tbuild_columns(function(date) {\n\t\t\t\tif(!me.last_date) return true;\n\t\t\t\treturn !(frappe.datetime.get_diff(date, me.from_date) % 7);\n\t\t\t});\n\t\t} else if(range=='Monthly') {\n\t\t\tbuild_columns(function(date) {\n\t\t\t\tif(!me.last_date) return true;\n\t\t\t\treturn frappe.datetime.str_to_obj(me.last_date).getMonth() != frappe.datetime.str_to_obj(date).getMonth();\n\t\t\t});\n\t\t} else if(range=='Quarterly') {\n\t\t\tbuild_columns(function(date) {\n\t\t\t\tif(!me.last_date) return true;\n\t\t\t\treturn frappe.datetime.str_to_obj(date).getDate()==1 && in_list([0,3,6,9], frappe.datetime.str_to_obj(date).getMonth());\n\t\t\t});\n\t\t} else if(range=='Yearly') {\n\t\t\tbuild_columns(function(date) {\n\t\t\t\tif(!me.last_date) return true;\n\t\t\t\treturn $.map(frappe.report_dump.data['Fiscal Year'], function(v) {\n\t\t\t\t\treturn date==v.year_start_date ? true : null;\n\t\t\t\t}).length;\n\t\t\t});\n\n\t\t}\n\n\t\t// set label as last date of period\n\t\t$.each(this.columns, function(i, col) {\n\t\t\tcol.name = me.columns[i+1]\n\t\t\t\t? frappe.datetime.str_to_user(frappe.datetime.add_days(me.columns[i+1].id, -1))\n\t\t\t\t: frappe.datetime.str_to_user(me.to_date);\n\t\t});\n\t},\n\ttrigger_refresh_on_change: function(filters) {\n\t\tvar me = this;\n\t\t$.each(filters, function(i, f) {\n\t\t\tme.filter_inputs[f] && me.filter_inputs[f].on(\"change\", function() {\n\t\t\t\tme.refresh();\n\t\t\t});\n\t\t});\n\t}\n});\n\nfrappe.views.GridReportWithPlot = frappe.views.GridReport.extend({\n\tsetup_chart: function() {\n\t\tif (in_list([\"Daily\", \"Weekly\"], this.filter_inputs.range.val())) {\n\t\t\tthis.chart_area.toggle(false);\n\t\t\treturn;\n\t\t} else {\n\t\t\tthis.chart_area.toggle(true);\n\t\t}\n\t\tvar chart_data = this.get_chart_data ? this.get_chart_data() : null;\n\n\t\tconst parent = this.wrapper.find('.chart')[0];\n\t\tthis.chart = new Chart(parent, {\n\t\t\theight: 200,\n\t\t\tdata: chart_data,\n\t\t\ttype: 'line'\n\t\t});\n\t},\n\n\tget_chart_data: function() {\n\t\tvar me = this;\n\t\tvar plottable_cols = [];\n\t\t$.each(me.columns, function(idx, col) {\n\t\t\tif(col.formatter==me.currency_formatter && !col.hidden && col.plot!==false) {\n\t\t\t\tplottable_cols.push(col.field);\n\t\t\t}\n\t\t});\n\n\t\tvar data = {\n\t\t\tlabels: plottable_cols,\n\t\t\tdatasets: []\n\t\t};\n\n\t\t$.each(this.data, function(i, item) {\n\t\t\tif (item.checked) {\n\t\t\t\tlet dataset = {};\n\t\t\t\tdataset.name = item.name;\n\t\t\t\tdataset.values = [];\n\t\t\t\t$.each(plottable_cols, function(idx, col) {\n\t\t\t\t\tdataset.values.push(item[col]);\n\t\t\t\t});\n\t\t\t\tdata[\"datasets\"].push(dataset);\n\t\t\t}\n\t\t});\n\t\treturn data;\n\t}\n});\n\n\nfrappe.views.TreeGridReport = frappe.views.GridReportWithPlot.extend({\n\tmake_transaction_list: function(parent_doctype, doctype) {\n\t\tvar me = this;\n\t\tvar tmap = {};\n\t\t$.each(frappe.report_dump.data[doctype], function(i, v) {\n\t\t\tif(!tmap[v.parent]) tmap[v.parent] = [];\n\t\t\ttmap[v.parent].push(v);\n\t\t});\n\t\tif (!this.tl) this.tl = {};\n\t\tif (!this.tl[parent_doctype]) this.tl[parent_doctype] = [];\n\n\t\t$.each(frappe.report_dump.data[parent_doctype], function(i, parent) {\n\t\t\tif(tmap[parent.name]) {\n\t\t\t\t$.each(tmap[parent.name], function(i, d) {\n\t\t\t\t\tme.tl[parent_doctype].push($.extend(copy_dict(parent), d));\n\t\t\t\t});\n\t\t\t}\n\t\t});\n\t},\n\tadd_tree_grid_events: function() {\n\t\tvar me = this;\n\t\tthis.grid.onClick.subscribe(function(e, args) {\n\t\t\tif ($(e.target).hasClass(\"toggle\")) {\n\t\t\t\tvar item = me.dataView.getItem(args.row);\n\t\t\t\tif (item) {\n\t\t\t\t\tif (!item._collapsed) {\n\t\t\t\t\t\titem._collapsed = true;\n\t\t\t\t\t} else {\n\t\t\t\t\t\titem._collapsed = false;\n\t\t\t\t\t}\n\n\t\t\t\t\tme.dataView.updateItem(item.id, item);\n\t\t\t\t}\n\t\t\t\te.stopImmediatePropagation();\n\t\t\t}\n\t\t});\n\t},\n\ttree_formatter: function(row, cell, value, columnDef, dataContext) {\n\t\tvar me = frappe.cur_grid_report;\n\t\tvar data = me.data;\n\t\tvar spacer = \"<span style='display:inline-block;height:1px;width:\" +\n\t\t\t(15 * dataContext[\"indent\"]) + \"px'></span>\";\n\t\tvar idx = me.dataView.getIdxById(dataContext.id);\n\t\tvar link = me.tree_grid.formatter(dataContext);\n\n\t\tif(dataContext.doctype) {\n\t\t\tlink += me.get_link_open_icon(dataContext.doctype, dataContext.name);\n\t\t}\n\n\t\tif (data[idx + 1] && data[idx + 1].indent > data[idx].indent) {\n\t\t\tif (dataContext._collapsed) {\n\t\t\t\treturn spacer + \" <span class='toggle expand'></span>&nbsp;\" + link;\n\t\t\t} else {\n\t\t\t\treturn spacer + \" <span class='toggle collapse'></span>&nbsp;\" + link;\n\t\t\t}\n\t\t} else {\n\t\t\treturn spacer + \" <span class='toggle'></span>&nbsp;\" + link;\n\t\t}\n\t},\n\ttree_dataview_filter: function(item) {\n\t\tvar me = frappe.cur_grid_report;\n\t\tif(!me.apply_filters(item)) return false;\n\n\t\tvar parent = item[me.tree_grid.parent_field];\n\t\twhile (parent) {\n\t\t\tif (me.item_by_name[parent]._collapsed) {\n\t\t\t\treturn false;\n\t\t\t}\n\t\t\tparent = me.parent_map[parent];\n\t\t}\n\t\treturn true;\n\t},\n\tprepare_tree: function(item_dt, group_dt) {\n\t\tvar group_data = frappe.report_dump.data[group_dt];\n\t\tvar item_data = frappe.report_dump.data[item_dt];\n\n\t\t// prepare map with child in respective group\n\t\tvar me = this;\n\t\tvar item_group_map = {};\n\t\tvar group_ids = group_data.map(v => v.id);\n\n\t\t$.each(item_data, function(i, item) {\n\t\t\tvar parent = item[me.tree_grid.parent_field];\n\t\t\tif(!item_group_map[parent]) item_group_map[parent] = [];\n\t\t\tif(group_ids.indexOf(item.name)==-1) {\n\t\t\t\titem_group_map[parent].push(item);\n\t\t\t} else {\n\t\t\t\tfrappe.msgprint(__(\"Ignoring Item {0}, because a group exists with the same name!\", [item.name.bold()]));\n\t\t\t}\n\t\t});\n\n\t\t// arrange items besides their parent item groups\n\t\tvar items = [];\n\t\t$.each(group_data, function(i, group){\n\t\t\tgroup.is_group = true;\n\t\t\titems.push(group);\n\t\t\titems = items.concat(item_group_map[group.name] || []);\n\t\t});\n\t\treturn items;\n\t},\n\tset_indent: function() {\n\t\tvar me = this;\n\t\t$.each(this.data, function(i, d) {\n\t\t\tvar indent = 0;\n\t\t\tvar parent = me.parent_map[d.name];\n\t\t\tif(parent) {\n\t\t\t\twhile(parent) {\n\t\t\t\t\tindent++;\n\t\t\t\t\tparent = me.parent_map[parent];\n\t\t\t\t}\n\t\t\t}\n\t\t\td.indent = indent;\n\t\t});\n\t},\n\n\texport: function() {\n\t\tvar msgbox =\tfrappe.msgprint($.format('<p>{0}</p>\\\n\t\t\t<p><input type=\"checkbox\" name=\"with_groups\" checked=\"checked\"> {1}</p>\\\n\t\t\t<p><input type=\"checkbox\" name=\"with_ledgers\" checked=\"checked\"> {2}</p>\\\n\t\t\t<p><button class=\"btn btn-primary\"> {3}</button>', [\n\t\t\t\t__('Select To Download:'),\n\t\t\t\t__('With Groups'),\n\t\t\t\t__('With Ledgers'),\n\t\t\t\t__('Download')\n\t\t\t]));\n\n\t\tvar me = this;\n\n\t\t$(msgbox.body).find(\"button\").click(function() {\n\t\t\tvar with_groups = $(msgbox.body).find(\"[name='with_groups']\").prop(\"checked\");\n\t\t\tvar with_ledgers = $(msgbox.body).find(\"[name='with_ledgers']\").prop(\"checked\");\n\n\t\t\tvar data = frappe.slickgrid_tools.get_view_data(me.columns, me.data,\n\t\t\t\tfunction(row, item) {\n\t\t\t\t\tif(with_groups) {\n\t\t\t\t\t\t// add row\n\t\t\t\t\t\tfor(var i=0; i<item.indent; i++) row[0] = \"   \" + row[0];\n\t\t\t\t\t}\n\t\t\t\t\tif(with_groups && (item.is_group == 1 || item.is_group)) {\n\t\t\t\t\t\treturn true;\n\t\t\t\t\t}\n\t\t\t\t\tif(with_ledgers && (item.is_group != 1 && !item.is_group)) {\n\t\t\t\t\t\treturn true;\n\t\t\t\t\t}\n\n\t\t\t\t\treturn false;\n\t\t\t\t});\n\n\t\t\tfrappe.tools.downloadify(data, [\"Report Manager\", \"System Manager\"], me.title);\n\t\t\treturn false;\n\t\t});\n\n\t\treturn false;\n\t},\n\n});\n"],"names":["module","q","b","a","c","addEventListener","attachEvent","n","removeEventListener","detachEvent","r","Object","prototype","toString","call","m","window","getComputedStyle","currentStyle","l","document","createElement","all","innerHTML","documentMode","x","navigator","platform","toLowerCase","indexOf","p","this","rows_in_block","blocks_in_cluster","tag","show_no_data_row","no_data_class","no_data_text","keep_parity","callbacks","options","h","d","split","f","getElementById","Error","content_elem","hasAttribute","setAttribute","e","rows","fetchMarkup","g","scroll_elem","scrollTop","insertToDOM","k","t","style","pointerEvents","clearTimeout","setTimeout","getClusterNum","scrollingProgress","getScrollProgress","u","v","refresh","destroy","html","generateEmptyRow","join","getRowsHeight","update","length","item_height","clear","getRowsAmount","scroll_top","w","concat","append","prepend","constructor","getChildNodes","push","shift","outerHTML","exploreEnvironment","content_tag","tagName","match","children","data","cluster_height","Math","floor","offsetHeight","parseInt","max","block_height","rows_in_cluster","createTextNode","className","colSpan","appendChild","generate","top_offset","bottom_offset","rows_above","renderExtraTag","height","checkChanges","clusterWillChange","clusterChanged","lastChild","removeChild","firstChild","frappe","views","ReportFactory","Factory","[object Object]","route","const","_route","set_route","factory","dragEl","parentEl","ghostEl","cloneEl","rootEl","nextEl","lastDownEl","scrollEl","scrollParentEl","scrollCustomFn","oldIndex","newIndex","oldDraggableIndex","newDraggableIndex","activeGroup","putSortable","pointerElemChangedInterval","lastPointerElemX","lastPointerElemY","tapEvt","touchEvt","moved","lastTarget","lastDirection","lastMode","targetMoveDistance","ghostRelativeParent","realDragElRect","autoScrolls","scrolling","awaitingDragStarted","ignoreNextClick","sortables","pastFirstInvertThresh","isCircumstantialInvert","ghostRelativeParentInitialScroll","R_SPACE","expando","Date","getTime","win","$","jQuery","Zepto","Polymer","captureMode","capture","passive","IE11OrLess","userAgent","Edge","FireFox","Safari","PositionGhostAbsolutely","CSSFloatProperty","supportDraggable","supportCssPointerEvents","el","cssText","_silent","_alignedSilent","abs","min","savedInputChecked","_detectDirection","elCSS","_css","elWidth","width","paddingLeft","paddingRight","borderLeftWidth","borderRightWidth","child1","_getChild","child2","firstChildCSS","secondChildCSS","firstChildWidth","marginLeft","marginRight","_getRect","secondChildWidth","display","flexDirection","gridTemplateColumns","float","touchingSideChild2","_getParentAutoScrollElement","includeSelf","getBoundingClientRect","_getWindowScrollingElement","elem","gotSelf","clientWidth","scrollWidth","clientHeight","scrollHeight","elemCSS","overflowX","overflowY","body","parentNode","documentElement","scrollingElement","_scrollBy","y","scrollLeft","_autoScroll","_throttle","evt","isFallback","scroll","_this","sens","scrollSensitivity","speed","scrollSpeed","clientX","clientY","winScroller","scrollThisInstance","_clearAutoScrolls","scrollFn","layersOut","currentParent","css","vx","vy","canScrollX","canScrollY","scrollPosX","scrollPosY","rect","top","bottom","left","right","i","clearInterval","pid","setInterval","layer","Sortable","active","_emulateDragOver","_onTouchMove","scrollOffsetY","scrollOffsetX","bind","bubbleScroll","forEach","autoScroll","_prepareGroup","toFn","value","pull","to","from","sameGroup","group","name","otherGroup","originalGroup","checkPull","checkPut","put","revertClone","_checkAlignment","_computeIsAligned","_hideGhostForTarget","_unhideGhostForTarget","preventDefault","stopPropagation","stopImmediatePropagation","_throttleTimeout","nearestEmptyInsertDetectEvent","nearest","_lastChild","threshold","emptyInsertThreshold","insideHorizontally","insideVertically","_detectNearestEmptySortable","touches","event","target","_onDragOver","nodeType","_extend","defaults","sort","disabled","store","handle","draggable","test","nodeName","swapThreshold","invertSwap","invertedSwapThreshold","removeCloneOnHide","direction","ghostClass","chosenClass","dragClass","ignore","filter","preventOnFilter","animation","easing","setData","dataTransfer","textContent","dropBubble","dragoverBubble","dataIdAttr","delay","delayOnTouchOnly","touchStartThreshold","devicePixelRatio","forceFallback","fallbackClass","fallbackOnBody","fallbackTolerance","fallbackOffset","supportPointer","fn","charAt","nativeDraggable","_on","_onTapStart","get","_closest","selector","ctx","includeCTX","_matches","_getParentOrHost","host","_off","_toggleClass","state","classList","replace","prop","val","defaultView","_matrix","appliedTransforms","transform","DOMMatrix","WebKitCSSMatrix","CSSMatrix","_find","iterator","list","getElementsByTagName","_dispatchEvent","sortable","targetEl","toEl","fromEl","startIndex","startDraggableIndex","originalEvt","onName","toUpperCase","substr","CustomEvent","createEvent","initEvent","bubbles","cancelable","item","clone","originalEvent","pullMode","lastPutMode","undefined","dispatchEvent","_onMove","dragRect","targetRect","willInsertAfter","retVal","onMoveFn","onMove","dragged","draggedRect","related","relatedRect","_disableDraggable","_unsilent","childNum","currentChild","last","lastElementChild","previousElementSibling","_getInsertDirection","_index","_generateId","str","src","href","sum","charCodeAt","index","substring","matches","msMatchesSelector","webkitMatchesSelector","_","callback","ms","args","arguments","apply","dst","key","hasOwnProperty","_clone","dom","cloneNode","_nextTick","_cancelNextTick","id","adjustForTransform","container","adjustForFixed","elRect","innerHeight","innerWidth","containerRect","matrix","scaleX","scaleY","_isScrolledPast","side","parent","elSide","parentSide","_getRelativeScrollOffset","offsetLeft","offsetTop","elementFromPoint","axis","targetS1Opp","targetS2Opp","mouseOnOppAxis","sortableMouseAligned","_getDirection","type","touch","originalTarget","shadowRoot","path","composedPath","root","inputs","idx","checked","_saveInputCheckedState","button","isContentEditable","some","criteria","trim","_prepareDragStart","_handleAutoScroll","fallback","ogElemScroller","newElem","dragStartFn","ownerDocument","nextSibling","_lastX","_lastY","transition","_disableDelayedDragEvents","_triggerDragStart","_onDrop","_disableDelayedDrag","_delayedDragTouchMoveHandler","_dragStartTimer","pointerType","_onDragStart","selection","empty","getSelection","removeAllRanges","err","_dragStarted","_appendGhost","_nulling","forAutoScroll","relativeScrollOffset","dx","dy","translate3d","ghostRelativeParentRect","_hideClone","_cloneId","insertBefore","_loopId","effectAllowed","_dragStartId","revert","activeSortable","isOwner","canSort","contains","animated","completed","elLastChild","mouseOnAxis","targetS2","_ghostIsLast","_showClone","changed","targetBeforeFirstSwap","aligned","differentLevel","side1","scrolledPastTop","scrollBefore","el1","el2","el1Rect","el2Rect","el1S1Opp","el1S2Opp","el1OppLength","el2S1Opp","el2S2Opp","el2OppLength","_isElInRowColumn","isLastTarget","targetLength","targetS1","invert","_getSwapDirection","nextElementSibling","after","moveVector","insertion","_animate","prevRect","currentRect","_repaint","offsetWidth","_offMoveEvents","_offUpEvents","save","handleEvent","dropEffect","_globalDragOver","toArray","order","getAttribute","items","set","closest","option","Array","querySelectorAll","removeAttribute","splice","cloneHidden","utils","on","off","find","is","extend","throttle","toggleClass","nextTick","cancelNextTick","detectDirection","getChild","create","version","ex","require$$0","expr","con","querySelector","each","o","let","element","ref","keys","map","delegate","handler","delegatedTarget","unbind","fire","properties","j","attrs","dataset","attr","elements","styleMap","getStyle","isArray","removeStyle","styleProps","includes","parseFloat","inViewport","pTop","pLeft","pBottom","pRight","pixels","requestAnimationFrame","scrollbarSize","scrollBarSizeValue","scrollDiv","overflow","position","scrollbarWidth","getScrollBarSize","hasVerticalOverflow","hasHorizontalOverflow","measureTextWidth","text","div","visibility","whiteSpace","innerText","isObject_1","commonjsGlobal","global","self","commonjsRequire","_freeGlobal","freeSelf","_root","Function","now_1","now","_Symbol","Symbol","objectProto","nativeObjectToString","symToStringTag","toStringTag","_getRawTag","isOwn","result","nativeObjectToString$1","_objectToString","nullTag","undefinedTag","symToStringTag$1","_baseGetTag","isObjectLike_1","symbolTag","isSymbol_1","NAN","reTrim","reIsBadHex","reIsBinary","reIsOctal","freeParseInt","toNumber_1","other","valueOf","isBinary","slice","FUNC_ERROR_TEXT","nativeMax","nativeMin","debounce_1","func","wait","lastArgs","lastThis","maxWait","timerId","lastCallTime","lastInvokeTime","leading","maxing","trailing","TypeError","invokeFunc","time","thisArg","shouldInvoke","timeSinceLastCall","timerExpired","trailingEdge","timeWaiting","remainingWait","debounced","isInvoking","leadingEdge","cancel","flush","FUNC_ERROR_TEXT$1","throttle_1","asyncTag","funcTag","genTag","proxyTag","uid","isFunction_1","_coreJsData","maskSrcKey","exec","IE_PROTO","_isMasked","funcToString","_toSource","reIsHostCtor","funcProto$1","objectProto$2","funcToString$1","hasOwnProperty$1","reIsNative","RegExp","_baseIsNative","_getValue","object","_getNative","_nativeCreate","_hashClear","__data__","size","_hashDelete","has","HASH_UNDEFINED","hasOwnProperty$2","_hashGet","hasOwnProperty$3","_hashHas","HASH_UNDEFINED$1","_hashSet","Hash","entries","entry","_Hash","_listCacheClear","eq_1","_assocIndexOf","array","_listCacheDelete","pop","_listCacheGet","_listCacheHas","_listCacheSet","ListCache","_ListCache","_Map","_mapCacheClear","hash","string","_isKeyable","_getMapData","_mapCacheDelete","_mapCacheGet","_mapCacheHas","_mapCacheSet","MapCache","_MapCache","HASH_UNDEFINED$2","_setCacheAdd","_setCacheHas","SetCache","values","add","_SetCache","_baseFindIndex","predicate","fromIndex","fromRight","_baseIsNaN","_strictIndexOf","_baseIndexOf","_arrayIncludes","_arrayIncludesWith","comparator","_cacheHas","cache","_Set","noop_1","_setToArray","_createSet","LARGE_ARRAY_SIZE","_baseUniq","iteratee","isCommon","seen","outer","computed","seenIndex","uniq_1","camelCaseToDash","makeDataAttributeString","props","_key","copyTextToClipboard","textArea","padding","border","outline","boxShadow","background","select","execCommand","console","log","throttle$1","debounce$1","context","Promise","resolve","out","linkProperties","source","reduce","acc","defineProperties","isNumber","isNaN","uniq$1","arr","numberSortAsc","DataManager","sortRows","switchColumn","removeColumn","filterRows","columns","rowCount","prepareColumns","prepareRows","prepareTreeRows","prepareRowView","prepareNumericColumns","currentSort","col","sortOrder","colIndex","validateColumns","prepareDefaultColumns","prepareHeader","checkboxColumn","hasColumnById","cell","content","getCheckboxHTML","editable","resizable","focusable","dropdown","serialNoColumn","align","baseCell","isHeader","format","prepareCell","assign","column","row0","getRow","cellValue","validateData","_getNextRowCount","row","meta","rowIndex","indent","prepareRow","nextRow","isLeaf","isSet","isTreeNodeClose","rowViewOrder","baseRowCell","DataError","getColumns","_sortRows","reverseArray","aIndex","bIndex","aContent","getCell","bContent","srNoColIndex","getColumnIndexById","viewIndex","temporary","index1","index2","temp","newCell1","newCell2","_row","findIndex","newVal","keyValPairs","getColumn","filters","then","getAllRowIndices","rowsToShow","_filteredRows","start","end","skipStandardColumns","getStandardColumnCount","parentRowIndex","parentIndent","childIndent","Boolean","icons","chevronDown","chevronRight","CellManager","instance","bindEvents","bindFocusCell","bindEditCell","bindKeyboardSelection","bindCopyCellContents","bindMouseEvents","bindTreeEvents","bindKeyboardNav","$editingCell","bodyScrollable","activateEditing","keyboard","$focusedCell","submitEditing","deactivateEditing","$cell","getLeftCell$","getRightCell$","getAboveCell$","getBelowCell$","focusCell","getLeftMostCell$","getRightMostCell$","getTopMostCell$","getBottomMostCell$","focusLastCell","columnmanager","toggleFilter","inlineFilters","activateFilter","header","unfocusCell","selectArea","$selectionCursor","getSelectionCursor","getNextSelectionCursor","noOfCellsCopied","copyCellContents","message","showToastMessage","pasteFromClipboard","pasteTarget","focus","pasteContentInCell","mouseDown","$toggle","rowmanager","openSingleNode","closeSingleNode","skipScrollToCell","scrollToCell","skipClearSelection","clearSelection","remove","skipDOMFocus","highlightRowColumnHeader","lastHeaders","colHeaderSelector","rowHeaderSelector","datamanager","colHeader","wrapper","rowHeader","getCell$","fCell","_selectArea","$cell1","$cell2","cells","getCellsInRange","_selectedCells","colIndex1","rowIndex1","colIndex2","rowIndex2","cell1","cell2","isStandardCell","rowIndices","_rowIndex","_colIndex","$editCell","editor","getEditor","currentCellEditor","initValue","getData","getDefaultEditor","$input","class","inside","getValue","setValue","valuePromise","done","oldValue","updateCell","catch","curr","total","every","it","focusedCell","focusFilter","isFilterShown","refreshCell","getCellContent","flag","getFirstColumnIndex","$aboveRow","parentElement","$belowRow","getLastColumnIndex","getFirstRowIndex","getLastRowIndex","scrollToRow","ceil","getViewportHeight","getRowHeight","dataAttr","isFilter","isTotalRow","isBodyCell","contentHTML","editCellHTML","getEditCellHTML","sortIndicator","resizeColumn","getDropdownHTML","customFormatter","treeView","addToggle","ColumnManager","refreshHeader","getHeaderHTML","$filterRow","$columnMap","bindMoveColumn","getRowHTML","bindDropdown","bindResizeColumn","bindPerfectColumnWidth","bindFilter","dropdownClass","dropdownContainer","getDropdownListHTML","$dropdownList","firstElementChild","openDropdown","deactivateDropdownOnBodyClick","deactivateDropdown","$item","_dropdownActiveColIndex","dropdownItems","headerDropdown","action","hideDropdown","_dropdownWidth","$resizingCell","startWidth","startX","isDragging","$handle","pageX","onMouseup","setColumnWidth","setBodyStyle","onMouseMove","finalWidth","minimumColumnWidth","updateColumn","setColumnHeaderWidth","longestCell","bodyRenderer","visibleRows","$longestCellHTML","cellmanager","getCellHTML","$div","cellText","$parent","onEnd","$draggedCell","nextSortOrder","freeze","refreshRows","unfreeze","fireEvent","removedCol","showFilter","applyFilter","getAppliedFilters","showRows","input","columnsToSort","sortColumn","columnWidth","styles","setStyle","$column","minWidth","getColumnCount","RowManager","bindCheckbox","checkMap","$checkbox","checkAll","checkRow","renderBody","setDimensions","updateRow","getCheckedRows","toggle","highlightRow","showCheckStatus","getTotalRows","highlightAll","checkedRowStatus","count","clearToastMessage","$row","getRow$","_highlightedRows","renderRows","getImmediateChildren","childrenToShow","getChildrenToShowForNode","visibleRowIndices","rowsToHide","getChildren","getChildrenToHideForNode","getRows","flat","depth","rowsToOpen","rowsToClose","getRowCount","_lastScrollTo","rowsInView","offset","rowIdentifier","getFilterInput","hyperlist","exports","createCommonjsModule","s","code","1","_dereq_","defineProperty","_createClass","descriptor","enumerable","configurable","writable","Constructor","protoProps","staticProps","defaultConfig","Number","HyperList","userProvidedConfig","_classCallCheck","_config","_lastRepaint","_maxElementHeight","getMaxBrowserHeight","config","render","_getScrollPosition","lastRepaint","_renderAnimationFrame","_averageHeight","rendered","_renderChunk","afterRender","fixture","mergeStyle","opacity","maxElementHeight","cancelAnimationFrame","_this2","_element","scroller","_scroller","scrollerTagName","useFragment","itemHeight","_itemHeights","fill","isValueNumber","isValuePercent","msg","numberValue","_containerHeight","elementStyle","scrollerHeight","warn","scrollerStyle","_scrollHeight","_computeScrollHeight","_itemPositions","_computePositions","oldClass","rowClassName","overrideScrollPosition","force","reverse","_getReverseFrom","_getFrom","_screenItemsLen","_lastFrom","_cachedItemsLen","fragment","createDocumentFragment","_getRow","applyPatch","_this3","sortedItemHeights","middle","averageHeight","containerHeight","default","__esModule","BodyRenderer","footer","computedStyle","cellHeight","rowHTML","restoreState","renderFooter","getRowsForView","showTotalRow","totalRow","getTotalRow","hooks","columnTotal","columnValues","prevRow","prevCell","highlightCheckedRows","selectAreaOnClusterChanged","focusCellOnClusterChanged","hideAfter","toastMessage","getToastMessageHTML","Style","scopeClass","instances","datatableWrapper","styleEl","bindResizeWindow","bindScrollHeader","stylesheet","sheet","onWindowResize","layout","_settingHeaderPosition","distributeRemainingWidth","refreshColumnWidth","styleObject","_styleRulesMap","prefixedSelector","_getPrefixedSelector","ruleString","_getRuleString","insertRule","cssRules","rule","selectorText","deleteRule","dashed","setupMinWidth","setupNaturalColumnWidth","setupColumnWidth","setColumnStyle","$headerCell","naturalWidth","getRowIndexColumnWidth","totalWidth","getColumnById","onePart","ratioWidth","wrapperWidth","firstRowWidth","resizableColumns","deltaWidth","getColumnHeaderElement","text-align","bodyWidth","firstRow","rowWidth","bodyHeight","Infinity","KEYCODES","13","91","16","17","18","37","38","39","40","9","27","67","70","86","Keyboard","listeners","keyCode","shiftKey","ctrlKey","metaKey","preventBubbling","listener","DEFAULT_OPTIONS","dropdownButton","label","events","onRemoveColumn","onSwitchColumn","column1","column2","onSortColumn","onCheckRow","onDestroy","asc","desc","none","filteredRowIndices","keyword","compareString","startsWith","guessFilter","filterMethod","stringCompareValue","String","numberCompareValue","getCompareValues","compareValue","compareValues","hay","needle","greaterThan","keywordValue","lessThan","equals","notEquals","range","rangeValues","values1","values2","containsNumber","getFilterMethod","freezeMessage","clusterize","logs","noDataMessage","dynamicRowHeight","DataTable","HTMLElement","buildOptions","prepare","applyDefaultSortOrder","prepareDom","freezeContainer","init","appendRows","refreshRow","renderHeader","viewportHeight","eventName","_internalEventHandlers","packageJson","__version__","provide","ReportView","ListView","view_name","super","setup_defaults","page_title","__","menu_items","report_menu_items","get_route","report_name","add_totals_row","view_user_settings","get_report_doc","doc","report_doc","json","JSON","parse","order_by","page_length","setup_columns","bind_charts_button","setup_new_doc_event","setup_result_area","$datatable_wrapper","$charts_wrapper","$result","setup_paging_area","$paging_area","sort_selector","ui","SortSelector","filter_area","$filter_list_wrapper","doctype","onchange","on_sort_change","before_refresh","set_dirty_state_for_custom_report","save_report_settings","current_settings","fields","get_sql_string","column_widths","get_column_widths","report_settings","deep_equal","page","clear_indicator","set_indicator","model","user_settings","save_view_user_settings","dict","render_count","chart","refresh_charts","datatable","setup_datatable","get_data","$list_count","addClass","prependTo","get_count_str","flash_row","user","session","db","get_doc","update_row","to_refresh","fieldname","cdt_row","cdt","cdoc","_field","new_row","build_row","removeClass","_flash_row","get_editing_object","is_rtl","remove_column_from_datatable","switch_column","checked_items","get_checked_items","toggle_actions_menu_button","report_column_total","datatabe_col","columns_in_picker","get_columns_for_picker","df","is_column_added","Dialog","title","fieldtype","docfield","bold","primary_action","show_alert","hide","insert_before","add_column_to_datatable","show","list_sidebar","sidebar","toggle_charts","get_chart_data","refresh_charts_sidebar_button","$configure_btn","hasClass","setup_charts","labels","datasets","last_chart_type","chart_type","Chart","colors","format_tooltip_x","format_tooltip_y","field","get_docfield","always_show_decimals","inline","chart_args","get_chart_args","x_field","y_fields","update_values","get_different_chart","cur_list_fields","x_fields","hidden","is_numeric_field","dialog","description","toTitle","y_axes","x_axis","y_axis","control","render_editing_input","change","set_focus","set_value","docname","set_control_value","updated_doc","_data","get_value","last_updated_doc","reject","fail","fields_dict","form","make_control","render_input","toggle_label","toggle_description","docstatus","std_fields_list","read_only","can_write","build_rows","add_field","_add_field","title_field","image_field","in_list_view","in_standard_filter","perm","has_perm","permlevel","is_value_type","report_hide","settings","add_fields","build_fields","column_name","get_full_column_name","cdt_name_fields","get_unique_cdt_in_view","uniqBy","col_index","add_currency_column","has_field","throw","col1","col2","_fields","standard_fields_filter","in_list","no_value_type","doctype_fields","get_docfields","std_fields","get_table_fields","child_table_fields","dialog_fields","hide_columns","build_column","docfield_map","get_std_field","is_non_std_field","cint","compareFn","datetime","user_to_obj","str_to_obj","totals","get_columns_totals","totals_row","cdt_field","is_editable","only_docnames","save_type","_save_report","method","stringify","exc","msgprint","boot","all_reports","ref_doctype","report_type","setup_reports","prompt","reqd","with_doc","condition","get_label","row_totals","flt","rows_in_order","total_data","get_print_settings","print_settings","render_grid","subtitle","get_filters_html_for_print","toggle_side_bar","get_dialog_fields","can_export","get_args","selected_items","total_count","primary_action_label","cmd","file_format_type","export_all_rows","open_url_post","request","url","report","is_report_manager","save_report","can_set_user_permissions","add_to_desktop","standard","standard_pages","add_page","make_app_page","single_column","query_report","QueryReport","BaseList","load","init_promise","tasks","setup_page","setup_report_wrapper","setup_events","run_serially","page_name","get_route_str","secondary_action","setup_progress_bar","realtime","prepared_report_action","prepared_report_doc_name","alert_message","indicator","action_name","currentTarget","toggle_nothing_to_show","load_report","route_options","refresh_report","clear_inner_toolbar","show_save","get_menu_items","get_report_settings","setup_page_head","add_make_chart_button","add_inner_button","get_possible_chart_options","toggle_message","setup_filters","set_route_filters","onload","get_user_settings","with_doctype","query_reports","get_local_report_settings","_load_script","eval","script","after_ajax","html_format","execution_time","report_script_name","reference_report","seconds_elapsed","interval","show_progress","clear_filters","set_input","get_query","on_change","previous_filters","get_filter_values","prepared_report","reset_report_view","_no_refresh","hide_form","show_form","promises","clear_fields","query","get_query_string","obj","get_query_params","last_ajax","abort","always","btn_secondary","hide_status","query_string","prepared_report_name","filters_from_report","add_prepared_report_buttons","prepare_report_data","chart_options","get_chart_options","$chart","render_chart","render_datatable","show_footer_message","hide_progress","open","urllib","get_full_url","encodeURIComponent","part1","comment_when","report_end_time","part2","part3","show_status","set_primary_action","generate_background_report","raw_data","prepare_columns","prepare_data","linked_doctypes","get_linked_doctypes","tree_report","add_total_row","datatable_options","get_datatable_options","$report","initial_depth","setTreeDepth","after_datatable_render","first_row","has_total_row","indices","accumulator","current_value","current_index","get_column_values","make_chart_options","color","dataset_values","y_field","preview_chart","get_values","get_options","numeric_fields","non_numeric_fields","depends_on","format_cell","for_print","formatter","row_obj","raise","missing_mandatory","get_filter","field_value_map","get_meta","breadcrumbs","custom_format","filters_html","landscape","orientation","template","get_data_for_print","get_columns_for_print","original_data","base_url","get_base_url","print_css","applied_filters","render_template","render_pdf","export_dialog","set_df_property","file_format","column_row","get_data_for_csv","with_indentation","tools","downloadify","get_dict","visible_idx","getFilteredRowIndices","standard_column_count","repeat","get_visible_columns","print_report","letter_head","can_print","pdf_report","export_report","custom_columns","link_field","doctype_field_map","unscrub","custom_data","add_custom_column","insert_after","set_menu_items","is_standard","custom_column","column_field","insert_after_index","doctypes","dynamic_links","dynamic_doctypes","Set","link_name","doc_field_pair","page_form","main","$status","insertAfter","appendTo","$message","message_div","status_message","execution_time_msg","$tree_footer","before","expandAllNodes","collapseAllNodes","report_dump","last_modified","with_data","pre_loaded","doctype_data","set_data","links","row_idx","link_key","link","replace_dict","make_row","modified_names","GridReport","Class","opts","filter_inputs","preset_checks","tree_grid","padding-top","make_filters","make_waiting","get_data_and_refresh","bind_show","me","cur_grid_report","apply_filters_from_route","setup_filters_done","add_options","set_autocomplete","add_menu_item","init_filter_values","grid","set_filter","str_to_user","$filter","Awesomplete","sys_defaults","selectedIndex","set_default_values","from_date","year_start_date","to_date","year_end_date","add_select","default_value","add_data","icon","add_date","add_label","add_check","cssClass","keypress","which","waiting","messages","load_filter_values","user_to_str","make_name_map","reset_item_values","currency_formatter","round_item_values","get_default","round_off_data","grid_wrapper","make","setup_dataview_columns","apply_link_formatters","prepare_data_view","setup_chart","datatable_columns","chart_area","export","set_unique_id","trigger","enableColumnReorder","slickgrid_tools","get_view_data","dataView","apply_filters","_show","apply_filter","apply_zero_filter","show_zero","show_zero_check","click","is_default","date_formatter","columnDef","dataContext","repl","_style","format_number","text_formatter","esc_value","cstr","check_formatter","link_formatter","dataview_columns","filter_input","col_name","open_btn","get_link_open_icon","make_date_range_columns","date_diff","get_diff","column_map","last_date","add_column","date","build_columns","add_days","getMonth","getDate","trigger_refresh_on_change","GridReportWithPlot","chart_data","plottable_cols","plot","TreeGridReport","make_transaction_list","parent_doctype","tmap","tl","copy_dict","add_tree_grid_events","onClick","subscribe","getItem","_collapsed","updateItem","tree_formatter","spacer","getIdxById","tree_dataview_filter","parent_field","item_by_name","parent_map","prepare_tree","item_dt","group_dt","group_data","item_data","item_group_map","group_ids","is_group","set_indent","msgbox","with_groups","with_ledgers"],"mappings":"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"}